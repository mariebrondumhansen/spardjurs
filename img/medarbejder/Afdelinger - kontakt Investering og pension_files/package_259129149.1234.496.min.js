// ajax.min.js
function TAjax(){function t(){this.ajaxObj=null;this.callback=i;this.statusElement=null;this.resultElement=null;this.statusText_Get="Henter...";this.statusText_Done="Fï¿½rdig...";this.method="get";this.postData="";this.srcFrm=null;this.IF=null;this.getPostData=function(n){$ts.exists(n)||(n="rediger");this.srcFrm=$elm(n);$ts.exists(this.srcFrm)||(this.srcFrm=$elm('form[name="'+n+'"]'),$ts.exists(this.srcFrm)&&(n=this.srcFrm));this.postData=$ts.collectFormValues(n)}}function i(){var n;this.ajaxObj!=null?this.ajaxObj.readyState===4&&(n=this.ajaxObj.responseText,this.statusElement!=null&&(this.statusElement.innerHTML=this.statusText_Done),this.resultElement!=null&&(this.resultElement.innerHTML=n)):(n=this.IF.innerHTML,this.statusElement!=null&&(this.statusElement.innerHTML=this.statusText_Done),this.resultElement!=null&&(this.resultElement.innerHTML=n))}function n(){var n=document.getElementById("XYZ");return n!=null&&n.parentNode.removeChild(n),n=document.createElement("IFRAME"),n.src="about:blank",n.name="XYZ",n.id="XYZ",n.style.position="absolute",n.style.visibility="hidden",n.style.zIndex=99,n.style.top=0,n.style.left=0,n}function r(){document.getElementById("modal").style.display="none"}function u(){return!1}this.storage=[];this.innerHTML=function(t,i,u,f,e,o,s){var l=$ts.exists(i),h,a,c;if(t+=$ts.exists(s)?s?"&nocache=true":"&nocache=false":"&nocache=true",$ts.exists(u)&&u==""?u="default":this.createInstance(u),h=this.storage[u],$ts.exists(h.ajaxObj)||(h.ajaxObj=getHTTPObject()),$ts.exists(o)&&(h.callback=o),$ts.exists(h.ajaxObj))try{h.ajaxObj.open(h.method,t,l)}catch(v){h.ajaxObj=getHTTPObject();h.ajaxObj.open(h.method,t,l)}if(l){if(h.statusElement=$elm(e),h.resultElement=$elm(f),$ts.exists(h.statusElement)&&(h.statusElement.innerHTML=h.statusText_Get),$ts.exists(h.ajaxObj)){h.ajaxObj.onreadystatechange=function(){eval(i+".storage['"+u+"'].callback()")};h.method==="get"?h.ajaxObj.send(""):(h.ajaxObj.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),h.ajaxObj.send(h.postData));return}h.IF=n();h.method==="post"?($ts.addEvent(h.IF,"load",function(){eval(i+".storage['"+u+"'].callback()")}),document.body.insertBefore(h.IF,null),h.srcFrm.id===""&&(h.srcFrm.id=h.srcFrm.name),h.IF.contentWindow.document.write("<body>"+h.srcFrm.outerHTML+"<\/body>"),c=h.IF.contentWindow.document.getElementById(h.srcFrm.name),c.submit()):($ts.addEvent(h.IF,"load",function(){eval(i+".storage['"+u+"'].callback()")}),document.body.insertBefore(h.IF,null),h.IF.src=t);return}if(h.method==="get")h.ajaxObj.send("");else if($ts.exists(h.ajaxObj))h.ajaxObj.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),h.ajaxObj.send(h.postData);else{a=getModalDIV();h.IF=n();h.method=="post"&&($ts.addEvent(h.IF,"load",r),document.body.insertBefore(h.IF,null),h.srcFrm.id===""&&(h.srcFrm.id=h.srcFrm.name),h.IF.contentWindow.document.write("<body>"+h.srcFrm.outerHTML+"<\/body>"),c=h.IF.contentWindow.document.getElementById(h.srcFrm.name),c.submit());return}return h.ajaxObj.responseText};this.createInstance=function(n){return this.storage[n]==null&&(this.storage[n]=new t,this.storage[n].ajaxObj=getHTTPObject()),this.storage[n]};this.getModalDIV=function(n){var t;if($ts.exists(n)||(n="modal"),t=document.getElementById(n),t===null){t=document.createElement("DIV");t.style.position="absolute";t.style.left=0;t.style.top=0;t.className="statusdialog";t.style.visibility="visible";t.id=n;t.innerHTML="<table cellspacing=0 cellpadding=0 border=0><tbody><tr align=middle><td class=statusdialogcontents id=tssavestatuscontents valign=center><b>"+admlib1021+"...<\/b><\/td><\/tr><\/tbody><\/table>";t.style.cursor="hand";t.style.zIndex=100;$ts.addEvent(t,"click",u);document.body.insertBefore(t,null);var i=document.body,r=i.scrollLeft+(i.clientWidth-t.offsetWidth)/2,f=i.scrollTop+(i.clientHeight-t.offsetHeight)/2;t.style.top=f;t.style.left=r;t.style.display="block"}else t.style.display="block";return t}}TAjax.prototype.innerHTML="";tsAjax=new TAjax;