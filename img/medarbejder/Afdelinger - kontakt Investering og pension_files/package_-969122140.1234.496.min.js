// ts.min.js
var ts_majorVersion='1234',ts_minorVersion='496',buildCode='?ts='+ts_majorVersion+'.'+ts_minorVersion,ts_minified=true;cssFilesLoaded = {};(function(){function t(){this.ajaxCache={};this.ajaxSettings={url:"blank.htm",async:!0,data:"",type:"GET",noncacheable:!0,chunked:!1,timeout:0,ontimeout:null};this.debug={events:{registration:!1,invocation:!1},lazyload:!1,observer:{broadcast:!1,registration:!1},developerConsole:!1};this.SocketEnabled=!1;this.readyScripts=[]}var n=null;t.prototype={getComputedStyle:function(n,t){var i="";return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(n,"").getPropertyValue(t):n.currentStyle&&(t=t.replace(/\-(\w)/g,function(n,t){return t.toUpperCase()}),i=n.currentStyle[t]),i},getCascadedStyle:function(n,t){return Tangora.CSSHelper.GetCascadedStyle(n,t)},cloneNodeAndApplyCSS:function(n){var r=n.cloneNode(!0),t=[],u,i;for(u in n.style)t.push(u);return i=function(n,r){for(var f,e,u=0;u<t.length;u++)(function(i){try{var u=$ts.getComputedStyle(n,t[i]);u&&(r.styles[t[i]]=u)}catch(n){}})(u);for(f=$ts.getChildElements(n),e=$ts.getChildElements(r),u=0;u<f.length;u++)(function(n){var t=f[n],r=e[n];i(t,r)})(u)},i(n,r),r},getContentWidth:function(n){var t=n.clientWidth;return t-=$ts.safeInt($ts.getComputedStyle(n,"padding-right")),t-=$ts.safeInt($ts.getComputedStyle(n,"padding-left")),t-=$ts.safeInt($ts.getComputedStyle(n,"border-right")),t-$ts.safeInt($ts.getComputedStyle(n,"border-left"))},getContentHeight:function(n){var t=n.clientHeight;return t-=$ts.safeInt($ts.getComputedStyle(n,"padding-top")),t-=$ts.safeInt($ts.getComputedStyle(n,"padding-bottom")),t-=$ts.safeInt($ts.getComputedStyle(n,"border-top")),t-$ts.safeInt($ts.getComputedStyle(n,"border-bottom"))},getScrollBarSize:function(){var n=document.body.appendChild($ts.createElement("div",{innerHTML:"<div><\/div>"},{width:"100px",position:"absolute",top:"-100px",left:"-100px",overflow:"hidden"})),i=n.firstChild.offsetWidth,t=0;return n.style.overflow="scroll",t=i-n.firstChild.offsetWidth,t===0&&(n.firstChild.style.width="200px",t=n.offsetWidth-n.clientWidth),n.parentNode.removeChild(n),n.innerHTML="",n=null,t},jsStyle2CssStyle:function(n){var t=n;for(done=!1;!done;)re=/([a-z,0-9,-])+/.exec(t),re[0]==t?done=!0:t=re[0]+"-"+t[re[0].length].toLowerCase()+t.substring(re[0].length+1);return t},cssStyle2jsStyle:function(n){var t;if(n.indexOf("-")>-1){for(t=n;t.indexOf("-")>-1;){var i=t.split("-"),r=i[1].charAt(0),u=i[1].substring(1);t=i[0]+r.toUpperCase()+u}return t}return n},Hex2RGBa:function(n){n=n.lastIndexOf("#")>-1?n.replace(/#/,"0x"):"0x"+n;n.length==5&&(n=n.slice(0,2)+n[2]+n.slice(2),n=n.slice(0,4)+n[4]+n.slice(4),n=n.slice(0,6)+n[6]+n.slice(6));var t=n>>16,i=(n&65280)>>8,r=n&255;return[t,i,r,1]},RGBa2CSS:function(n){return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},convertRGBColorToHex:function(n){var r=document.body.appendChild($ts.createElement("div",null,{position:"absolute",top:"-1px",left:"-1px",width:"1px",height:"1px",color:n})),t;if(n=getComputedStyle(r).color,document.body.removeChild(r),t=n.match(/.*rgb[\s]*\([\s]*(\d{1,3})[\s]*,[\s]*(\d{1,3})[\s]*,[\s]*(\d{1,3})[\s]*\)[\s]*$/im),t!==null){function i(n){return n=parseInt(n,10).toString(16),n.length===1&&(n="0"+n),n}n="#"+i(t[1])+i(t[2])+i(t[3])}return n},getPosition:function(n,t,i){var u=0,f=0,e,o,s,r,h;if($ts.exists(i)||(i=window.top),n.offsetParent)do u+=n.offsetLeft,f+=n.offsetTop,e=n.scrollLeft,o=n.scrollTop,n.tagName.toLowerCase()==="body"&&(e=Math.max(e,document.documentElement.scrollLeft),o=Math.max(o,document.documentElement.scrollTop)),u-=e,f-=o,n=n.offsetParent;while(this.exists(n));if(t&&window.self!=i)for(s=parent.$elms("iframe","frame"),r=0;r<s.length;r++)if(s[r].contentWindow==window){n=s[r];h=parent.$ts.getPosition(n,!0);u+=h[0];f+=h[1];break}return[u,f]},getBoundingClientRect:function(n,t,i){var r=n.getBoundingClientRect(),f={top:r.top,right:r.right,bottom:r.bottom,left:r.left},u=window,o=u.parent,s,e;if(t&&($ts.exists(i)||(i=u.top),o!=u)){for(s=o.$elms("iframe","frame"),e=0;e<s.length;e++)if(s[e].contentWindow==u){n=s[e];r=n.getBoundingClientRect();f.top+=r.top;f.right+=r.right;f.bottom+=r.bottom;f.left+=r.left;break}u=o;o=u.parent}return f},hasClass:function(n,t){if(this.exists(n)&&this.exists(t)&&t!=="")return new RegExp("\\b"+t+"\\b").test(n.className);throw"className must be specified.";},addClass:function(n,t){this.hasClass(n,t)||(n.className.length<1?n.className=t:n.className+=" "+t)},getStyleSheetByName:function(n){var t,i;if(document.styleSheets){if(!document.styleSheets.length)return null;for(t=0;t<document.styleSheets.length;t++)if(i=document.styleSheets[t],i.title==n)return i}return $elm('style[title="'+n+'"]',document.head)},removeClass:function(n,t){try{n.classList.remove(t)}catch(i){n.className=n.className.replace(new RegExp("(?:\\b|[ ]|^)"+t+"(?:\\b|[ ]|$)","g"),"");n.className=n.className.replace(/ {2,}/g," ")}n.className=this.trim(n.className)},loadCSSFile:function(n){cssFilesLoaded[n]!==!0&&$ts.addEvent(window,"DOMContentLoaded",function(){for(var i=document.getElementsByTagName("head")[0],r=i.getElementsByTagName("link"),t=0;t<r.length;t++)if(r[t].getAttribute("href").toLowerCase()==n.toLowerCase()){cssFilesLoaded[n]=!0;break}cssFilesLoaded[n]!==!0&&(i.appendChild($ts.createElement("link",{href:n,rel:"stylesheet",type:"text/css"})),cssFilesLoaded[n]=!0)})},addCssRule:function(n,t,i){var r,e,o,f,u;if(document.styleSheets){if(document.styleSheets.length||(f=document.getElementsByTagName("head")[0],f.appendChild($ts.createElement("style"))),i)r=$ts.getStyleSheetByName(i),r||(f=document.getElementsByTagName("head")[0],r=$ts.createElement("style",{type:"text/css"}),r.title=i,f.appendChild(r),r=$ts.getStyleSheetByName(i));else{e=1;do{if(o=document.styleSheets.length-e,r=document.styleSheets[o],!r&&(r=$elm("style:last-of-type",document.head),e>1))break;e++}while(!$ts.isInMyDomain(r.href))}u=0;r.cssRules?u=r.cssRules.length:r.rules&&(u=r.rules.length);r.insertRule?r.insertRule(n+" {"+t+"}",u).originalSelector=n:r.addRule&&(r.addRule(n,t,u).originalSelector=n)}},findCssRule:function(n,t){var f,o,r,u,e,i,s;if(document.styleSheets){if(!document.styleSheets.length)return"";if(f=[],t)if(r=$ts.getStyleSheetByName(t),r)f.push(r);else return"";else f=document.styleSheets;for(o=0;o<f.length;o++)if(r=f[o],$ts.isInMyDomain(r.href)){for(r.cssRules?u=r.cssRules:r.rules&&(u=r.rules),e=-1,i=0;i<u.length;i++)if(s=u[i].selectorText,s==n){e=i;break}if(e==-1){for(n=n.replace(":","::"),i=0;i<u.length;i++)if(s=u[i].selectorText,s==n){e=i;break}n=n.replace("::",":")}if(e>-1)return u[i]}}return""},findCssRules:function(n){var o=[],e,u,i,r,t,f,s;if(document.styleSheets){if(!document.styleSheets.length)return"";for(e=0;e<document.styleSheets.length;e++)if(u=document.styleSheets[e],$ts.isInMyDomain(u.href)){for(u.cssRules?i=u.cssRules:u.rules&&(i=u.rules),r=[],t=0;t<i.length;t++)f=i[t].selectorText,f&&f.indexOf(n)>-1&&r.push(t);if(r.length==0){for(n=n.replace(":","::"),t=0;t<i.length;t++)f=i[t].selectorText,f&&f.indexOf(n)>-1&&r.push(t);n=n.replace("::",":")}if(r.length>0)for(s in r)o.push(i[r[s]])}}return o},isInMyDomain:function(n){var i=location.hostname.toLowerCase(),t=document.createElement("a");return t.href=n,i==t.hostname.toLowerCase()},removeCssRule:function(n,t){var e,s,o,i,u,f,r;if(document.styleSheets){if(!document.styleSheets.length)return;if(e=[],t)if(i=$ts.getStyleSheetByName(t),i)e.push(i);else return"";else e=document.styleSheets;for(s=n,o=0;o<e.length;o++)if(i=e[o],n=s,$ts.isInMyDomain(i.href)){if(i.cssRules?u=i.cssRules:i.rules&&(u=i.rules),!u)return;for(f=-1,r=0;r<u.length;r++)if(u[r].selectorText==n){f=r;break}if(f==-1)for(n=n.replace(":","::"),r=0;r<u.length;r++)if(u[r].selectorText==n){f=r;break}f>-1&&(i.deleteRule?i.deleteRule(f):i.removeRule&&i.removeRule(f))}}},globalEval:function(n){if(window.execScript){window.execScript(n);return}var t=function(){window.eval.call(window,n)};t()},globalInjectScript:function(n,t,i,r,u){var f;if(u||(u=document.getElementsByTagName("head")[0]),r)for(f=$elm("script["+t+"_"+i+'="true"]');f;)u.removeChild(f),delete f,i++,f=$elm("script["+t+"_"+i+'="true"]');else f=document.createElement("script"),f.type="text/javascript",f.text=n,f.setAttribute(t+"_"+i,"true"),u.appendChild(f)},setFormFieldValue:function(n,t){var i,s,e,u,f,h,t,r,o;if(n!=null){t==null&&(t="");i=!1;switch(n.tagName.toLowerCase()){case"input":n.type=="text"||n.type=="hidden"?(i=n.value!=t,n.value=t):n.type=="checkbox"&&(s=n.checked,n.checked=t=="1"||t=="true",i=n.checked!=s);e=$elm(n.id+"_text");e&&(e.innerHTML=t);break;case"textarea":i=n.innerHTML!=t;n.innerHTML=t;break;case"select":u=-1;f=[t];n.multiple&&(f=t.split(","));for(h in f)for(t=f[h],r=0;r<n.options.length;r++)if(n.options[r].text==t||n.options[r].value==t)if(n.multiple)n.options[r].selected=!0;else{u=r;break}u>-1?(i=!n.options[u].selected,n.options[u].selected=!0):n.options.length>0&&(i=!n.options[0].selected,n.options[0].selected=!0)}i&&(o=window[n.id+"_change"],typeof o=="function"&&o())}},setFormFieldFilterValue:function(n,t){var h=!1,u,i,f,e,o,l,r;if(n!=null)if(typeof n=="string"&&(h=!0),t==null&&(t=""),console.log(n),h){var c=$elms('[name="'+n+'"]'),u=t.split(","),s=[];for(l in c)r=c[l],u.indexOf(r.value)>-1||t==""?(s.push(r),r.disabled=!1):(r.disabled=!0,r.checked=!1);s.length==1&&(s[0].checked=!0)}else switch(n.tagName.toLowerCase()){case"input":n.type=="checkbox"||n.type=="radio";break;case"select":for(u=t.split(","),i=$elm(n.id+"_saved"),i||(i=n.cloneNode(!0),i.id=i.id+"_saved",i.removeAttribute("name"),i.style.display="none",n.parentNode.insertBefore(i,n)),n.innerHTML="",f=0;f<i.options.length;f++)e=i.options[f],(u.indexOf(e.value)>-1||e.value=="0"||t=="")&&(o=e.cloneNode(!0),n.appendChild(o),u.length==1&&t!=""&&(o.selected=!0))}},getContext:function(n){for(var r=n.split("."),t=window,i=0;i<r.length-1;i++)t=t[r[i]];return t===window?null:t},createElement:function(n,t,i){var f=document.createElement(n),r,u,e,o,h,s;for(r in t)t.hasOwnProperty(r)&&(/^data-\w/.test(r)?f.setAttribute(r,t[r]):f[r]=t[r]);for(u in i)if(i.hasOwnProperty(u)){for(f.style[u]=i[u],e=u.split("-"),o=e[0],h=1;s=e[h++];)o+=s.charAt(0).toUpperCase()+s.substring(1);f.style[o]=i[u]}return f},getChildElements:function(n,t){for(var r=[],u=t?t.toLowerCase():null,i=0;i<n.childNodes.length;i++)n.childNodes[i].nodeType!==3&&(u==null||n.childNodes[i].tagName.toLowerCase()===u)&&r.push(n.childNodes[i]);return r},getNextSiblingElement:function(n){var t=null;if(n&&n.nextSibling)while(n.nextSibling)if(n.nextSibling.nodeType==1){t=n.nextSibling;break}else n=n.nextSibling;return t},getPreviousSiblingElement:function(n){var t=null;if(n&&n.previousSibling)while(n.previousSibling)if(n.previousSibling.nodeType==1){t=n.previousSibling;break}else n=n.previousSibling;return t},getOwnerWindow:function(n){return n.ownerDocument.defaultView||n.ownerDocument.parentWindow},isElementInArray:function(n,t){for(var i=0;i<n.length;i++)if(n[i]===t)return!0;return!1},consoleWrite:function(n){if(typeof console!="undefined"){var t=new Date;console.log(t.toLocaleTimeString()+","+t.getMilliseconds()+": "+n)}},consoleDevWrite:function(n){$ts.debug.developerConsole===!0&&typeof console!="undefined"&&$ts.consoleWrite(n)},WatchDog:function(){var n=[];return this.removeWatch=function(t){var i,r;if(typeof t=="object"){for(i in n)if(r=n[i],r===t){delete n[i];break}}else for(i in n)if(r=n[i],r.watchId===t){delete n[i];break}},this.addWatch=function(t,i,r,u,f){t.watchId=$ts.createUID();t.propbag=[];t.stylebag=[];for(var e in i)t.propbag[i[e]]=t[i[e]];if(r!==null)for(e=0;e<r.length;)t.stylebag[r[e]]=$ts.getComputedStyle(t,r[e]),e++;return n.push({element:t,properties:i,styles:r,callback:u,resolution:f||10}),n.length==1&&setTimeout(this.check,f||10),t.watchId},this.buildChangeObject=function(n){var r=null,u=!1,t,i;for(t in n.properties)if(n.element[n.properties[t]]!=n.element.propbag[n.properties[t]]){r={property:n.properties[t],oldvalue:n.element.propbag[n.properties[t]],newvalue:n.element[n.properties[t]],element:n.element};n.element.propbag[n.properties[t]]=n.element[n.properties[t]];u=!0;break}if(!u)for(t=0;n.styles&&t<n.styles.length;){if(i=$ts.getComputedStyle(n.element,n.styles[t]),i==""&&(i=n.element.style[n.styles[t]]),n.element.stylebag[n.styles[t]]!=i){r={style:n.styles[t],oldvalue:n.element.stylebag[n.styles[t]],newvalue:i,element:n.element};n.element.stylebag[n.styles[t]]=i;u=!0;break}t++}return r},this.check=function(){var r,t,i;for(r in n)t=n[r],i=this.buildChangeObject(t),i&&t.callback(i);n.length>0&&setTimeout($ts.WatchDog.check,t.resolution)},this}(),addEvent:function(n,t,i,r){var f,s,e,h,c,l,a;if($ts.exists(n)){if($ts.exists(r)||(r=!1),$ts.debug.events.registration){if(f="",$ts.exists(i,"name"))f=i.name;else if(f="anonymous (",s=i.toString().split("\n"),s.length<4)f+=i.toString();else{for(e=0;e<4;e++)f+=s[e]+"\n";f+="..."}$ts.consoleDevWrite("addEvent '"+t+"' on "+($ts.exists(n,"tagName")?n.tagName:"window")+" "+(r?"propagation":"bubbeling")+" f() = "+f)}if($ts.debug.events.invocation&&(h=i,c=function(){$ts.consoleDevWrite("Invoke - "+h.toString());h.apply(n,arguments)},i=c),t.toLowerCase()==="load"||t.match(/(?:on)?DOMContentLoaded/i)){if(n.loaded===!0){i.apply(n,n.loadArgs);return}t.toLowerCase()==="load"&&(l=i,a=function(){n.loaded=!0;n.loadArgs=arguments;l.apply(n,n.loadArgs)},i=a)}if(window.addEventListener){try{n.removeEventListener(t,i,r)}catch(p){}n.addEventListener(t,i,r);t=="contextmenu"&&$ts.isTouchDevice()&&(n.longtouch=!0)}else if(window.attachEvent)if(t.match(/(?:on)?DOMContentLoaded/i)){var o=window.document,u=window.ie8DOMContenLoadedSharedSpace=window.ie8DOMContenLoadedSharedSpace||{done:!1,queuedFuncs:[],tryAgainTimeout:null},v=function(){if(u.tryAgainTimeout!=null&&clearTimeout(u.tryAgainTimeout),u.tryAgainTimeout=null,!u.done)for(u.done=!0;u.queuedFuncs.length>0;)u.queuedFuncs.shift()()},y=function(){try{o.documentElement.doScroll("left")}catch(n){u.tryAgainTimeout=setTimeout(y,50);return}v()};u.queuedFuncs.push(i);u.tryAgainTimeout==null&&y();o.onreadystatechange=function(){o.readyState==="complete"&&(o.onreadystatechange=null,v())}}else n.attachEvent("on"+t,i)}},removeEvent:function(n,t,i,r){var u,e,f;if($ts.exists(n)){if($ts.exists(r)||(r=!1),$ts.debug.events.registration){if(u="",$ts.exists(i,"name"))u=i.name;else if(u="anonymous (",e=i.toString().split("\n"),e.length<4)u+=i.toString();else{for(f=0;f<4;f++)u+=e[f]+"\n";u+="..."}$ts.consoleDevWrite("removeEvent '"+t+"' from "+($ts.exists(n,"tagName")?n.tagName:"window")+" "+(r?"propagation":"bubbeling")+" f() = "+u)}window.removeEventListener?(n.removeEventListener(t,i,r),t=="contextmenu"&&$ts.isTouchDevice()&&(n.longtouch=!1)):window.detachEvent&&n.detachEvent("on"+t,i)}},ready:function(n){if(window.loaded)try{n.apply(window)}catch(t){try{console.log("Ready script error:");console.log(t)}catch(i){$ts.consoleWrite("Ready script error: "+t.message)}}else $ts.readyScripts.push(n)},top:function(){try{if(top.document.createElement("a"))return top}catch(t){var n=window;try{while(n.parent)n.parent.document.createElement("a"),n=n.parent}catch(i){}return n}},cancelBubble:function(n){var t=n||window.event;return t?($ts.debug.events.invocation&&$ts.consoleDevWrite("cancelBubble"),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1):!1},loadScriptAsync:function(n,t){for(var r=document.getElementsByTagName("script"),u=!0,i=0;i<r.length;i++)if($ts.exists(r[i].src)&&r[i].src.toLowerCase().indexOf(n.toLowerCase())!==-1){u=!1;break}u?document.getElementsByTagName("head")[0].appendChild($ts.createElement("script",{type:"text/javascript",src:n,loaded:!1,onload:function(){!this.loaded&&$ts.exists(t)&&t();this.loaded=!0},onreadystatechange:function(){(this.readyState=="complete"||this.readyState=="loaded")&&this.onload()}})):typeof t=="function"&&t()},pad:function(n,t,i,r){n=(n||"")+"";var u=n,f=r==="right";for(this.exists(i)||(i="0");u.length<t;)f?u+=i:u=i+u;return u},trim:function(n,t,i){if(this.exists(n)){var f=!0,e=!0,r=0,u=n.length;switch(t){case"left":e=!1;break;case"right":f=!1}if(this.exists(i)||(i=" "),f)while(r<n.length&&n.charAt(r)===i)r++;if(e)while(u>r&&n.charAt(u-1)===i)u--;return n.substring(r,u)}},indexOf:function(n,t,i){var r=n.substring(i||0).search(t);return r>=0?r+(i||0):r},endsWith:function(n,t,i){return i?n.toLowerCase().indexOf(t.toLowerCase(),n.length-t.length)!==-1:n.indexOf(t,n.length-t.length)!==-1},htmlEncode:function(n){var t=$ts.createElement("div"),i=document.createTextNode(n);return t.appendChild(i),t.innerHTML},htmlDecode:function(t){return $ts.exists(n)||(n=$ts.createElement("span")),n.innerHTML=t,t=n.innerText||n.textContent||"",n.innerHTML="",t},createUID:function(){return this.pad(""+Math.floor(Math.random()*1000001)+(new Date).getTime(),20)},isNullOrEmpty:function(n){return!($ts.exists(n)&&n!=="")},capitalizeFirstLetter:function(n){return typeof n=="string"&&n.length>0?n.charAt(0).toUpperCase()+n.slice(1):n},addThousandSeparator:function(n,t){for(var i=new RegExp("(-?[0-9]+)([0-9]{3})");i.test(n);)n=n.replace(i,"$1"+t+"$2");return n},formatValue:function(n,t,i,r,u){return isNaN(n)?n:(n=$ts.formatNumber(n,i).replace(".",t),r=!0,r&&(n=$ts.addThousandSeparator(n,$ts.exists(u)?u:t==="."?",":".")),n)},formatNumber:function(n,t){if(isNaN(n)||n==="")return n;if(result=String(Math.round(n*Math.pow(10,t))/Math.pow(10,t)),t>0){result.indexOf(".")==-1&&(result+=".");var i=result.indexOf(".");if(i>-1)while(result.length<=i+t)result+="0"}return result},longToIP:function(n){return[n>>24,n>>16&255,n>>8&255,n&255].join(".")},ipToLong:function(n){var t=n.split(".");return t[0]<<24|t[1]<<16|t[2]<<8|t[3]},safeInt:function(n,t){var i=parseInt(n,10);return isNaN(i)&&(i=parseInt(t,10),isNaN(i)&&(i=0)),i},safeFloat:function(n,t){var i=parseFloat(n);return isNaN(i)&&(i=parseFloat(t),isNaN(i)&&(i=0)),i},random:function(n,t){if(typeof n!="number")throw Error("Must specify a number");var i=n+1;if(typeof t!="number"&&(t=0),t>i)throw Error("ceiling must be higher than floor");return t+Math.random()*(i-t)>>0},setCookie:function(n,t,i){var u="",r;this.exists(i)&&(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toGMTString(),t||(t="1"));document.cookie=n+"="+t+u+"; path=/"},getCookie:function(n){var i=new RegExp("([; ]|^)"+n+"=([^;]*)","i"),t=i.exec(document.cookie);return t?t[2]:null},deleteCookie:function(n){this.setCookie(n,"",-1)},isCookiesAllowed:function(){return!Tangora||Tangora&&!Tangora.StatisticsCollectionMode||Tangora&&Tangora.StatisticsCollectionMode&&Tangora.StatisticsCollectionMode<2?!0:$ts.getCookie("acceptcookies")!=null?!0:!1},getRootUrl:function(n,t){var r=n.match(/(.+?:\/\/[^\/]+).*/),i="";return r!=null&&(i=r[1]),t===!0&&(i+="/"),i},getCurrentRootUrl:function(n){return this.getRootUrl(window.location.href,n)},isUrlLocal:function(n){return n.substring(0,1)==="/"?!0:this.getRootUrl(n)===this.getCurrentRootUrl()},toRelativeUrl:function(n){return n.replace(this.getRootUrl(n),"")},getFlagUrl:function(n){return"/geodata.ashx?action=getflag&countrycode="+n},getUrlParts:function(n){var i,t,r,u;if(n=n||"",i={hash:null,query:null,protocol:null,relativePath:null,domain:null,port:null},t=n.split("#"),n=t[0],t.length>1&&(i.hash=t[1]),t=n.split("?"),n=t[0],t.length>1)for(t=t[1].split("&"),i.query=[],r=0;r<t.length;r++)i.query.push(t[r].split("="));return u=n.match(/^(.+?:\/\/)/),u!=null&&(i.protocol=u[1],n=n.substr(i.protocol.length)),n.indexOf("/")>-1&&(i.relativePath=n.substr(n.indexOf("/")),n=n.split("/")[0]),t=n.split(":"),i.domain=t[0],t.length>1&&(i.port=t[1]),i},isManagerContext:function(){return location.href.toLowerCase().indexOf("/admin/")>-1},isTouchDevice:function(){var n=navigator.userAgent;return/iphone|ipad|ipod|android/i.test(n)},exists:function(n,t){return n!==undefined&&n!==null?t!==undefined&&t!==null?n[t]!==undefined&&n[t]!==null:!0:!1},visible:function(n){while(n.nodeName.toLowerCase()!="body"&&n.style.display.toLowerCase()!="none"&&n.style.visibility.toLowerCase()!="hidden")n=n.parentNode;return n.nodeName.toLowerCase()=="body"?!0:!1},getExpando:function(n,t){return this.exists(n,t)?n[t]:n.getAttribute(t)},ajaxPostForm:function(n,t,i){var u=$elm(n),f,h,r,e,o,s,c;if(i!=null&&$ts.exists(i,"iframed")&&(!$ts.exists(i,"iframed")||i.iframed))h=u.target,i&&i.postdisabled&&$chain("input, textarea, select, div.rtefield",u.parentNode).each(function(n){n.disabled&&(n.disabled=!1,n.setAttribute("switched","1"))}),r=$elm("iframe#saveframe"),r&&r.parentNode.removeChild(r),r=$ts.createElement("iframe",{id:"saveframe",name:"saveframe"},{display:"none",left:"-10000px"}),document.body.appendChild(r),iframeWindow=r.contentWindow||r.contentDocument.parentWindow,e=function(){var n,i;u.target=h;n=r.contentWindow||r.contentDocument;n.document&&(n=n.document);i=n.body?n.body.innerHTML:"";i==""&&(i=n.documentElement.innerHTML);t(r,i)},Tangora.Browser.GetType(),iframeWindow&&(Tangora.Browser.IE||Tangora.Browser.Trident)?(o=0,s=function(){iframeWindow=r.contentWindow||r.contentDocument.parentWindow;iframeWindow&&iframeWindow.document&&iframeWindow.document.readyState=="complete"?e():(o+=50,o<1e4&&setTimeout(s,50))},setTimeout(s,50)):$ts.addEvent(r,"load",e),c=u.target,u.target="saveframe",u.submit(),i&&i.postdisabled&&setTimeout(function(){$chain("input, textarea, select, div.rtefield",u.parentNode).each(function(n){n.getAttribute("switched")=="1"&&(n.disabled=!0,n.removeAttribute("switched"))})},10);else return f=u.action,/^\/?module.aspx/i.test(f)&&(f=location.protocol+"//"+punycode.ToSafeASCII(location.host)+"/admin/"+f,f.indexOf("&popuplayout")==-1&&(f+="&popuplayout=true")),$ts.ajax({url:f,async:$ts.exists(t),data:$ts.collectFormValues(u),type:"POST",complete:t})},ListFunc:new function(){this.regenerateFields=function(n,t,i,r,u){typeof t!="string"&&(t=t.join(","));typeof i!="string"&&(i=i.join(","));var f=[];f.push("listid="+n);f.push("fieldids="+t);f.push("recordids="+i);f.push("maxlevel="+r);$ts.ajax({url:"/listediting.ashx?action=regeneratefields",type:"POST",async:!0,data:f.join("&"),complete:function(n,t){u&&u(t)}})}},ActionBroker:new function(){function t(){this.addAction=function(n,i,r){var u=new t;return u.name=i,u.module=n,u.refname=r,u.data={},this.actions.push(u),u};this.addData=function(n,t){this.data[n]=t};this.setCondition=function(n,t,i){this.condition={filters:[{criterias:[{field:n,operator:t,value:i}]}]}};this.actions=[]}var n=[];this.addAction=function(i,r,u){var f=new t;return f.name=r,f.module=i,f.refname=u,f.data={},n.push(f),f};this.testFlow=function(){var i=$ts.ActionBroker.addAction("list","copyrecord","root"),r,n,t;i.addData("listid",-300097);i.addData("recordids",[1]);i.addData("fieldids",[1842]);r={};r.iscopy=1;r.simulation=0;n=i.addAction("list","updaterecord","updaterootnewroot");n.addData("listid",-300097);n.addData("recordids",["$root.newid"]);n.addData("values",r);n.addData("flags",["noregen"]);t=n.addAction("list","regeneratefields","axis1regen");t.addData("listid",-300098);t.addData("recordids",["$root[1842].newid"]);t.addData("fieldids",[1980]);t.addData("maxlevel",1);this.run()};this.run=function(t){var i=n;n=[];$ts.ajax({url:"/actionbroker.ashx",type:"POST",async:!0,data:JSON.stringify(i),complete:function(n,i){var r=JSON.parse(i);t&&t(r)}})};this.invoke=function(n,t,i){t||(t={});var r="";r=/^\d+$/.test(n)?'{"actionsetid":'+n+', "values":'+JSON.stringify(t)+"}":'{"actionsetinternalname":"'+n+'", "values":'+JSON.stringify(t)+"}";$ts.ajax({url:"/actionbroker.ashx",type:"POST",async:!0,data:r,complete:function(n,t){var r=JSON.parse(t);i&&i(r)}})};this.query=function(t,i){var r=n;n=[];$ts.ajax({url:"/actionbroker.ashx",type:"POST",async:!0,data:t,complete:function(n,t){var r=null;try{r=JSON.parse(t)}catch(u){console.log(t)}i&&i(r)}})};this.execute=function(n,t,i,r){var f=this,u=null;r=r||{tokenCallback:null,broadcastToken:!1,maxQueryInterval:1e4};f.invoke(n,t,function(n){n.code==200?n.state=="Initialized"&&(u=n.output,typeof r.tokenCallback=="function"&&r.tokenCallback(u),f.getUpdates(u,i,r)):n.code==403?i({success:!1,message:"User is not authorized to execute this ActionSet."}):i({success:!1,message:n.message})})};this.getUpdates=function(n,t,i){function f(s){if(o(s),s.code==200)if(s.state=="Done"){var h=e(s);t({success:!0,outlets:h})}else r=Math.min(r*1.1,i.maxQueryInterval||1e4),setTimeout(function(){u.query(n,f)},r);else t({success:!1,message:s.message})}function e(n){var t=null;return n.outlets&&n.outlets.length>0&&(t={},n.outlets.forEach(function(n){if(typeof t[n.Key]!="undefined")if(Array.isArray(t[n.Key]))t[n.Key].push(n.Value);else{var i=t[n.Key];t[n.Key]=[];t[n.Key].push(i);t[n.Key].push(n.Value)}else t[n.Key]=n.Value})),t}function o(t){t&&t.notifications&&Array.isArray(t.notifications)&&t.notifications.forEach(function(t){var r=(t.args||[]).reduce(function(n,t){return n[t.Key]=t.Value,n},{});typeof i.broadcastToken!="undefined"&&i.broadcastToken&&typeof r.token=="undefined"&&(r.token=n);$ts.Observer.Broadcast(t.sender,t.event,r)})}i=i||{broadcastToken:!1,maxQueryInterval:1e4};var u=this,r=100;u.query(n,f)};this.ActivityMonitor=new function(){function e(n,t){function r(n,t){var i=n||"";i&&(i=i+" ");$ts.UI.BusyView.Clear(!0);$ts.UI.BusyView.Show({text:i+ +t+" %"})}function e(){$ts.UI.BusyView.Show()}this.token=n;var i=n,f=t;this.onProgressStart=function(n){a(i,f);r(n,0)};this.onProgressUpdate=function(n,t){r(n,t)};this.onProgressComplete=function(){u(i);$ts.UI.BusyView.Clear(!0)};this.onComplete=function(n){$ts.UI.BusyView.Clear(!0);console.log(n)};e()}function o(n,t){function o(){var n;$ts.addCssRule(".monitor-progress-container","position:fixed; top:0px; left:0px; z-index:99999; width:100%");$ts.addCssRule(".monitor-progress","display:flex; padding:0px 10px; box-sizing:border-box; background-color:#eee; align-items:center; box-shadow:inset 0px 1px #ddd; height:0px; overflow:hidden; transition:height 300ms");$ts.addCssRule(".monitor-progress-text","display:inline-flex; white-space:nowrap; color:#666");$ts.addCssRule(".monitor-progress-message","display:inline-block; width:6em; overflow:hidden; white-space:nowrap; text-overflow:ellipsis;");$ts.addCssRule(".monitor-progress-percent","display:inline-block; width:3em; padding:0px 10px 0px 0px; text-align:right; white-space:nowrap");$ts.addCssRule(".monitor-progress-length","flex-grow:1;height:6px; background-color:#ddd; margin:20px 0px;");$ts.addCssRule(".monitor-progress-position","height:100%; background-color:#aaa; width:0px; transition:width 200ms;");$ts.addCssRule(".monitor-progress-button","margin-left:10px; cursor:pointer; pointer-events:none; opacity:0; transition:opacity 300ms;");$ts.addCssRule(".complete .monitor-progress-button","opacity:1; pointer-events:auto");$ts.addCssRule(".progress-unknown .monitor-progress-text","display:none");$ts.addCssRule(".progress-unknown .monitor-progress-button","display:none");$ts.addCssRule(".progress-unknown .monitor-progress-position","width:100%; background-image:linear-gradient(90deg, #ddd 25%, #ccc 75%, #ddd); background-repeat:no-repeat background-position:0% 0px; background-size:300px 100%;");i=$ts.createElement("div",{className:"monitor-progress progress-unknown","data-monitor-token":r},{height:"0px"});var u=$ts.createElement("div",{className:"monitor-progress-length"}),f=$ts.createElement("div",{className:"monitor-progress-position"}),t=$ts.createElement("div",{className:"monitor-progress-text"}),e=$ts.createElement("span",{className:"monitor-progress-message"}),o=$ts.createElement("span",{className:"monitor-progress-percent"}),h=$ts.createElement("div",{className:"monitor-progress-button",innerHTML:"&times;",onclick:l});u.appendChild(f);t.appendChild(e);t.appendChild(document.createTextNode(" "));t.appendChild(o);i.appendChild(t);i.appendChild(u);i.appendChild(h);n=document.querySelector(".monitor-progress-container");n||(n=$ts.createElement("div",{className:"monitor-progress-container"}),document.body.insertBefore(n,document.body.firstChild));n.appendChild(i);s();c()}function f(n,t){h();var i=n||"",f=document.querySelector('[data-monitor-token="'+r+'"] .monitor-progress-position'),u=document.querySelector('[data-monitor-token="'+r+'"] .monitor-progress-message'),e=document.querySelector('[data-monitor-token="'+r+'"] .monitor-progress-percent');f.style.width=t+"%";u.innerHTML=i;u.title=i;u.style.display=i?"":"none";e.innerHTML=t!==null?t+" %":"&nbsp;"}function s(){function n(){if(i.classList.contains("progress-unknown")){var u=(new Date).getTime()-r,f=Math.floor(u/2)+"px";t.style.backgroundPosition=f+" 0%";requestAnimationFrame(n)}else t.style.backgroundPosition=""}var r=(new Date).getTime(),t=i.querySelector(".monitor-progress-position");i.classList.add("progress-unknown");n()}function h(){i.classList.remove("progress-unknown")}function c(){setTimeout(function(){i.style.transition="";i.style.height="auto";var n=i.clientHeight;i.style.height="0px";i.style.transition="";setTimeout(function(){i.style.height=n+"px"},100)},100)}function l(){setTimeout(function(){i.style.height="0px";setTimeout(function(){i.parentNode.removeChild(i)},300)},100)}this.token=n;var r=n,e=t,i=null;this.onProgressStart=function(n){a(r,e);f(n,0)};this.onProgressUpdate=function(n,t){f(n,t)};this.onProgressComplete=function(n){u(r);y(r);f(n,100);i.classList.add("complete")};this.onComplete=function(n){setTimeout(function(){i.classList.contains("complete")||(i.classList.add("complete"),f(null,100))},100);console.log(n)};o()}function s(){$ts.Observer.UnRegister("progress","progressstart",h);$ts.Observer.UnRegister("progress","progressupdate",c);$ts.Observer.UnRegister("progress","progresscomplete",l);$ts.Observer.Register("progress","progressstart",h);$ts.Observer.Register("progress","progressupdate",c);$ts.Observer.Register("progress","progresscomplete",l)}function v(t){return typeof t=="object"?t?t:{type:n.busyview}:t+""=="0"?{type:n.busyview}:t+""=="1"?{type:n.progressbar}:void 0}function i(n){t.push(n)}function y(n){t=t.filter(function(t){return t.token!=n})}function r(n){return t.filter(function(t){return t.token==n})[0]}function h(n,t,i){var u=r(i.token);if(u)u.onProgressStart(i.message||"")}function c(n,t,i){var f=r(i.token),u;if(f){u=Math.floor(parseInt(i.position)/parseInt(i.length)*100);u=Math.min(100,Math.max(0,u));f.onProgressUpdate(i.message||"",u)}}function l(n,t,i){var u=r(i.token);if(u)u.onProgressComplete(i.message||"")}function a(n,t){var i=JSON.parse(window.sessionStorage.getItem("sessions")||"[]");i=i.filter(function(t){return t.token!=n});i.push({token:n,settings:t});window.sessionStorage.setItem("sessions",JSON.stringify(i))}function u(n){var t=JSON.parse(window.sessionStorage.getItem("sessions")||"[]");t=t.filter(function(t){return t.token!=n});t.length>0?window.sessionStorage.setItem("sessions",JSON.stringify(t)):window.sessionStorage.removeItem("sessions")}function p(t,r){$ts.ActionBroker.query(t,function(h){if(h.state!="InProgress")u(t);else{s();switch(r.type){case n.busyview:i(new e(t,r));break;case n.progressbar:i(new o(t,r));break;default:throw new Error("Could not resume unknown activity-indicator-type: "+r.type);}$ts.ActionBroker.getUpdates(t,function(n){console.log(n)},{broadcastToken:!0,maxQueryInterval:f})}})}var t=[],f=1e3,n={busyview:"busyview",progressbar:"progressbar"};this.startActionSet=function(t,u,h){s();var c=null,l=v(h);$ts.UI.BusyView.Show();$ts.ActionBroker.execute(t,u,function(n){var t=r(c);if(t)t.onComplete(n)},{broadcastToken:!0,maxQueryInterval:f,tokenCallback:function(t){c=t;$ts.UI.BusyView.Clear();switch(l.type){case n.busyview:i(new e(c,l));break;case n.progressbar:i(new o(c,l))}typeof callback=="function"&&callback(c)}})};window.addEventListener("load",function(){var n=JSON.parse(window.sessionStorage.getItem("sessions")||"[]");n.forEach(function(n){p(n.token,n.settings)})})}},MultiPost:new function(){var n=[],t=0;return this.addRecord=function(i){i||(i=--t);var r={id:i,fields:[],type:"append/update"};return n.push(r),this.add=function(n,t){r.fields.push({name:n,value:t})},r.toString=function(){var t="";for(var n in this.fields)t+=t==""?this.id+"_"+this.fields[n].name+"="+this.fields[n].value:"&"+this.id+"_"+this.fields[n].name+"="+this.fields[n].value;return t},r.addNameValuePairs=function(n){for(var t in this.fields)n[this.id+"_"+this.fields[t].name]=this.fields[t].value},this},this.deleteRecord=function(t){var i={id:t,type:"delete"};n.push(i)},this.post=function(i,r,u,f,e){var s={},c=[],h,o,l;for(o in n)h=n[o],h.type!="delete"?h.addNameValuePairs(s):c.push(h.id);if(s.__delete=c.join(","),e)for(o in e)s["__setting_"+o]=e[o];return l=$ts.ajax({url:"/multipost.ashx?id="+i+"&listid="+r,type:"POST",async:f?!1:!0,data:s,complete:function(n,t){u&&u(t)}}),n=[],t=0,l},this},multiPartEncode:function(n){var t,r,u,i,f;if(!n)return null;t="";r="---------------------------14737809831466499882746641449";request.setRequestHeader("Content-Type","multipart/form-data; boundary="+r);for(u in n)if(i=n[u],typeof i!="object"&&typeof i!="function")t+="\r\n--"+r+"\r\n",t+='Content-Disposition: form-data; name="'+u+'"\r\n',t+="Content-Type: text/html\r\n\r\n",t+=i;else if(typeof i=="object"&&i.length>0)for(f=0;f<i.length;f++)t+="\r\n--"+r+"\r\n",t+='Content-Disposition: form-data; name="'+u+'"\r\n',t+="Content-Type: text/html\r\n\r\n",t+=i[f];return t+="\r\n--"+r+"--\r\n",[r,t]},spaEncode:function(n){return $ts.formEncode(n,"¤¤¤spa¤¤¤")},formEncode:function(n,t){var r,f,i,u,e;if(!n)return"";t||(t="&");r="";for(f in n)if(i=n[f],r.length>0&&(r+=t),typeof i!="object"&&typeof i!="function")r+=f+"="+i;else if(typeof i=="object"&&i.length>0){for(u="",e=0;e<i.length;e++)u+=t+f+"="+i[e];r.length==0&&(u=u.substring(1));r+=u}return r},getFormValues:function(n){var i=$elm(n),u,f,t,e,r;if(i||(i=$elm('form[name="'+n+'"]')),i){for(u={},f=0;f<i.elements.length;f++)if(t=i.elements[f],t.type!="checkbox"&&t.type!="radio"||t.checked)if(t.type=="select-multiple"){for(e=[],r=0;r<t.options.length;r++)t.options[r].selected&&e.push(t.options[r].value);u[t.name]=e}else t.type=="button"||t.type=="submit"||(u[t.name]=t.value);return u}},collectFormValues:function(n,t){var f=$elm(n),r,s,e,i,u,o;if(f||(f=$elm('form[name="'+n+'"]')),f){for(r="",s=!1,e=0;e<f.elements.length;e++)if(i=f.elements[e],e>0&&!s&&(r=r+"&"),i.type!="checkbox"&&i.type!="radio"||i.checked)if(i.type=="select-multiple"){for(u="",o=0;o<i.options.length;o++)i.options[o].selected&&(u!=""&&(u=u+","),u=u+i.options[o].value);r=r+i.name+"="+u}else i.type=="button"||i.type=="submit"?s=!0:(r=t?r+i.name+"="+i.value:r+i.name+"="+encodeURIComponent(i.value),s=!1);return r}},collectDataFromContainer:function(n,t){var h={},f,e,i,o,r,s,u;if(!n)return h;if(t||(t=window),f=$elms("input, textarea, select, .rtefield",n),f)for(e=0;e<f.length;e++){i=f[e];o=i.id;$ts.isNullOrEmpty(o)&&(o=i.name);r="";switch(i.tagName.toLowerCase()){case"input":r=i.value;i.type=="checkbox"?r=i.checked:i.type=="radio"&&(r=i.checked);break;case"textarea":r=i.value;break;case"select":if(r="",i.multiple){for(s=[],u=0;u<i.options.length;u++)i.options[u].selected&&s.push(i.options[u].value);s.length>0&&(r=s.join(","))}else i.selectedIndex>-1&&(r=i[i.selectedIndex].value);break;case"div":r=t.rte(i.id).GetContent()}h[o]=r}return h},ajaxSetup:function(n){for(var t in n)this.ajaxSettings.hasOwnProperty(t)&&(this.ajaxSettings[t]=n[t])},delayFunc:function(n,t){var i=function(){var u=arguments,n=i.runTime-(new Date).getTime(),r=function(){t.apply(t,u)};n>0?setTimeout(r,n):r()};return i.runTime=(new Date).getTime()+n,i},ajax:function(n,t){function w(){i.readyState==4&&n.complete&&(n.noncacheable!=!0&&(e.$ts.ajaxCache[r]=i.responseText),n.complete(i,i.responseText))}function d(){var t,r;n.progress&&(t=i.responseText,t.length<h&&(h=0),r=t.substring(h),h=t.length,n.progress(i,r))}var s,e,v,p,b,h,g,l,y,u,f,a,o,c;for(s in this.ajaxSettings)this.ajaxSettings.hasOwnProperty(s)&&!$ts.exists(n,s)&&(n[s]=this.ajaxSettings[s]);var k=function(){var t,n;if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)for(t=["Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++)try{return new ActiveXObject(t[n])}catch(i){}},i=k(),r=n.url;if(n.type=="GET"&&$ts.exists(n,"data")&&n.data!==""&&(r+=n.data),e=top,typeof isframed!="undefined"&&isframed)e=window;else try{e.$ts||(e=window)}catch(nt){e=window}if(n.noncacheable==!0)v=(new Date).getTime(),p=r.indexOf("?")===-1?"?":"&",r+=p+"ts"+v+"="+v;else if(n.type=="GET"&&e.$ts.ajaxCache[r]){if(n.complete){n.complete(null,e.$ts.ajaxCache[r]);return}return e.$ts.ajaxCache[r]}if(i.open(n.type,t?"/services/relay.ashx":r,n.async),b=!1,n.chunked){if(!("onprogress"in i)){if(n.type=="POST"&&typeof n.data=="object"){u=n.data;f="&";for(o in u)c=u[o],f+=o+"="+c+"&";f+="xdom=1";b=!0;u=f;r+=u}i=new XDomainRequest;i.open(n.type,t?"/services/relay.ashx":r,n.async);i.onreadystatechange=w}}else i.onreadystatechange=w;if(h=0,n.chunked&&(i.onprogress=d,n.ontimeout&&(g=this,l=!1,i.ontimeout=function(){var t=i.getResponseHeader("detach"),r;t&&t=="true"||(r=l,l=!0,r||n.ontimeout())},setTimeout(function(){if(!l){var t=i.getResponseHeader("detach");t&&t=="true"||n.ontimeout()}},parseInt(n.timeout,10)+1e3)),i.timeout=n.timeout),$ts.exists(n,"HttpHeaders"))for(y in n.HttpHeaders)i.setRequestHeader(y,n.HttpHeaders[y]);if(t&&(i.setRequestHeader("endpoint",r),(n.type!="POST"||$ts.exists("HttpHeaders"))&&(!$ts.exists("HttpHeaders")||$ts.exists(n.HttpHeaders,"Content-Type"))||i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),n.type=="POST"){if(n.type!="POST"||t||typeof n.data=="object"||"setRequestHeader"in i&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),u=n.data,typeof n.data=="object")if("setRequestHeader"in i){f="";a="---------------------------14737809831466499882746641449";i.setRequestHeader("Content-Type","multipart/form-data; boundary="+a);for(o in u)c=u[o],f+="\r\n--"+a+"\r\n",f+='Content-Disposition: form-data; name="'+o+'"\r\n',f+="Content-Type: text/html\r\n\r\n",f+=c;f+="\r\n--"+a+"--\r\n";u=f}else u="";i.send(u)}else i.send();if(!n.async)return n.noncacheable!=!0&&(e.$ts.ajaxCache[r]=i.responseText),i.responseText},Server:new function(){var t=function(n,t,i){var r,u;return!n||n==""?null:(r=eval("("+n+")"),t&&(u=i?i:"Object",r.Debug(u)),r)},i=function(n){if(!n||n=="")return null;return eval(n)},n;return this.call=function(t,i,r,u){return n(t,i,null,!1,r,u)},this.callSync=function(t,i,r,u,f){return n(t,i,r,!1,u,f)},this.callAsync=function(t,i,r,u,f){return n(t,i,r,!0,u,f)},n=function(n,r,u,f,e,o){var h={},v=0,c,s,l;if(r&&!r.length)for(c in r)o?h["ax_"+c]=r[c]:h[v]=r[c],v++;else if(r)for(s=0;s<r.length;s++)h[s]=r[s];var a=null,y=function(){p();$ts.ajax(a)},p=function(){top.$ts.Observer.UnRegister("manager","logindone",y)};return a={url:"/ajax.ashx?action="+n,type:"POST",data:h,async:f,complete:function(r,f){if(f=="SESSION_INVALID_LOGIN")u&&top.$ts.Observer.Register("manager","logindone",y),Tangora.Ajax.ShowLoginForm();else if(u){var o=f;if(e)try{o=f.indexOf("[")==0?i(f):t(f,!1,n+".Result")}catch(s){throw new Error(n+".GetScript couldn't evaluate data.\nReason: "+s.message);}u(o)}}},l=$ts.ajax(a),e&&(l=eval("("+l+")")),l},this},Socket:new function(){var n={};return n.canSocket=function(){return!1},this.Connect=function(){var t,i,r;n.canSocket()?(n.ws=new WebSocket("ws://"+punycode.ToSafeASCII(location.hostname)+":8088/websession"),n.addSocketInterface=function(n){n.onopen=function(){$ts.consoleDevWrite("webSocket open");$ts.SocketEnabled=!0};n.onmessage=function(n){var i,t;$ts.consoleDevWrite("webSocket message: "+n.data);try{i=eval("("+n.data+")");i.type=="notification"&&(t=i.object,top.$ts.Observer.Broadcast(t.origin,t.name,t))}catch(r){$ts.consoleWrite(r.description)}};n.onclose=function(){$ts.consoleDevWrite("webSocket closed");$ts.SocketEnabled=!1}},n.addSocketInterface(n.ws)):($ts.SocketEnabled=!0,t={},t.processMessage=function(n,t){var r,i;n=="systemevent"&&(r=t.data,r&&r.event=="notification"&&(i=r.notification.object,top.$ts.Observer.Broadcast("socket","notification-recieved",i),(i.recipient==null||i.recipient==$ts.UID)&&(i.requirereciet&&$ts.Server.callAsync("NotificationRecived",{nid:i.id,uid:$ts.UID},function(){}),top.$ts.Observer.Broadcast(i.origin,i.name,i))))},i=$ts.createUID(),r="4E41FCC1-F4F3-466D-8BB3-E0C2384014E8",$chat.subscribe(r,"",i,"",function(n){user=n;$chat.easylisten(r,user,i,t)}))},this},Observer:new function(){var n=[],i=function(t){for(var r,i=0;i<n.length;i++)if(r=n[i],t.key==undefined){if(r.who===t.who&&r.what===t.what&&(r.where===t.where||t.where==="*"))return i}else if(r.key===t.key)return i;return-1},r=function(t,i){var f,u,r;for(typeof t!="string"&&(t=t.id),f=[],u=n.length-1;u>=0;u--)r=n[u],(r.who==t||r.who==="*")&&(r.what==i||r.what==="*")&&(f.push(r),r.oneshot&&n.splice(u,1));return f},t=function(n,t,i){return{who:n,what:t,where:i}};return this.SafeRegister=function(t,i,r,u){var e=function(n,t,i){try{r.call(n,n,t,i)}catch(u){$ts.Observer.UnRegister(n,t,r)}},f={who:t,what:i,where:e,oneshot:u==!0};return n.push(f),$ts.debug.observer.registration&&$ts.consoleWrite("saferegister: "+t+" , "+i+" , "+u),f},this.SafeRegisterOneShot=function(n,t,i){$ts.Observer.SafeRegister(n,t,i,!0)},this.SafeRegisterByKey=function(n,t,i,r){var u=$ts.Observer.SafeRegister(t,i,r,!1);u.key=n},this.Register=function(i,r,u){n.push(t(i,r,u));$ts.debug.observer.registration&&$ts.consoleWrite("register: "+i+" , "+r+" , false")},this.RegisterByKey=function(i,r,u,f){var e=t(r,u,f);e.key=i;n.push(e);$ts.debug.observer.registration&&$ts.consoleWrite("register: "+r+" , "+u+" , false")},this.RegisterOneShot=function(t,i,r){n.push({who:t,what:i,where:r,oneshot:!0});$ts.debug.observer.registration&&$ts.consoleWrite("registeroneshot: "+t+" , "+i+" , true")},this.UnRegister=function(r,u,f){$ts.debug.observer.registration&&$ts.consoleWrite("unregister: "+r+" , "+u);var e=i(t(r,u,f));return e>-1?(n.splice(e,1),!0):!1},this.UnRegisterByKey=function(r){var f=t("","",""),u;return(f.key=r,u=i(f),u>-1)?(n.splice(u,1),!0):!1},this.Broadcast=function(n,t,i){for(var f=r(n,t),u=0;u<f.length;u++)f[u].where.call(n,n,t,i)},this.BroadcastDebug=function(n,t,i){var r="";try{r=JSON.stringify(i)}catch(u){r="(#circular ref)"}$ts.consoleDevWrite("'"+n+" sendt '"+t+"' with data: "+r)},this},mathExpressions:new function(){return this._decimalSign=",",this._thousandSeparator=".",this._expressions=[],this._resolvers=[],this.formatNumber=function(n,t){return $ts.formatNumber(n,t)},this.addThousandSeparator=function(n){return $ts.addThousandSeparator(n,this._thousandSeparator)},this.FormatValue=function(n,t,i,r){return $ts.formatValue(n,t,i,r)},this.removeFormatting=function(n){var u=typeof n=="object";n=n+"";var r=/([.,])\d{3}([.,]|$){1}/gi.exec(n),i="",t="";return r?(t=r[1],i=t==","?".":","):n.indexOf(".")>-1?(i=".",t=","):n.indexOf(",")>-1&&(i=",",t="."),i&&t&&(t=="."?n=n.replace(/\./gi,""):t==","&&(n=n.replace(/,/gi,"")),i==","&&(n=n.replace(/,/gi,"."))),this.toNumber(n)},this.toNumber=function(n){return parseFloat(n,10)},this.addResolver=function(n,t){this._resolvers[n]=t},this.addExpression=function(n,t){this._expressions[n]=t},this.getResolver=function(n){return this._resolvers[n]},this.execExpression=function(n,t){for(var l=this._expressions[n],a=new RegExp("{.*?}|\\[.*?\\]",""),i=null,u=l,e,o,r,h,f,c,s,v,i=a.exec(l);i;){if(t&&typeof t[i]!="undefined")u=u.replace(i,t[i]);else{e=i[0];o=0;i[0].indexOf(",")>-1&&(e=i[0].split(",")[0]+"}",o=Number(this.removeFormatting(i[0].split(",")[1].replace("}","").replace("]",""))));r=0;try{if(h=this._resolvers[e],h)if(f=h(),Object.prototype.toString.call(f)=="[object Array]"){for(c=0,s=0;s<f.length;s++)c+=this.removeFormatting(f[s]);r=c}else r=this.removeFormatting(f);else r=this.removeFormatting(this.execExpression(e.replace("{","").replace("}","").replace("[","").replace("]","")));isNaN(r)&&(r=o)}catch(y){r=o}u=u.replace(i,r)}v=u;i=a.exec(v)}return Number(eval(u))},this},urlParser:new function(){var n,t;this.Parameters=[];this.IndexedParameters=[];this.Parse=function(n){for(var r=n.split("?"),e=r.length>1?r[1]:"",u=e.split("&"),t=[],i=0;i<u.length;i++){var f=u[i].split("="),o=f[0],s=f[1];t[o]=s;t.length++}return t};this.Parameters=this.Parse(location.href);for(n in this.Parameters)this.Parameters.hasOwnProperty(n)&&(t={q:n,v:this.Parameters[n]},this.IndexedParameters.push(t));return this},Promote2Top:function(n){var t=$ts.getPosition(n,!0,window.top);$ts.exists(n.parentNode)&&($ts.exists(n.parentNode.orphans)||(n.parentNode.orphans=[]),n.parentNode.orphans.push(n));n.previousParent=n.parentNode;window.top.document.body.appendChild(n);n.style.position="absolute";n.style.top=t[1]+"px";n.style.left=t[0]+"px";n.style.zIndex=5e3},XmlDocument:new function(){return this.createNew=function(){var n=null;return this.loadXml=function(t){n=(new DOMParser).parseFromString(t,"text/xml")},this.selectSingleNode=function(t){var i=$xpath(t,n);if(i.length>0)return i[0]},this.selectNodes=function(t){return $xpath(t,n)},this.GetXml=function(){return(new XMLSerializer).serializeToString(n)},this},this},UI:new function(){var n={};return n.ClearEnable=function(n){if(typeof n=="string"&&(n=$elm(n)),n.ClearButton=$ts.createElement("a",null,{position:"absolute"}),n.ClearButton.appendChild($ts.createElement("img",{src:"/setup/clear.png"},{width:"12px",height:"12px",cursor:"pointer"})),$ts.getComputedStyle(n,"float")!=="left"&&$ts.getComputedStyle(n,"float")!=="right"&&$ts.getComputedStyle(n,"position")!=="absolute"){var t=$ts.safeInt($ts.getComputedStyle(n,"margin-top"),0)+4;n.ClearButton.style.marginTop=t+"px";n.ClearButton.style.marginLeft="-16px"}$ts.exists(n.nextSibling)?n.parentNode.insertBefore(n.ClearButton,n.nextSibling):n.parentNode.appendChild(n.ClearButton);n.UpdateClearButton=function(){n.ClearButton.style.display=this.value===""||$ts.exists(this.watermarkText)&&this.value===this.watermarkText?"none":""};$ts.addEvent(n,"keydown",n.UpdateClearButton);$ts.addEvent(n,"mouseup",n.UpdateClearButton);n.UpdateClearButton();$ts.addEvent(n.ClearButton,"click",function(){n.value="";$ts.exists(n.WatermarkToggle)&&n.WatermarkToggle();n.UpdateClearButton()})},n.WatermarkEnable=function(n,t,i){typeof n=="string"&&(n=$elm(n));n.watermarkText=t;n.WatermarkToggle=function(){n.value===""&&(n.value=n.watermarkText,$ts.addClass(n,i));$ts.exists(n.UpdateClearButton)&&n.UpdateClearButton()};$ts.exists(i)||(i="watermarked");$ts.addEvent(n,"blur",n.WatermarkToggle);$ts.addEvent(n,"focus",function(){n.value===n.watermarkText&&(n.value="",$ts.removeClass(n,i))});n.blur()},n.ClickScrollEnable=function(n,t,i){var f,r=!1,o=50,u=15,e=function(){r?t.scrollTop+=u:clearInterval(f)};switch(i.toLowerCase()){case"up":u*=-1;break;case"left":u*=-1;case"right":e=function(){r?t.scrollLeft+=u:clearInterval(f)}}n.onmousedown=function(){r=!0;f=setInterval(e,o)};n.onmouseup=function(){r=!1};n.onmouseout=n.onmouseup},n.Animation=function(){var n={};return n.Expand=function(n,t){if($ts.exists(n)&&n.animating!==!0&&$ts.exists(n.parentNode)&&n.style.display=="none"){$ts.exists(t)||(t={});$ts.exists(t.id)||(t.id=$ts.createUID());$ts.exists(t.time)||(t.time=Math.max(n.offsetHeight,500));var i=n.parentNode.insertBefore($ts.createElement("div",null,{overflow:"hidden",height:"0px"}),n);i.style.float=$ts.getComputedStyle(n,"float");i.style.clear=$ts.getComputedStyle(n,"clear");i.style.position=$ts.getComputedStyle(n,"position");i.style.zIndex=$ts.getComputedStyle(n,"z-index");try{i.style.tableRow=$ts.getComputedStyle(n,"table-row");i.style.tableCell=$ts.getComputedStyle(n,"table-cell")}catch(r){}return i.appendChild(n),n.style.display="",$ts.Animation.Change(i,"height",n.offsetHeight+"px",t.time,function(){$ts.exists(n)&&$ts.exists(n.parentNode)&&$ts.exists(i)&&$ts.exists(i.parentNode)&&(i.parentNode.insertBefore(n,i),n.parentNode.removeChild(i),i=null,n.animating=null,$ts.exists(t.callback)&&t.callback())},0,t.easing),n.animating=!0,t.id}},n.Collapse=function(n,t){if($ts.exists(n)&&n.animating!==!0&&$ts.exists(n.parentNode)&&n.style.display!="none"){$ts.exists(t)||(t={});$ts.exists(t.id)||(t.id=$ts.createUID());$ts.exists(t.time)||(t.time=Math.max(n.offsetHeight,500));var i=n.parentNode.insertBefore($ts.createElement("div",null,{overflow:"hidden"}),n);i.style.float=$ts.getComputedStyle(n,"float");i.style.clear=$ts.getComputedStyle(n,"clear");i.style.position=$ts.getComputedStyle(n,"position");i.style.zIndex=$ts.getComputedStyle(n,"z-index");try{i.style.tableRow=$ts.getComputedStyle(n,"table-row");i.style.tableCell=$ts.getComputedStyle(n,"table-cell")}catch(r){}return i.appendChild(n),i.style.height=i.offsetHeight+"px",$ts.Animation.Change(i,"height","0px",t.time,function(){n.style.display="none";i.parentNode.insertBefore(n,i);n.parentNode.removeChild(i);i=null;n.animating=null;$ts.exists(t.callback)&&t.callback()},0,t.easing),n.animating=!0,t.id}},n.Reveal=function(n,t){if($ts.exists(n)&&n.animating!==!0&&$ts.exists(n.parentNode)&&n.style.display=="none"){$ts.exists(t)||(t={});$ts.exists(t.id)||(t.id=$ts.createUID());$ts.exists(t.time)||(t.time=Math.max(n.offsetHeight,500));var i=n.parentNode.insertBefore($ts.createElement("div"),n),r=i.appendChild($ts.createElement("div",null,{overflow:"hidden",height:"0px",position:"relative"})),u=r.appendChild($ts.createElement("div",null,{position:"absolute",bottom:"0px"}));i.style.float=$ts.getComputedStyle(n,"float");i.style.clear=$ts.getComputedStyle(n,"clear");i.style.position=$ts.getComputedStyle(n,"position");i.style.zIndex=$ts.getComputedStyle(n,"z-index");try{i.style.tableRow=$ts.getComputedStyle(n,"table-row");i.style.tableCell=$ts.getComputedStyle(n,"table-cell")}catch(f){}return u.appendChild(n),n.style.display="",$ts.Animation.Change(r,"height",u.offsetHeight+"px",t.time,function(){$ts.exists(n)&&$ts.exists(n.parentNode)&&$ts.exists(r)&&$ts.exists(r.parentNode)&&(i.parentNode.insertBefore(n,i),u.parentNode.removeChild(u),r.parentNode.removeChild(r),i.parentNode.removeChild(i),i=null,r=null,u=null,n.animating=null,$ts.exists(t.callback)&&t.callback())},0,t.easing),n.animating=!0,t.id}},n.Conceal=function(n,t){if($ts.exists(n)&&n.animating!==!0&&$ts.exists(n.parentNode)&&n.style.display!="none"){$ts.exists(t)||(t={});$ts.exists(t.id)||(t.id=$ts.createUID());$ts.exists(t.time)||(t.time=Math.max(n.offsetHeight,500));var i=n.parentNode.insertBefore($ts.createElement("div"),n),r=i.appendChild($ts.createElement("div",null,{overflow:"hidden",height:n.offsetHeight+"px",position:"relative"})),u=r.appendChild($ts.createElement("div",null,{position:"absolute",bottom:"0px"}));i.style.float=$ts.getComputedStyle(n,"float");i.style.clear=$ts.getComputedStyle(n,"clear");i.style.position=$ts.getComputedStyle(n,"position");i.style.zIndex=$ts.getComputedStyle(n,"z-index");try{i.style.tableRow=$ts.getComputedStyle(n,"table-row");i.style.tableCell=$ts.getComputedStyle(n,"table-cell")}catch(f){}return u.appendChild(n),n.style.display="",$ts.Animation.Change(r,"height","0px",t.time,function(){$ts.exists(n)&&$ts.exists(n.parentNode)&&$ts.exists(r)&&$ts.exists(r.parentNode)&&(n.style.display="none",i.parentNode.insertBefore(n,i),u.parentNode.removeChild(u),r.parentNode.removeChild(r),i.parentNode.removeChild(i),i=null,r=null,u=null,n.animating=null,$ts.exists(t.callback)&&t.callback())},0,t.easing),n.animating=!0,t.id}},n}(),n}};window.$ts=new t;window.loaded=!1;window.__$ts_class=t;$ts.addEvent(window,"DOMContentLoaded",function(){for(window.loaded=!0;$ts.readyScripts.length>0;)try{var t=$ts.readyScripts.shift();t.apply(window)}catch(n){try{console.log("Ready script error:");console.log(n)}catch(i){$ts.consoleWrite("Ready script error: "+n.message)}}});$ts.addEvent(window,"load",function(){window.loaded=!0})})();$ts.debug.observer.broadcast&&this.Register("*","*",$ts.Observer.BroadcastDebug);typeof Tangora=="undefined"&&(Tangora={});Tangora.BroadcastController=$ts.Observer;Tangora.CalculationLibrary=$ts.mathExpressions;Tangora.Globals={};LazyLoad=new function(){function n(n){var t,r,i;if($ts.exists(n)&&n!==""){for(r=n.split("."),n=window,t=0;t<r.length;t++)i=r[t]+"",$ts.exists(n[i])||(n[i]={}),n=n[i];return n}return window}function t(t,i,r,u,f){var s,l,o,h,e,c;for(ts_minified&&(t=t.replace(/(\.js)(?:,|$)/ig,".min.js")),t=t.split(","),s=!0,o=0;o<t.length;o++)h=$ts.ajax({url:t[o]+buildCode,async:!1,type:"GET",noncacheable:!1}),h!=""?(eval(h),s=!1):l=t[o];if(s)c='Unable to resolve the lazy loaded method "'+r+'" on the object "'+i+'", from "'+l+'"',$ts.consoleWrite(c),$ts.ajax({url:"/500.aspx",type:"POST",data:"error="+c});else return e=n(i),e===window?f?eval(r).apply(e,u):eval(r).apply(e,u):f?new e[r](u[0],u[1],u[2],u[3],u[4],u[5]):e[r].apply(e,u)}this.WireUp=function(i,r,u,f){var s=n(i),o,e;for(r=r.split(","),e=0;e<r.length;e++)o=r[e],typeof s[o]=="undefined"?s[o]=function(n){return function(){return t(u,i,r[n],arguments,f)}}(e):$ts.debug.lazyload===!0&&$ts.consoleDevWrite("LazyLoad prevented wiring up function that was allready loaded. Namespace: "+i+". FunctionName: "+o+". Source: "+u)};this.SrcFormatter=function(n){return ts_minified&&(n=n.replace(/(\.js)(?:,|$)/ig,".min.js")),n+buildCode}};LazyLoad.WireUp("Tangora.PublicAnimation","AnimationEnded,CurrentView,WireupElements,AddAnimationCapabilities,OpacityFade,Resize,ChangeColor,ChangeMargin,MoveToCenter,Move,StartTimer,Ease,SetOpacity","/lib/tangora.public.animation.js");LazyLoad.WireUp("$ts.Animation","Create,Change,GetEasingFunc,CurrentView,GetOpacity,SetOpacity,GetZoomProperty,SetZoomLevel,CreateAnimElm,ParseValue,GetOffset,SetScrollTop,SetScrollLeft,Load,AddTransformCapabilities,ExtractColor,IEVersionAndMode,CSSAnimationSupport","/lib/animation.js");LazyLoad.WireUp("$ts.UI.BusyView","Load,Show,VisibleTime,Clear,Hide,Reveal","/lib/BusyView.js");LazyLoad.WireUp("LightBox","ForceFastMode,Dispose,SetOverlay,SetContents,Show,SetCloseEvents,Close,Init,Open,IsOpen,SetPreview,OpenPageContent,OpenFramedContent,OpenFramedPageContent","/lib/lightbox.js");LazyLoad.WireUp("LegacyLightBox","ForceFastMode,Dispose,SetOverlay,SetContents,SetCloseButton,Show,SetCloseEvents,Close,Init,Open,IsOpen,SetPreview","/lib/lightbox.legacy.js");LazyLoad.WireUp("CSSLightBox","CreateSettings,Create,Open,","/lib/lightbox.css.js");LazyLoad.WireUp("Tangora.DOM","GetType,EnsureElement,CheckElements,MoveElement,CloneElement,GetCollection,GetCollectionByClassName,GetFirstCollectionMember,GetFirstCollectionMemberByClassName,MoveFirstCollectionMember,MoveFirstCollectionMemberByClassName,CloneFirstCollectionMember,CloneFirstCollectionMemberByClassName","/lib/tslib/tdom.js");LazyLoad.WireUp("Tangora.Browser","GetType,Name,Version,Safari,Gecko,Firefox,Opera,IE,Trident","/lib/tslib/tbrowser.js");LazyLoad.WireUp("Tangora.Common","GetType,DoUnEscape","/lib/tslib/tcommon.js");LazyLoad.WireUp("Tangora.ErrorHandler","GetType,Silent,ThrowError","/lib/tslib/terrorhandler.js");LazyLoad.WireUp(null,"CancelBubble,TSSetCapture,TSReleaseCapture,TSSetCaptureOnFocus,TSCaptureOnclickHandler,TSCaptureOncontextmenuHandler,TSCaptureKeyHandler,addSaveKeyHandler,saveKeyHandler,CalendarHide,CalendarLoaded,getWindowHeight,getWindowWidth,get_url,TSCA_LoadContentArea,TSCA_Hover,ToLegalNumberString,GetIframeDocument,setCaretToStart,setCaretToEnd,evalExpr,TSGetSelectValues,setWindowStatus,PostFormUsingHTTPReq","/lib/tslib/ILScriptLazy.js");LazyLoad.WireUp("Tangora.CSSHelper","GetType,GetCascadedStyle","/lib/csshelper.js");LazyLoad.WireUp("LZW","compress,decompress,localCompress,localDecompress","/lib/lzw.js");LazyLoad.WireUp("clientStorage","Init","/lib/storage.js");LazyLoad.WireUp("Tangora.UploadHelper","InitControl","/lib/uploadhelper.js");LazyLoad.WireUp("EXIF","getData,getTag,getAllTags,pretty,readFromBinaryFile,createBinaryFile","/lib/exif.js");LazyLoad.WireUp(null,"downScaleImage,downScaleCanvas","/lib/imagedownscale.js");LazyLoad.WireUp("punycode","utf16,decode,encode,ToASCII,ToUnicode,ToSafeASCII","/lib/tslib/punicode.js");LazyLoad.WireUp("PagePreview","Generate","/lib/PagePreview.js");LazyLoad.WireUp("$ts.UI.EditorUtils","Consolidate,isTableElement,isBlockElement,isInlineElement,isClosedElement,isTag,isNodeInNode,setSelection,iterateDOM,scrollToNode,convertNode,wrapContent,removeNode","/lib/tslib/editor.js");LazyLoad.WireUp("$ts.UI.EditorUtils.Consolidate","paragraph","/lib/tslib/editor.js");LazyLoad.WireUp("Tangora.Editors","registerEditor,getEditor,Init","/lib/tslib/editor.js");LazyLoad.WireUp("Tangora.Toolbars","register,removeByToolbarId,getByToolbarId,getByOwnerElementId,Init","/lib/tslib/editor.js");LazyLoad.WireUp("$ts.UI","Editor","/lib/tslib/editor.js",!0);LazyLoad.WireUp("$chat","subscribe","/lib/tslib/chat.js",!0);LazyLoad.WireUp("Tangora.CanvasColorControl","Init,Create,CreateLegacyWrapper","/lib/canvascolorcontrol.js");LazyLoad.WireUp("$ts.UI.Controls.DateTimePicker","GetStrings,GetViewData,GetDaysInMonth,ExtractDateValues,ClearDate,InjectDateValues,IncrementDateControlValue,UpdateDateControlValue,DetectKeyStroke,NotSet,InitControl,CreateCalendarControl,UpdateCalendar,JSTimeFromDate,JSTimeToDate,JSTimeToDateString","/lib/dateTimePicker.js");LazyLoad.WireUp("$ts.UI.Controls.SignatureControl","Sign","/lib/signaturecontrol.js");window.showLoginStatus=function(){};window.$time=Date.now||function(){return+new Date},function(){for(var i=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}();// selector.min.js
(function(){function n(n,t,i,r){var o,s,a,w,b,v;this.elements=[];for(var h=[],e=null,k=!1,c=null,d=!1,u=0;u<n.length;u++)o=n[u],typeof o=="string"?h=h.concat(o.split(",")):typeof o=="object"&&($ts.exists(o,"length")?(c=o,e=o,k=!0,n.length==1&&(d=!0)):(c=o,e=[o],$ts.exists(o,"querySelectorAll")&&(e.querySelectorAll=o.querySelectorAll)));var l=!i&&$ts.exists(document,"querySelectorAll")&&k===!1&&(e===null||$ts.exists(e,"querySelectorAll")),y=0,f=this,p=function(){if(!(y>1))for(u=0;u<h.length;u++)if(l){var n=e===null?document:e;if($ts.exists(n,"length")&&n.length==1)try{f.elements=f.elements.concat(n[0].querySelectorAll(h[u]))}catch(t){l=!1;y++;p()}else try{f.elements=f.elements.concat(n.querySelectorAll(h[u]))}catch(t){l=!1;y++;p()}}else f.elements=r?f.elements.concat(f.realize(f.resolveXpath(h[u]),e,c)):f.elements.concat(f.realize(f.resolve(h[u]),e,c))};if(p(),l)for(w=this.elements,this.elements=[],u=0;u<w.length;u++)for(b=w[u],v=0;v<b.length;v++)this.elements.push(b[v]);else{if(s=[],d)for(u=0;u<e.length;u++)(function(n){s.push(n)})(e[u]);else for(u=0;u<this.elements.length;u++)(function(n){n.hashcode||(n.hashcode=u+1);s[n.hashcode]===undefined&&(s[n.hashcode]=n)})(this.elements[u]);this.elements=[];for(a in s)s.hasOwnProperty(a)&&this.elements.push(s[a]),s[a].hashcode=undefined}}n.prototype={extend:function(t,i,r){if(n.prototype[t])throw new Error(t+" is allready defined");else Object.defineProperty(n.prototype,t,{value:i,enumerable:r})},resolve:function(n,t){for(var h="",f=!0,i,u;n.charAt(0)===" ";)n=n.substring(1);for(var e=0,o=!1,r=!1,s=!1;f&&e<n.length;)i=n.charAt(e),f=/[a-z,A-Z,\d,\#,\.,\>,_,\[,\],\(,\),\=,\~,\^,\$,\-,\:,\*,\"]/.test(i),(o||r)&&(f=!0),o&&i==="]"&&(o=!1),r&&i===")"&&(r=!1),s&&i==='"'?s=!1:s||i!=='"'||(s=!0),o||i!=="["||(o=!0),r||i!=="("||(r=!0),f&&(h+=i),!((i==="#"||i===".")&&e>0||i===">")||r||s||(f=!1),e++;return n=n.substring(e),h===""?null:(u={},u.selector=h,u.prev=t,u.next=this.resolve(n,u),u)},resolveXpath:function(n){var t=n.replace("//","").replace(/\//g,">").replace(/@/g,"");return this.resolve(t)},realize:function(n,t,i){var f,o,s,h,at,et,ot,w,vt,st,it,rt,e,u,y,ut,pt,k,nt,ht,ft,wt,i,b,p,ct,v,l,lt,a,r;if(n.elements=[],n.parentNode=i,t===null&&(t=[document.body]),h=n.selector,h==="*"){for(at in t)for(et=t[at].getElementsByTagName("*"),a=0;a<et.length;a++)n.elements.push(et[a]);return n.elements}if(n.isId=h.charAt(0)==="#",n.isClass=h.charAt(0)===".",n.whereId=h.charAt(h.length-1)==="#",n.whereClass=h.charAt(h.length-1)===".",ot=new RegExp(/.*?\[(\w+)(~=|\|=|\^=|\$=|\*=|=)?(\"[\w\s/\.]+\")?\]/),w=ot.exec(h),h.indexOf(!1)&&(w=null),n.query=[],w)do vt=ot.exec(RegExp.rightContext),e={},e.expando=w[1],e.operator=w[2],e.value=w[3]?w[3].replace(/\"/g,""):null,n.query.push(e),w=vt;while(w!=null);if(h===">")return n.next.immidiate=!0,n.parentNode.next=n.next,this.realize(n.next,t,i);n.next!==null&&(n.next.immidiate=!1);var d=/([a-z,A-Z,\d,_]+)/.exec(h)[0],g=null,c=(g=/:([^(]*)/.exec(h))===null?null:g[1],tt=(g=/\((\d+)\)/.exec(h))===null?null:g[1],yt=(g=/\((.*)\)/.exec(h))===null?null:g[1];if(tt!=null&&(tt=parseInt(tt,10)),c==="not"&&n.query.pop(),n.isClass||n.parentNode&&n.parentNode.whereClass)if(st=new RegExp("\\b"+d+"\\b"),n.isClass)for(o=0;o<t.length;o++)for(s=n.immidiate?t[o].childNodes:t[o].getElementsByTagName("*"),f=0;f<s.length;f++)st.test(s[f].className)&&n.elements.push(s[f]);else for(f=0;f<t.length;f++)st.test(t[f].className)&&n.elements.push(t[f]);else if(n.isId||n.parentNode&&n.parentNode.whereId)if(n.parentNode)for(f=0;f<t.length;f++)for(t[f].id===d&&n.elements.push(t[f]),s=t[f].getElementsByTagName("*"),o=0;o<s.length;o++)s[o].id===d&&n.elements.push(s[o]);else r=document.getElementById(d),r!==null&&n.elements.push(r);else for(o=0;o<t.length;o++)for(s=n.immidiate?t[o].childNodes:t[o]?t[o].getElementsByTagName(d):[],f=0;f<s.length;f++)if(s[f].tagName&&s[f].tagName.toLowerCase()===d.toLowerCase())if(!n.query.length>0)n.elements.push(s[f]);else{for(it=!0,rt=0;rt<n.query.length;rt++){e=n.query[rt];u=s[f].getAttribute(e.expando);typeof u=="boolean"&&u===!0?u=e.value:typeof u=="boolean"&&u===!1&&(u="");y=!1;switch(e.operator){case"=":y=u===e.value;break;case"|=":y=u===e.value||e.value.indexOf(u+"-")===0;break;case"~=":ut=e.value.replace(/\s+/g," ").split(" ");for(pt in ut)if(ut.hasOwnProperty(u)&&(y=ut[pt]===u,y))break;break;case"^=":y=u!==null&&u!==undefined&&u!==""&&u.indexOf(e.value)===0;break;case"$=":y=u!==null&&u!==undefined&&u.length>=e.value.length&&u.lastIndexOf(e.value)!=-1&&u.lastIndexOf(e.value)==u.length-e.value.length;break;case"*=":y=u!==null&&u!==undefined&&u!==""&&u.indexOf(e.value)>-1;break;default:y=u!==null&&u!==undefined}it=it&&y}it&&n.elements.push(s[f])}if($ts.exists(c)){if(k=[],(c==="not"||c==="has")&&yt!=null)for(nt=n.selector.split(":")[0],nt&&(nt+=" "),ht=n.prev,ht&&ht.whereClass&&(nt="."+nt),v=0;v<n.elements.length;v++)k=k.concat($elms(nt+yt,n.elements[v]));for(a=0;a<n.elements.length;a++){r=n.elements[a];switch(c){case"enabled":$ts.exists(r,"disabled")&&r.disabled===!0&&(r=null);break;case"disabled":$ts.exists(r,"disabled")&&r.disabled===!1&&(r=null);break;case"checked":($ts.exists(r,"checked")&&r.checked===!1||!$ts.exists(r,"checked"))&&(r=null);break;case"focus":document.activeElement!==r&&(r=null);break;case"empty":r.childNodes.length>0&&(r=null);break;case"only-child":case"only-of-type":i=r.parentNode;b=null;c==="only-of-type"&&(b=r.tagName);p=$ts.getChildElements(i,b);p.length!==1&&(r=null);break;case"first-child":case"last-child":case"first-of-type":case"last-of-type":for(i=r.parentNode,b=null,(c==="first-of-type"||c==="last-of-type")&&(b=r.tagName),p=$ts.getChildElements(i,b),(c==="last-child"||c==="last-of-type")&&p.reverse(),ft=0;ft<p.length;ft++)if(wt=p[ft],wt===r)break;else{r=null;break}break;case"nth-child":case"nth-last-child":case"nth-of-type":case"nth-last-of-type":i=r.parentNode;b=null;(c==="nth-of-type"||c==="nth-last-of-type")&&(b=r.tagName);p=$ts.getChildElements(i,b);(c==="nth-last-child"||c==="nth-last-of-type")&&p.reverse();tt<p.length?p[tt]!==r&&(r=null):r=null;break;case"not":for(v=0;v<k.length;v++){for(l=k[v];l!=null&&l!=r;){if(l==r)break;l=l.parentNode}if(l==r){console.log("FOUND");r=null;break}}break;case"has":for(ct=!1,v=0;v<k.length;v++){for(l=k[v];l!=null&&l!=r;){if(l==r)break;l=l.parentNode}if(l==r){ct=!0;console.log("FOUND");break}}ct||(r=null)}n.elements[a]=r}for(lt=[],a=0;a<n.elements.length;a++)r=n.elements[a],$ts.exists(r)&&lt.push(r);n.elements=lt}return n.next!==null?this.realize(n.next,n.elements,n):n.elements},filter:function(n){for(var i=[],t=0,r=this.elements.length;t<r;++t)n.call(this,this.elements[t])&&i.push(this.elements[t]);return $chain(i)},each:function(n){for(var t=0,i=this.elements.length;t<i;++t)n.call(this,this.elements[t]);return this},addClass:function(n){return this.each(function(t){$ts.addClass(t,n)}),this},removeClass:function(n){return this.each(function(t){$ts.removeClass(t,n)}),this},setStyle:function(n,t){return this.each(function(i){i.style[n]=t}),this},show:function(){var n=this;return this.each(function(){n.setStyle("display","block")}),this},addEvent:function(n,t){return this.each(function(i){$ts.addEvent(i,n,t)}),this},removeEvent:function(n,t){return this.each(function(i){$ts.removeEvent(i,n,t)}),this},disabled:function(n){return this.each(function(t){t.disabled=n}),this},onclick:function(n){return this.each(function(t){t.onclick=n}),this},savehandler:function(n){var t=function(t){(t.handlers===undefined||t.handlers===null)&&(t.handlers=[]);t.handlers[n]=t[n]};return this.each(function(n){t(n)}),this},restorehandler:function(n){var t=function(t){$ts.exists(t.handlers)&&t.handlers[n]!==undefined&&(t[n]=t.handlers[n])};return this.each(function(n){t(n)}),this},collapse:function(n){return this.each(function(t){$ts.UI.Animation.Collapse(t,n)}),this},expand:function(n){return this.each(function(t){$ts.UI.Animation.Expand(t,n)}),this},conceal:function(n){return this.each(function(t){$ts.UI.Animation.Conceal(t,n)}),this},reveal:function(n){return this.each(function(t){$ts.UI.Animation.Reveal(t,n)}),this}};window.$xpath=function(){return new n(arguments,1,!0,!0).elements};window.$telms=function(){return new n(arguments,1,!0).elements};window.$elms=function(){return new n(arguments,1).elements};window.$elm=function(){var t,i,u,r;if(arguments[0]==null)return null;if(typeof arguments[0]!="string"&&$ts.exists(arguments[0].tagName))return arguments[0];if(typeof arguments[0]=="string"&&/^\s*$/.test(arguments[0]))return null;for(t=document.getElementById(arguments[0]),i=1;i<arguments.length;i++)u=arguments[i],typeof u=="object"&&(t=null);return $ts.exists(t)?t:(r=new n(arguments,2),r.elements.length>0?r.elements[0]:null)};window.$telm=function(){var t,i,u,r;if(arguments[0]==null)return null;if(typeof arguments[0]!="string"&&$ts.exists(arguments[0].tagName))return arguments[0];for(t=document.getElementById(arguments[0]),i=1;i<arguments.length;i++)u=arguments[i],typeof u=="object"&&(t=null);return $ts.exists(t)?t:(r=new n(arguments,2,!0),r.elements.length>0?r.elements[0]:null)};window.$chain=function(){return new n(arguments,3)};window.$tchain=function(){return new n(arguments,3,!0)}})();// ilscript.min.js
function tsinit(){location.href.indexOf("/admin")==-1&&highlightSearchwords()}function MiniCalendar(n,t,i,r,u,f,e,o,s){s||(s=0);i=eval("document."+n+"."+t).value;window.open("/lib/minicalendar.aspx?formname="+n+"&fieldname="+t+"&value="+i+"&settingsid="+r+"&ownerid="+u+"&windowcolor="+o+"&firsttime=1&containstime="+s,"","width="+f+",height="+e+",dependent=yes")}function MiniCalendar2(n,t,i,r,u,f,e,o){(n==null||n=="")&&(n=document.forms[0].id);i=eval("document."+n)?eval("document."+n+"."+t).value:document.getElementById(t).value;var h=document.getElementById("calendardiv_"+t),s=document.getElementById("calendar_"+t);o||(o="-1");s.style.visibility=="visible"?(s.style.visibility="hidden",s.style.zIndex=-1):(u||typeof u=="undefined"?(s.src=r?"module.aspx?modid=1&refpath=calendar&thedate="+i+"&formname="+n+"&fieldname="+t+"&containstime="+r:"module.aspx?modid=1&refpath=calendar&thedate="+i+"&formname="+n+"&fieldname="+t,Tangora.Browser.IE||(s.style.width="150px")):s.src="/lib/minicalendar.aspx?inline=1&thedate="+i+"&formname="+n+"&fieldname="+t+"&settingsid="+f+"&pageid="+e+"&dateformat="+o,s.style.visibility="visible",s.style.zIndex=1,TSSetCapture(h))}function OpenWYSIWYGLink(n,t,i,r,u,f,e,o,s,h,c,l){if(document.getElementById("maineditdiv")||document.getElementById("mainadminwindowtable"))return window.event?!1:void 0;var a=new String;t&&(r||r==0)?(a="",t!=0&&(a=a+"width="+t),i!=0&&(a!=""&&(a=a+","),a=a+"height="+i),a!=""&&(a=a+","),a=a+"left="+r,a=a+",top="+u,f==1&&(a=a+",resizable=yes"),e==1&&(a=a+",scrollbars=yes"),o==1&&(a=a+",menubar=yes"),s==1&&(a=a+",toolbar=yes"),h==1&&(a=a+",location=yes"),c==1&&(a=a+",directories=yes"),l==1&&(a=a+",status=yes"),window.open(n,"",a)):t?t==0||i==0?window.open(n):window.open(n,"","width="+t+",height="+i+",menubar=yes,scrollbars=yes,resizable=yes,status=yes"):window.open(n)}function StrReplace(n,t,i){for(srs=n;srs.indexOf(t)!=-1;)srs=srs.replace(t,i);return srs}function URLEncode(n){return n=unescape(n),escape(n)}function URLEncode2(n){return n=StrReplace(StrReplace(StrReplace(StrReplace(StrReplace(StrReplace(n,unescape("%C6"),"%C3%86"),unescape("%D8"),"%C3%98"),unescape("%C5"),"%C3%85"),unescape("%E6"),"%C3%A6"),unescape("%F8"),"%C3%B8"),unescape("%E5"),"%C3%A5"),n=StrReplace(n,"%","OPERCENTO"),n=URLEncode(n),StrReplace(n,"OPERCENTO","%")}function openMiniCal(n,t,i,r,u,f,e,o,s){i=eval("document."+n)!=null?eval("document."+n+"."+t).value:document.getElementById(t).value;window.open("/lib/minicalendar.aspx?pageid="+o+"&formname="+n+"&fieldname="+t+"&value="+i+"&settingsid="+r+"&ownerid="+u+"&dateformat="+URLEncode(s)+"&firsttime=1","","width="+f+",height="+e+",dependent=yes")}function MiniBasketLoaded(){var n=GetIframeDocument("MiniBasketFrame"),t=document.getElementById("MiniBasketDiv");n&&n.body&&n.body.innerHTML!=""&&t&&(t.innerHTML=n.body.innerHTML)}function RandomNumber(n,t){return Math.floor((t-n+1)*Math.random()+n)}function RandomName(n){var t="",r;for(i=0;i<n;i++)r=RandomNumber(0,25),t=t+"abcdefghijklmnopqrstuvwxyz".substring(r,r+1);return t}function highlightSearchwords(){function t(n,i){if((n.nodeType!=1||!/style|script/i.test(n.tagName))&&!(i.length<1)){if(n.hasChildNodes)for(var r=0;r<n.childNodes.length;r++)t(n.childNodes[r],i);n.nodeType==3&&(tempNodeValue=n.nodeValue.toLowerCase(),tempWordValue=i.toLowerCase(),tempNodeValue.indexOf(tempWordValue)!=-1&&(pn=n.parentNode,pn.className!="searchword"&&(nv=n.nodeValue,ni=tempNodeValue.indexOf(tempWordValue),before=document.createTextNode(nv.substr(0,ni)),docWordValue=nv.substr(ni,i.length),after=document.createTextNode(nv.substr(ni+i.length)),hiwordtext=document.createTextNode(docWordValue),hiword=document.createElement("span"),hiword.className="searchword",hiword.appendChild(hiwordtext),pn.insertBefore(before,n),pn.insertBefore(hiword,n),pn.insertBefore(after,n),pn.removeChild(n))))}}function i(n,i){function h(n,t){var r=new RegExp("[?&]{1}"+n+"=([^&]*)","gi"),i=r.exec(t);return i?i[1]:null}function c(n){var t=/[?&]{1}doshow(\d+)?=/i.exec(n);return t?t[1]:null}var r,f,u,e;if(n.indexOf("?")!=-1&&(r=document.getElementById("maincell"),r||(r=document.getElementById("mergefield_main")),r||(r=document.getElementById("scrollable")),r||(r=document.getElementsByTagName("body")[0]),f=h("q",n),f)){if(u=!i,!u){var o=c(n),s=$elm('meta[name="pageid"]'),l=s?s.getAttribute("content"):null;u=o&&o==l}if(u)for(e=decodeURI(f.replace(/\+/g," ")).split(/\s+/),w=0;w<e.length;w++)t(r,e[w])}}var n;document.createElement&&(n=document.location.href,i(n),n=document.referrer,i(n,!0))}function getHTTPObject(){var n;/*@cc_on@if(@_jscript_version>=5)try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(i){n=!1}}@else n=!1;@end@*/if(!n&&typeof XMLHttpRequest!="undefined")try{n=new XMLHttpRequest}catch(t){n=!1}return n}function nameSpace(){this.GetType=function(){return"nameSpace"}}function resetObjects(){}var TCookies=function(){this.SetCookieValue=function(n,t,i){var u=arguments,f=arguments.length,s=f>3?u[3]:null,h=f>4?u[4]:null,c=f>5?u[5]:null,l=f>6?u[6]:!1,r=this.GetCookie(n),e,o;r||(r="");e=r.indexOf("&"+t+"=");e>=0&&(o=r.indexOf("&",e+1),o==-1&&(o=r.length),r=r.substr(0,e)+r.substr(o));typeof i!="undefined"&&(r+="&"+t+"="+escape(i));document.cookie=n+"="+r+(s==null?"":"; expires="+s.toUTCString())+(h==null?"":"; path="+h)+(c==null?"":"; domain="+c)+(l==!0?"; secure":"")};this.SetCookie=function(n,t){var i=arguments,r=arguments.length,u=r>2?i[2]:null,f=r>3?i[3]:null,e=r>4?i[4]:null,o=r>5?i[5]:!1;document.cookie=n+"="+escape(t)+(u==null?"":"; expires="+u.toUTCString())+(f==null?"":"; path="+f)+(e==null?"":"; domain="+e)+(o==!0?"; secure":"")};this.GetCookie=function(n){for(var r=n+"=",u=r.length,f=document.cookie.length,t=0,i;t<f;){if(i=t+u,document.cookie.substring(t,i)==r)return this._getCookieVal(i);if(t=document.cookie.indexOf(" ",t)+1,t==0)break}return null};this.GetCookieValue=function(n,t){var r=this.GetCookie(n),f,i,u;return r&&(f="&"+t+"=",i=r.indexOf(f),i>=0)?(u=r.indexOf("&",i+1),u==-1&&(u=r.length),i+=f.length,r.substr(i,u-i)):null};this.DeleteCookie=function(n){var t=new Date,i;t.setTime(t.getTime()-1);i=this.GetCookie(n);document.cookie=n+"="+i+"; expires="+t.toUTCString()};this._getCookieVal=function(n){var t=document.cookie.indexOf(";",n);return t==-1&&(t=document.cookie.length),unescape(document.cookie.substring(n,t))}},Tangora,tmp,__linkHandlers_attached,__attachLinkHandler,oldBuildCode;typeof Tangora=="undefined"&&(Tangora={});Tangora.Cookies=new TCookies;Tangora.Events=new nameSpace;Tangora.ServerVariables=new nameSpace;tmp=Tangora.Cookies.GetCookieValue("ServerVars","AcceptLanguage");Tangora.ServerVariables.AcceptLanguage=tmp!=null?tmp.replace(/\|/g,";"):"";typeof AddEventListener=="undefined"&&(AddEventListener=typeof addEventListener!="undefined"?function(n,t,i){if(n=="load"&&window.loaded){t();return}i?i.addEventListener(n,t,!1):window.addEventListener(n,t,!1)}:function(n,t,i){if(n=="load"&&window.loaded){t();return}i?i.attachEvent("on"+n,t):window.attachEvent("on"+n,t)});$ts.hover=function(n){var t=n.sender,e=n.action||"",i=n.value,f;switch(e.toLowerCase()){default:var o=t.getAttribute("src"),r=t.getAttribute("srcset"),u=t.onmouseout;r&&(t.removeAttribute("srcset"),/imagegenerator/.test(i)&&!/@\d+x\./i.test(i)&&(f=i.replace(/\.(png|jpg|jpeg|gif)/i,"@2x.$1"),t.setAttribute("srcset",i+" 1x, "+f+" 2x")));t.src=i;t.onmouseout=function(){t.src=o;r&&t.setAttribute("srcset",r);u&&u.call(t,arguments);t.onmouseout=u}}};__linkHandlers_attached=!1;__attachLinkHandler=function(){if(!__linkHandlers_attached){__linkHandlers_attached=!0;var t=function(n){var t=function(t){var i,r;if(t=t||window.event,t.target.getAttribute("data-collapsable-navigation-action")!="true")return t.target.parentNode&&t.target.parentNode.getAttribute("data-collapsable-navigation-action")=="true"?void 0:(i=$ts.Server.call("GetLinkScript",{linkpageurl:n.getAttribute("data-href")},!0),i?i.newwindow?(r="",i.width!=0&&(r+="width="+i.width+","),i.height!=0&&(r+="height="+i.height+","),i.screenx!=0&&(r+="left="+i.screenx+","),i.screeny!=0&&(r+="top="+i.screeny+","),i.resizable!=0&&(r+="resizable=yes,"),i.scrollbars!=0&&(r+="scrollbars=yes,"),i.menubar!=0&&(r+="menubar=yes,"),i.toolbar!=0&&(r+="toolbar=yes,"),i.location!=0&&(r+="location=yes,"),i.directories!=0&&(r+="directories=yes,"),i.status!=0&&(r+="status=yes,"),window.open(i.url,"",r)):i.stayincontext!=1?$spa.register(i.url):i.stayincontext==1&&(location.href=n.getAttribute("data-href")):location.href=n.getAttribute("data-href"),$ts.cancelBubble(t),!1)};n.setAttribute("data-href",n.href);$ts.addEvent(n,"click",t)},n=!0;document&&document.documentMode&&document.documentMode<8&&(n=!1);n&&$chain('a[data-pagetype="link"]').each(t)}};$ts.addEvent(window,"load",__attachLinkHandler);$ts.addEvent(window,"DOMContentLoaded",__attachLinkHandler);Tangora&&Tangora.LoadKey&&(LazyLoad.WireUp("$ts.User","Ping","/userping.ashx"),oldBuildCode=buildCode,buildCode="?"+Tangora.LoadKey,$ts.User.Ping(),buildCode=oldBuildCode);// spa.min.js
(function(){function n(){this.fecthing=!1;this.enabled=!0;this.cacheEnabled=!1;this.justInitialized=!0;this.cache={};this.debug=!1;this.initialized=!1;this.refs={};this.funcs=[];this.history={index:0,items:[]};this.stack=[]}n.prototype={helpers:function(){var n=function(n,t){var i,r;n&&t&&(i=$ts.createElement("div"),i.innerHTML=t,r=$elm("span",i),n.parentNode.replaceChild(r,n))},t=function(n,t){var i,r;n&&t&&(i=$ts.createElement("div"),i.innerHTML=t,r=$elm('ul[class="breadcrumb"]',i),r&&n.parentNode.replaceChild(r,n))};return this.SetBreadCrumb=function(i){n($elm('span[class="breadcrumb"]'),i);var r=$elm("#mergefield_breadcrumb");r&&t($elm('ul[class="breadcrumb"]',r),i)},this.SetCss=function(n,t,i){var r,u;if(i||(i=document.getElementsByTagName("head")[0]),$elm("style["+n+'="true"]')&&i.removeChild($elm("style["+n+'="true"]')),t){r=document.createElement("style");r.type="text/css";r.setAttribute(n,"true");u=document.createTextNode(t);try{r.styleSheet?r.styleSheet.cssText=t:r.appendChild(u)}catch(f){r.appendChild(u)}i.appendChild(r)}},this.SetScriptReferences=function(n,t){var i,r;for(t||(t=document.getElementsByTagName("head")[0]),i=eval(n),r=0;r<i.length;r++)(function(n){var u=$elm('script[src="/lib/'+i[n].toLowerCase()+'"]',t),r;u||(r=document.createElement("script"),r.type="text/javascript",r.src="/lib/"+i[n],t.appendChild(r))})(r)},this.SetScript=function(n,t,i){if(i||(i=document.getElementsByTagName("head")[0]),$elm("script["+n+'="true"]')&&i.removeChild($elm("script["+n+'="true"]')),t){var r=document.createElement("script");r.type="text/javascript";r.text=t;r.setAttribute(n,"true");i.appendChild(r)}},this.inlineCodeAssist=function(n,t){var y=null,c="",ut=(new Date).getTime(),p,w,b,r,tt,f,u,e,o,s,i,nt;if(n){for(p=0,w=window.onload,window.onload=null,b="",r="",done=!1,tt=n;!done;){if(allScripts=new RegExp("(<script(\\s?(type=[\"']text/javascript[\"'])?\\s?(language=[\"']javascript[\"'])?|\\s?(language=[\"']javascript[\"'])?\\s?(type=[\"']text/javascript[\"'])?)>((.|\\n|\\r)*?)<\/script>)","gim"),done=!allScripts.test(n),done)break;if(i=RegExp.$7,f=i.indexOf("Xdocument.write"),f>-1){var h=!1,l="",a=[];for(u=0;u<i.length;u++){if(i.charAt(f+u)=="("){a.push(u);h&&(l+=i.charAt(f+u));h=!0;continue}if(i.charAt(f+u)==")"&&(a.pop(),a.length==0&&h))break;h&&(l+=i.charAt(f+u))}try{e=eval(l);n=n.replace(RegExp.$1,e)}catch(ft){}}else{var k=RegExp.$1,d=RegExp.leftContext,g=RegExp.rightContext,it=i.replace(/<!--/g,"").replace(/-->/g,""),e="",rt=document.write,v=!1;document.write=function(n){e+=n;r+=n;t.innerHTML=d+r+g;v=!0};try{$ts.globalEval(it)}catch(ft){}if(document.write=rt,v)r="",n=t.innerHTML;else{for(o="",s=new RegExp("<style\\s?(type=[\"']text/css[\"'])?>((.|\\n|\\r)*?)<\/style>","gim");s.test(r);)i=RegExp.$2,o+=i+"\r\n";r=r.replace(s,"");c+=o+"\r\n";i&&(t.innerHTML=d+r+g,v=!0,r="",n=t.innerHTML)}for(o="",s=new RegExp("<style\\s?(type=[\"']text/css[\"'])?>((.|\\n|\\r)*?)<\/style>","gim");s.test(n);)i=RegExp.$2,o+=i+"\r\n";n=n.replace(s,"");c+=o+"\r\n";nt=n.length;n=n.replace(k,e);nt==n.length&&e.length>0&&(n=n.replace(k.replace(/\r/gm,""),e));t.innerHTML=n}p++}n=n.replace(allScripts,"");y=window.onload;window.onload=w}return[n,b,c,y]},this.SetHeadBlockData=function(n,t,i){var s,h,f,e,c,r,l,w,y,u,a,v,p,o;if(i||(i=document.getElementsByTagName("head")[0]),$elm("script["+n+'="true"]')&&i.removeChild($elm("script["+n+'="true"]')),$elm("style["+n+'="true"]')&&i.removeChild($elm("style["+n+'="true"]')),t){for(s="",h=new RegExp("(<script(\\s?(type=[\"']text/javascript[\"'])?\\s?(language=[\"']javascript[\"'])?|\\s?(language=[\"']javascript[\"'])?\\s?(type=[\"']text/javascript[\"'])?)>((.|\\n|\\r)*?)<\/script>)","gim");h.test(t);)u=RegExp.$7,s+=u+";";for(t=t.replace(h,""),t=t.replace(/<!script/gi,"<script"),t=t.replace(/-r-n-/g,"\r\n"),f=document.createElement("script"),f.type="text/javascript",f.text=s,f.setAttribute(n,"true"),i.appendChild(f),e="",c=new RegExp("<style\\s?(type=[\"']text/css[\"'])?>((.|\\n|\\r)*?)<\/style>","gim");c.test(t);)u=RegExp.$2,e+=u+"\r\n";t=t.replace(c,"");t=t.replace(/<!style/gi,"<style");t=t.replace(/-r-n-/g,"\r\n");r=document.createElement("style");r.type="text/css";r.setAttribute(n,"true");l=document.createTextNode(e);try{r.styleSheet?r.styleSheet.cssText=e:r.appendChild(l)}catch(b){r.appendChild(l)}for(i.appendChild(r),w="",y=new RegExp("(<link .*?>)","gim");y.test(t);)u=RegExp.$1,a=new RegExp('href="(.*?)"',"i"),a.test(u)&&(v=a.exec(u),p=$elm('link[href="'+v[1]+'"]'),p||(o=document.createElement("link"),o.setAttribute("rel","stylesheet"),o.setAttribute("href",v[1]),i.appendChild(o)))}},this.Navigation=function(){return this.GetPath=function(n){var r=[],t=$elm('div[id^="mergefield_navigation_level"][class*="sfnavlevel1"]'),i;return t&&(i=function(n,r){var u=$elm("#navigationlistitem_"+n,t);if(u){for(r.push({pageid:n,href:u.firstChild.getAttribute("data-href"),title:u.firstChild.firstChild.innerHTML});u.parentNode!=t;)if(u=u.parentNode,u.tagName.toLowerCase()=="li")break;u!=null&&u.parentNode!=t&&i(/navigationlistitem_(\d+)/.exec(u.id)[1],r)}},i(n,r)),r},this.Update=function(n){var i=$elm('div[id^="mergefield_navigation_level"][class*="sfnavlevel1"]'),u,r,t;if(i){while($elm("a.activelink",i))if(u=$elm("a.activelink",i),u)for(t=u.parentNode,$ts.removeClass(u,"activelink");t!=i;)t.tagName.toLowerCase()=="li"&&($ts.removeClass(t,"activeitem"),$ts.removeClass(t.firstChild,"activelink")),t=t.parentNode;if(r=$elm("li#navigationlistitem_"+n,i),r)for(t=r.parentNode,$ts.addClass(r,"activeitem"),$ts.addClass(r.firstChild,"activelink");t!=i;)t.tagName.toLowerCase()=="li"&&($ts.addClass(t,"activeitem"),$ts.addClass(t.firstChild,"activelink")),t=t.parentNode}},this}(),this}(),makeUrlAbsolute:function(n){var t=n;return n.indexOf("/")==0&&(t=location.protocol+"//"+location.hostname+n),t},displayDebugInfo:function(n){var u,r,f,i,t;if(n){u=$elm("#debugpanel")||$elm("body").appendChild($ts.createElement("div",{id:"debugpanel"},{background:"white",position:"absolute",width:"300px",top:"0",left:"0"}));u.innerHTML="";r=$ts.createElement("table");t=$ts.createElement("tr");r.appendChild(t);t.appendChild($ts.createElement("th",{innerHTML:"name"}));t.appendChild($ts.createElement("th",{innerHTML:"value"}));f=0;for(i in n)i.indexOf("_")==0&&(t=$ts.createElement("tr"),r.appendChild(t),t.appendChild($ts.createElement("td",{innerHTML:i.substring(1)})),t.appendChild($ts.createElement("th",{innerHTML:n[i]})),f+=new Number(n[i]));u.appendChild(r)}},register:function(n,t,i){var u,r,f;if($spa.supported()){if($spa.fecthing){window.setTimeout(function(){$spa.register(n,t,i)},500);return}$spa.initialized=!0;$spa.fecthing=!1;u=$spa.makeUrlAbsolute(location.pathname);r={url:$spa.makeUrlAbsolute(n),direction:"",postdata:i,originalurl:n,referer:u};$spa.history.index++;$spa.history.items.push(r);f=function(u){i?(history.pushState(r,n,n),$ts.consoleWrite("no push: "+n)):(history.pushState(r,n,n),$ts.consoleWrite("push: "+n));t&&t(u)};this.loadContent(r,u,f,i)}else{if(i||location.href==n)return n;location.href=n}},registerAnchor:function(n,t,i,r){r&&history.replaceState({type:"anchor",state:r},"",i);history.pushState({type:"anchor",state:t},"",n)},loadContent:function(n,t,i,r){var u,s;$spa.justInitialized=!1;var h=addEventListener,f=f,e=[],o=[];for(window.loaded=!1;$spa.funcs.length>0;)u=$spa.funcs.pop(),removeEventListener(u.a,u.f,u.c,u.d);addEventListener=function(n,t,i,r){n.toLowerCase()=="load"||n.toLowerCase()=="domcontentloaded"?e.push({a:n,b:t,c:i,d:r}):h(n,t,i,r)};attachEvent=function(n,t,i,r){n.toLowerCase()=="load"||n.toLowerCase()=="domcontentloaded"?o.push({a:n,b:t,c:i,d:r}):f(n,t,i,r)};s=function(t,u){var c=u.split("¤#!#¤"),b=c.length>1,u,l,v,s,y,a,p,w;if(b){if(u=(new Date).getTime(),l=eval("("+c[0]+")"),c.splice(0,1),l.reload||l.access){location.href=n.url;return}l.redirect&&history.pushState(n,l.redirect,l.redirect);$spa.debug&&$spa.displayDebugInfo(l);v=document.getElementsByTagName("head")[0];s={};s.headCss=c[0];s.headScript=c[1];s.headBlock=c[2];y=$ts.createElement("div");y.innerHTML=c[3];a=$spa.helpers.inlineCodeAssist(c[3],y,v);s.htmlContent=a[0];a[1]&&(s.headBlock+="\r\n"+a[1]);a[2]&&(s.headCss+="\r\n"+a[2]);s.breadCrumb=c[4];s.title=c[5];s.scripts=c[6];$ts.Observer.Broadcast("SPA","BeforeLoad",{pageid:l.pageid});$spa.helpers.SetCss("ispagecontext",s.headCss,v);p="fade";n&&n.direction=="back"&&(p="fade");w={method:p,duration:250,callback:function(){var c,t;for(s.title&&($elm("title").innerHTML=s.title),$spa.helpers.SetBreadCrumb(s.breadCrumb),$spa.helpers.SetScriptReferences(s.scripts,v),$spa.helpers.SetScript("ispagecontext",s.headScript,v),$spa.helpers.SetHeadBlockData("isblockcontext",s.headBlock,v),$spa.helpers.Navigation.Update(l.pageid),window.loaded=!0,addEventListener=h;e.length>0;)t=e.pop(),c=function(n){return t.b(n)},t.f=c,$spa.funcs.push(t),t.b();for(attachEvent=f;o.length>0;)t=o.pop(),t.b();a[3]&&a[3]();$spa.cacheEnabled&&($spa.cache[n.url]=u,$spa.cache[n.url+"_post"]=r);l.minibasketstate=="show"?$chain('div[id^="Tangora_MiniBasket_"]').each(function(n){var t=n.id.replace(/Tangora_MiniBasket_/g,"");n&&n.innerHTML==""&&Tangora.ShoppingListUtils.updateMiniBasket(t)}):$chain('div[id^="Tangora_MiniBasket_"]').each(function(n){n.innerHTML=""});$spa.bind();Tangora.Layout.Resize();Tangora.Layout.Retinize();Tangora.Layout.RunResponsiveAssist();n.scrolltop?window.scrollTo(0,n.scrolltop):window.scrollTo(0,0);$ts.Observer.Broadcast("SPA","AfterLoad",{pageid:l.pageid});i&&i(u)}};Tangora.Layout.ContentSwapTransitionManager.SwapContent($elm("#mergefield_main"),s.htmlContent,w)}else location.reload(!0);$spa.fecthing=!1};$spa.cacheEnabled&&$spa.cache[n.url]!=undefined?s(null,$spa.cache[n.url],$spa.cache[n.url+"_post"]):(r||(r=""),$ts.ajax({url:"/spa.ashx",data:{url:n.url,sourceurl:t,debug:$spa.debug,postdata:r},type:"POST",complete:s}))},bind:function(){$ts.Observer.Broadcast("SPA","BeforeBind",null);$chain("a[href]").each(function(n){var t,i,r;n.getAttribute("href").indexOf("/")!=0||n.getAttribute("data-href")&&n.spaTouched!=undefined||(n.setAttribute("data-href",n.getAttribute("href")),t=n.getAttribute("onclick"),n.setAttribute("onclick","return false;"),n.getAttribute("data-ref")?($ts.addEvent(n,"click",$spa.refs[n.getAttribute("data-ref")]),n.spaTouched=1):(i=$ts.createUID(),r=function(i){var r=!0,u;return t&&(u="function __org() {"+t+"}",eval(u),r=__org.apply(n,[i])),r?$spa.register(this.getAttribute("data-href")):$ts.cancelBubble(i),r},$ts.addEvent(n,"click",r),$spa.refs[i]=r,n.setAttribute("data-ref",i),n.spaTouched=1))});$chain("form[action]").each(function(n){var t,i,r;n.getAttribute("action").indexOf("/")!=0||n.getAttribute("data-action")&&n.spaTouched!=undefined||(n.setAttribute("data-action",n.getAttribute("action")),t=n.getAttribute("onsubmit"),n.setAttribute("onsubmit","return false;"),n.getAttribute("data-ref")?($ts.addEvent(n,"submit",$spa.refs[n.getAttribute("data-ref")]),n.spaTouched=1):(i=$ts.createUID(),r=function(i){var r=!0,u;return t&&(u="function __org() {"+t+"}",eval(u),r=__org.apply(n,[i])),r?$spa.register(this.getAttribute("data-action"),null,$ts.spaEncode($ts.getFormValues(this))):$ts.cancelBubble(i),r},$ts.addEvent(n,"submit",r),$spa.refs[i]=r,n.setAttribute("data-ref",i),n.spaTouched=1))});$ts.Observer.Broadcast("SPA","AfterBind",null)},getBrowseDirection:function(n){return $spa.history.index-2>=0&&$spa.history.index-2<$spa.history.items.length&&$spa.history.items[$spa.history.index-2].url==n.url?"back":$spa.history.index>=0&&$spa.history.index<$spa.history.items.length&&$spa.history.items[$spa.history.index].url==n.url?"forward":$spa.history.index==1?"back":""},supported:function(){var n=$elm('meta[name="spa"]');return n?history&&history.pushState&&n.getAttribute("content")=="true":!1}};window.$spa=new n;var t=function(n){var i,r,t;if(n.state&&typeof n.state.type!="undefined"&&n.state.type=="anchor")return $ts.Observer.Broadcast("SPA","AnchorNavigation",n.state.state),$ts.cancelBubble(n),!1;if($spa.enabled&&$spa.supported(location.href)&&!$spa.justInitialized){if(n.state&&n.state!=""){i=$spa.getBrowseDirection(n.state);$ts.consoleWrite("direction: "+i);t={};for(r in n.state)t[r]=n.state[r];t.direction=i;i=="forward"||i==""?$spa.history.index++:$spa.history.index--;$spa.loadContent(t,$spa.makeUrlAbsolute(location.pathname))}else t={url:$spa.makeUrlAbsolute(location.pathname),direction:"back",referer:$spa.makeUrlAbsolute(location.pathname)},$spa.loadContent(t,$spa.makeUrlAbsolute(location.pathname));return $spa.justInitialized=!1,!1}return $spa.justInitialized&&Tangora.Browser.Safari||$spa.register(location.href),$spa.justInitialized=!1,!0};$spa.enabled&&($ts.addEvent(window,"DOMContentLoaded",function(){var n=$elm('meta[name="spa-debug"]');$spa.debug=n?n.getAttribute("content")=="true":!1}),history&&history.pushState&&$ts.addEvent(window,"popstate",t));$ts.addEvent(window,"DOMContentLoaded",function(){var n,t;$spa.enabled&&$spa.supported(location.href)&&($spa.bind(),n=function(n,t,i){var r;$spa.bind();history.state?(r={url:$spa.makeUrlAbsolute(i.url),direction:history.state.direction,referer:history.state.referer,scrolltop:i.scrollTop},history.replaceState(r,"",i.url)):(r={url:$spa.makeUrlAbsolute(i.url),direction:"back",referer:$spa.makeUrlAbsolute(i.url),scrolltop:i.scrollTop},history.replaceState(r,"",i.url))},$ts.Observer.Register("*","AfterAutoFetch",n),$ts.addEvent(window,"scroll",function(){var t,i;window.pageYOffset?t=window.pageYOffset:(t=document.body.scrollTop,t==0&&document.documentElement&&(t=document.documentElement.scrollTop));history.state&&(!Tangora.Browser.Safari||Tangora.Browser.Chrome)&&(i={},i.url=history.state.url,i.referer=history.state.referer,i.direction=history.state.direction,i.scrollTop=t,$ts.consoleWrite("st: "+t),n("spa","scroll",i))}));/scroll\(([^\)]*)\)/.test(location.hash)&&(t=RegExp.$1,Tangora.Layout&&Tangora.Layout.ScrollTo&&Tangora.Layout.ScrollTo(t))})})();// tc.min.js
Tangora.ClientControlsBase=new function(){var n=this;n.Id="Tangora.ClientControlsBase";n.AddClearButton=function(n){function i(){t.style.display=$ts.isNullOrEmpty($ts.trim(n.value))?"none":"block"}var r=n.parentNode.insertBefore($ts.createElement("div",null,{display:"inline-block"}),n),u=r.appendChild($ts.createElement("div",null,{position:"relative"})),t=u.appendChild($ts.createElement("div",null,{position:"absolute",top:"4px",right:"2px",width:"12px",height:"12px",cursor:"pointer"})),f=t.appendChild($ts.createElement("img",{src:"/setup/clear.png",alt:""},{width:"12px",height:"12px"}));r.appendChild(n);n.clear=function(){n.value="";i()};n.setClearVisibility=i;$ts.addEvent(t,"click",function(){n.value="";i();n.focus()});$ts.addEvent(n,"keyup",function(){i()});$ts.addEvent(n,"focus",function(){this.value==""&&this.select()})};n.ReplaceControl=function(n,t){n.parentNode.insertBefore(t,n);n.parentNode.removeChild(n);n=null};n.AddControlClassProperties=function(n){try{Object.defineProperty(n,"id",{get:function(){return internalId},set:function(n){internalId=n},enumerable:!0});Object.defineProperty(n,"settings",{get:function(){return internalSettings},set:function(n){internalSettings=n},enumerable:!0});Object.defineProperty(n,"domElement",{get:function(){return internalDomElement},set:function(n){internalDomElement=n},enumerable:!0})}catch(t){}};n.showTableCreatorFromButton=function(n,t){var i=[],e=function(){while(i.length>0)i.pop()()},u=function(n,t,r){var u=$ts.createElement(n,t,r);return i.push(function(){u.parentNode&&u.parentNode.removeChild(u);u=null}),u},o=parseInt($ts.getComputedStyle(n,"margin-right"),10),s=parseInt($ts.getComputedStyle(n,"margin-bottom"),10),f=function(t){t=t==="add"?$ts.addCssRule:$ts.removeCssRule;t(".tableInjectionAnchor","vertical-align: top; display: inline-block; width: 0px; height:0px; position: relative; margin: 0px; margin-left: -"+(n.offsetWidth+o)+"px;");t(".tableInjectionWrapper","position: absolute; width: 175px; top: "+(n.offsetHeight+s)+"px; left: 0px;");t('*[contenteditable="true"] table td',"height: 10px; border: dotted 1px #666;")},r=n.parentNode.insertBefore(u("div",{className:"tableInjectionAnchor"}),n.nextSibling),h=r.appendChild(u("div",{className:"tableInjectionWrapper"})),c=h.appendChild(Tangora.ClientControlsBase.showTableCreator(t));return f("add"),i.push(function(){f("remove");c.clean()}),r.clean=e,r};n.showTableCreator=function(n){for(var e=[],r=-1,o,u=-1,i,l,h=[],c=function(f){$ts.cancelBubble(f);var s,e,c=null,l;for(r=isNaN(this.iRow)?-1:this.iRow,u=isNaN(this.iCol)?-1:this.iCol,s=0;s<h.length;s++)e=h[s],e.iRow<=r&&e.iCol<=u?$ts.addClass(e,"highlighted"):$ts.removeClass(e,"highlighted");if(r>-1&&u>-1){for(c=$ts.createElement("table",null,{width:"100%"}),l=c.appendChild($ts.createElement("tbody")),t=0;t<r+1;t++)for(o=l.appendChild($ts.createElement("tr")),i=0;i<u+1;i++)o.appendChild($ts.createElement("td"));y.innerHTML=w.replace("{0}",u+1).replace("{1}",r+1)}else y.innerHTML=a;typeof n=="function"&&n(c)},p=function(){while(e.length>0)e.pop()()},f=function(n,t,i){var r=$ts.createElement(n,t,i);return e.push(function(){r.parentNode&&r.parentNode.removeChild(r);r=null}),r},a="",w="{0} x {1}",v=function(n){n=n==="add"?$ts.addCssRule:function(n){$ts.removeCssRule(n)};n(".tableInjectionWrapper","display: inline-block;");n(".tableInjectionHeader","font-weight: bold; background-color: #666; color: #fff; padding: 5px;");n(".tableInjectionTable","width: 153px; display: table; background-color: #fff; border-collapse: separate; border-spacing: 3px; border: 1px solid #666;");n(".tableInjectionRow","display: table-row;");n(".tableInjectionCell","display: table-cell; width: 10px; height: 10px; border: solid 1px #bbb;");n(".tableInjectionCell.highlighted","outline: 1px solid rgb(239,72,16); border-color: rgb(255,226,148);")},s=f("div",{className:"tableInjectionWrapper"}),y=s.appendChild(f("div",{className:"tableInjectionHeader",innerHTML:a})),b=s.appendChild(f("div",{className:"tableInjectionTable",onmouseover:function(n){$ts.cancelBubble(n)}})),t=0;t<10;t++)for(o=b.appendChild(f("div",{className:"tableInjectionRow"})),i=0;i<10;i++)l=o.appendChild(f("div",{className:"tableInjectionCell",onmouseover:c,iRow:t,iCol:i})),h.push(l);return v("add"),$ts.addEvent(document.body,"mouseover",c),e.push(function(){v("remove");$ts.removeEvent(document.body,"mouseover",c)}),s.clean=p,s};n.DateTimePicker=new function(){function r(n){this.id=n}var i={},t=this;t.createInstance=function(n){return i[n]=new r(n),i[n]};t.getInstance=function(n){return i[n]};t.InitFromServer=function(i){var u=i.getAttribute("data-id"),f=eval("("+i.getAttribute("data-settings")+")"),r=t.createInstance(u),e=r.create(f);n.ReplaceControl(i,e);setTimeout(function(){r.init()},10)};n.AddControlClassProperties(r);r.prototype={create:function(n){n||(n={});n.from||(n.from=new Date(-621355932e5));n.to||(n.to=new Date(-621355932e5));n.type||(n.type="Date");n.cultureName||typeof culture=="undefined"||(n.cultureName=culture);n.fromValue&&(n.from=new Date(n.fromValue));this.settings=n;var t=$ts.createElement("div");return t.innerHTML=$ts.Server.call("datetimepicker_renderclientcontrol",{id:this.id,from:$ts.UI.Controls.DateTimePicker.JSTimeToDateString(n.from),to:$ts.UI.Controls.DateTimePicker.JSTimeToDateString(n.to),type:n.type,cultureName:n.cultureName||""}),this.domElement=t.firstChild,this.domElement},init:function(){$ts.UI.Controls.DateTimePicker.InitControl(this.id,this.settings.type,this.settings.cultureName,$ts.UI.Controls.DateTimePicker.JSTimeFromDate(this.settings.from),$ts.UI.Controls.DateTimePicker.JSTimeFromDate(this.settings.to),this.settings,this.settings.textFrom,this.settings.textTo)}}};n.ClearableInput=new function(){function r(n){this.id=n}var i={},t=this;t.createInstance=function(n){return i[n]=new r(n),i[n]};t.getInstance=function(n){return i[n]};t.InitFromServer=function(i){var u=i.getAttribute("data-id"),f=eval("("+i.getAttribute("data-settings")+")"),r=t.createInstance(u),e=r.create(f);n.ReplaceControl(i,e);r.init()};n.AddControlClassProperties(r);r.prototype={create:function(n){return this.settings=n,this.domElement=$ts.createElement("input",{id:this.id,type:"text"}),this.domElement},init:function(){n.AddClearButton(this.domElement);this.domElement.setClearVisibility()}}};n.SkinnedSelect=new function(){function r(n){this.id=n}var i={},t=this;t.createInstance=function(n){return i[n]=new r(n),i[n]};t.getInstance=function(n){return i[n]};t.InitFromServer=function(i){var u=i.getAttribute("data-id"),f=eval("("+i.getAttribute("data-settings")+")"),r=t.createInstance(u),e=r.create(f);n.ReplaceControl(i,e);r.init()};n.AddControlClassProperties(r);r.prototype={create:function(n){var t;this.settings=n;this.domElement=$ts.createElement("div",{id:this.id},{display:"inline-block"});var i=this.domElement,f=i.appendChild($ts.createElement("div",null,{position:"relative"})),u=f.appendChild($ts.createElement("select",null,{position:"absolute",opacity:"0"})),e=i.appendChild(n.skinElement),r;for(t=0;t<n.options.length;t++)r=u.appendChild($ts.createElement("option")),r.appendChild(document.createTextNode(n.options[t].text)),r.value=n.options[t].value;return i.skinElement=e,i.skinnedSelect=u,this.domElement},init:function(){var n=this.domElement.skinElement,t=this.domElement.skinnedSelect;t.style.width=n.offsetWidth+"px";t.style.height=n.offsetHeight+"px"}}}};// compatibility.min.js
function TCompatibility(){this.stopBubbeling=$ts.cancelBubble;this.removeOnPart=function(n){return n.replace(/^[o|O]{1}[n|N]{1}/g,"")};this.addEvent=function(n,t,i,r){$ts.addEvent(n,this.removeOnPart(t),i,r)};this.removeEvent=function(n,t,i){$ts.removeEvent(n,this.removeOnPart(t),i)}}tsCompat=new TCompatibility;typeof Tangora!="undefined"&&typeof Tangora.Events!="undefined"&&(Tangora.Events.AddHandler=tsCompat.addEvent,Tangora.Events.RemoveHandler=tsCompat.removeEvent,Tangora.Events.CancelBubble=tsCompat.stopBubbeling,Tangora.Events.removeOnPart=tsCompat.removeOnPart);// tangora.public.imagerotator.min.js
function ImageRotatorManager(){var t=[],u=null,f=!1,r=[],n=[];$ts.Observer.Register("SPA","BeforeLoad",function(){t=[]});this.GetInstance=function(n){return typeof t[n]=="undefined"&&(t[n]=new ImageRotator(n,!0)),t[n]};this.GetHtmlTransitions=function(){var t,n,i,r;if(!u)if(f==!1)f=!0,t=tsAjax.createInstance("Transitions"),t.method="post",t.postData="action=imagerotatorhtmltransitions",n=tsAjax.innerHTML("/publicajax.ashx?ts="+(new Date).getTime(),null,"Transitions",null,null,null,!0),n=eval("("+n+")"),u=n;else for(i=(new Date).getTime();;){if(r=(new Date).getTime(),r-i>5e3)break;if(!u)break}return u};this.CheckFlash=function(n,t,r,u,f){function h(){var i,n,r,f,u;e.ajaxObj.readyState==4&&(i=e.ajaxObj.responseText,i=eval("("+i+")"),n=document.createElement("div"),n.innerHTML=i.html,r=document.getElementById("imagerotator_ie_"+t),r.parentNode.insertBefore(n,r),r.parentNode.removeChild(r),f=n.getElementsByTagName("div")[0],n.parentNode.insertBefore(f,n),n.parentNode.removeChild(n),u=eval("("+i.js+")"),ImageRotator(t).Ready(u.images,u.settings))}var o=new function(){var n=this;n.installed=!1;n.raw="";n.major=-1;n.minor=-1;n.revision=-1;n.revisionStr="";var t=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(n){return r(n)}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(n){var t="6,0,21";try{n.AllowScriptAccess="always";t=r(n)}catch(i){}return t}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(n){return r(n)}}],r=function(n){var t=-1;try{t=n.GetVariable("$version")}catch(i){}return t},u=function(n){var t=-1;try{t=new ActiveXObject(n)}catch(i){t={activeXError:!0}}return t},f=function(n){var t=n.split(",");return{raw:n,major:parseInt(t[0].split(" ")[1],10),minor:parseInt(t[1],10),revision:parseInt(t[2],10),revisionStr:t[2]}},e=function(n){var t=n.split(/ +/),i=t[2].split(/\./),r=t[3];return{raw:n,major:parseInt(i[0],10),minor:parseInt(i[1],10),revisionStr:r,revision:o(r)}},o=function(t){return parseInt(t.replace(/[a-zA-Z]/g,""),10)||n.revision};n.majorAtLeast=function(t){return n.major>=t};n.minorAtLeast=function(t){return n.minor>=t};n.revisionAtLeast=function(t){return n.revision>=t};n.versionAtLeast=function(){var t=[n.major,n.minor,n.revision],r=Math.min(t.length,arguments.length);for(i=0;i<r;i++)if(t[i]>=arguments[i])if(i+1<r&&t[i]==arguments[i])continue;else return!0;else return!1};n.FlashDetect=function(){var s,o,r,h,c,i;if(navigator.plugins&&navigator.plugins.length>0)s="application/x-shockwave-flash",o=navigator.mimeTypes,o&&o[s]&&o[s].enabledPlugin&&o[s].enabledPlugin.description&&(r=o[s].enabledPlugin.description,i=e(r),n.raw=i.raw,n.major=i.major,n.minor=i.minor,n.revisionStr=i.revisionStr,n.revision=i.revision,n.installed=!0);else if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript)for(r=-1,h=0;h<t.length&&r==-1;h++)c=u(t[h].name),c.activeXError||(n.installed=!0,r=t[h].version(c),r!=-1&&(i=f(r),n.raw=i.raw,n.major=i.major,n.minor=i.minor,n.revision=i.revision,n.revisionStr=i.revisionStr))}()},s,e;(o.JS_RELEASE="1.0.4",s=/MSIE\s(\d\d)\./i.test(navigator.userAgent),!s&&o.installed&&o.major>=9)||(e=tsAjax.createInstance("ImageRotator_"+t),e.method="post",e.postData="action=imagerotatorfallback&id="+n+"&domid="+t+"&width="+r+"&height="+u+"&dynimages="+f,tsAjax.innerHTML("/publicajax.ashx?ts="+(new Date).getTime(),"tsAjax","ImageRotator_"+t,null,null,h,!0))};this.ShowLightBox=function(i,u,f,e){function h(){ImageRotator(o).ReInit?(ImageRotator(o).ReInit(u),r[i]=typeof r[i]!="undefined"?u:u):setTimeout(h,100)}var o=i.replace("_lightbox",""),s=eval("tsImageRotator_"+o+"_lightboxInit");s&&s();LightBox.SetCloseButton(i,f,e);LightBox.Show(i);$ts.Observer.RegisterOneShot(i,"Closed",function(){var r,i;n[o]=!1;r=ImageRotator(o).OnReady;ImageRotator(o).GoKillYourself();t[o]=undefined;ImageRotator(o).OnReady=r;i=eval(o+"_script");ImageRotator(o).Ready(i.images,i.settings)});h()};this.GetLightBoxStartIndex=function(n){return typeof r[n]!="undefined"?r[n]:0};this.RegisterHtmlLightBox=function(t){typeof n[t]=="undefined"&&(n[t]=!1)};this.InitHtmlLightBox=function(t){n[t]=!0};this.IsHtmlLightBoxLoaded=function(t){return typeof n[t]=="undefined"||n[t]==!0};this.GetDotGallery=function(n,t,i,r){function a(){function i(){u.style.top=t.offsetTop+"px";u.style.left=t.offsetLeft+"px";y(0)}var t=f.childNodes[ImageRotator(n).GetCurrentIndex()];t.complete?i():$ts.addEvent(t,"load",i)}function s(t){return Tangora.ImageRotatorManager.GetElement(t,n)}function v(n){u.style.opacity=(n/100).toString();b||typeof document.createElement("div").style.opacity=="undefined"&&(u.style.filter="Alpha(Opacity="+n+")")}function y(n){clearTimeout(e);n=Math.min(100,n+10);v(n);n<100?e=setTimeout(function(){y(n)},50):w("imageenter")}function p(n){clearTimeout(e);n||(n=100);n=Math.max(0,n-20);v(n);n>0&&(e=setTimeout(function(){p(n)},50))}function w(t){var i=ImageRotator(n).GetItem(ImageRotator(n).GetCurrentIndex());i&&t&&$ts.Observer.Broadcast(n,t,{image:i})}var e=null,b=s(n+"_lightbox_Wrapper"),c=s("imagerotator_htmlwrapper_"+n)||s("imagerotator_dotflashwrapper_"+n),f=s("imagerotator_"+n+"_dotcontrols"),l,o,h,u;for(c.insertBefore(f,c.firstChild),l=ImageRotator(n).GetLength(),o=0;o<l;o++)h=$ts.createElement("img",{src:t}),h.onclick=function(t){return function(){ImageRotator(n).ClearCommandQueue();ImageRotator(n).Goto(t);ImageRotator(n).Pause()}}(o),f.appendChild(h);u=$ts.createElement("img",{className:"imagerotator_dotcontrols_marker",src:i});r=="running"&&(u.onmouseout=function(){ImageRotator(n).ClearCommandQueue();ImageRotator(n).Start()});f.appendChild(u);ImageRotator(n).OnImageBegin=function(){busy=!1;var t=f.childNodes[ImageRotator(n).GetCurrentIndex()];u.style.top=t.offsetTop+"px";u.style.left=t.offsetLeft+"px"};ImageRotator(n).OnImageChange=function(){a()};ImageRotator(n).OnImageEnd=function(){p(100);w("imageleave")};a()};this.GetBasicGallery=function(t,i,r,u,f,e,o){function w(n){return Tangora.ImageRotatorManager.GetElement(n,t)}function a(){function d(n){var t=n.offsetTop;return n.offsetParent&&(t+=d(n.offsetParent)),t}var c,g,f;if(l.length!=0&&ImageRotator(t).GetLength()!=0){var i=l[ImageRotator(t).GetCurrentIndex()],v=0,y=0,e=0,o=0,nt=document.compatMode&&document.compatMode=="BackCompat";nt?(/quirksbox/.test(i.className)||(i.className+=i.className.length>0?" quirksbox":"quirksbox"),/quirksbox/.test(s.className)||(s.className+=s.className.length>0?" quirksbox":"quirksbox"),e=h(s,"padding-top")+h(s,"margin-top")+h(s,"border-top-width"),o=h(s,"padding-left")+h(s,"margin-left")+h(s,"border-left-width"),v=h(s,"padding-left")+h(s,"padding-right")+h(s,"border-left-width")+h(s,"border-right-width"),y=h(s,"padding-top")+h(s,"padding-bottom")+h(s,"border-top-width")+h(s,"border-bottom-width")):(e=h(s,"padding-top")+h(s,"margin-top")+h(s,"border-top-width"),o=h(s,"padding-left")+h(s,"margin-left")+h(s,"border-left-width"));for(var p=0,w=0,n=i.parentNode;n&&n.tagName.toLowerCase()!="body";){if($ts.getComputedStyle(n,"overflow")=="auto"){p+=n.scrollTop;w+=n.scrollLeft;var b=$ts.getPosition(n),k=$ts.getPosition(i),r={x:b[0]+n.scrollLeft,y:b[1]+n.scrollTop,width:n.offsetWidth,height:n.offsetHeight},u={x:k[0]-n.scrollLeft,y:k[1]-n.scrollTop,width:i.offsetWidth,height:i.offsetHeight},tt=r.y>=u.y,it=r.y+r.height<=u.y+u.height,rt=r.x>=u.x,ft=r.x+r.width<=u.x+u.height;if(tt||it||rt||ft){s.style.visibility="hidden";return}$ts.addEvent(n,"scroll",a)}n=n.parentNode}s.style.visibility="visible";c=i.getBoundingClientRect();g=d(i)/(Math.round(c.top)+(typeof pageYOffset!="undefined"?window.pageYOffset:document.documentElement.scrollTop));f=g==1?{width:i.offsetWidth,height:i.offsetHeight,top:i.offsetTop,left:i.offsetLeft}:c;s.style.top=f.top-(e+p)+"px";s.style.left=f.left-(o+w)+"px";s.style.width=f.width+v+"px";s.style.height=f.height+y+"px";ut(0)}}function it(n){var i=ImageRotator(t).GetItem(ImageRotator(t).GetCurrentIndex());i&&n&&$ts.Observer.Broadcast(t,n,{image:i})}function h(n,t){var i=0,r;if(document.defaultView&&document.defaultView.getComputedStyle)r=document.defaultView.getComputedStyle(n,null),r!=null&&(i=r.getPropertyValue(t));else if(n.currentStyle){while(/([a-z])-([a-z])/.test(t))t=t.replace(/([a-z])-([a-z])/,RegExp.$1+RegExp.$2.toUpperCase());i=n.currentStyle[t]}if(/\d/.test(i))i=parseInt(i,10);else return 0;return isNaN(i)?0:i}function rt(n){s.style.opacity=(n/100).toString();et||typeof document.createElement("div").style.opacity=="undefined"&&(s.style.filter="Alpha(Opacity="+n+")")}function ut(n){clearTimeout(y);n=Math.min(100,n+10);rt(n);n<100?y=setTimeout(function(){ut(n)},50):it("imageenter")}function ft(n){clearTimeout(y);n||(n=100);n=Math.max(0,n-20);rt(n);n>0&&(y=setTimeout(function(){ft(n)},50))}var et=w(t+"_lightbox_Wrapper"),k=w("imagerotator_"+t+"_gallery"),p,nt,tt,c,b;if(k){var s=w("imagerotator_"+t+"_marker"),v=k.getElementsByTagName("img"),y=null,l=[];if(v.length==0&&(p=$elm("imagerotator_"+t+"_marker"),$chain("#imagerotator_htmlwrapper_"+t+" > img").each(function(n){var i=Tangora.ImageRotatorManager.GetImageGeneratorSrc(n.getAttribute("src"),u,f,e,o),t=$ts.createElement("img",{src:i,width:u,height:f});p.parentNode.insertBefore(t,p.nextSibling);p=t})),v.length>0&&ImageRotator(t).GetLength()>0){var d=ImageRotator(t).GetItem(0).Source.split("/"),g=d[d.length-1],ot=g.replace(/\.(jpg|jpeg|png|gif)/i,"@2x.$1");for(c=0;c<v.length;c++)l.push(v[c]);for(nt=(new Date).getTime();l.length>0&&l[0].getAttribute("src").indexOf(g)==-1&&l[0].getAttribute("src").indexOf(ot)==-1;){if(tt=(new Date).getTime(),tt-nt>1e3)break;l.push(l.shift())}for(c=0;c<l.length;c++)i=="click"?(l[c].onclick=new Function("ImageRotator('"+t+"').ClearCommandQueue(); if(ImageRotator('"+t+"').GetCurrentIndex() != "+c+") { ImageRotator('"+t+"').Goto("+c+"); }; ImageRotator('"+t+"').Pause();"),r=="running"&&(l[c].onmouseout=new Function("if(ImageRotator('"+t+"').GetCurrentIndex() != "+c+")return;ImageRotator('"+t+"').ClearCommandQueue();ImageRotator('"+t+"').Start();"))):(l[c].onmouseover=new Function("ImageRotator('"+t+"').ClearCommandQueue();ImageRotator('"+t+"').Goto("+c+");ImageRotator('"+t+"').Pause();"),r=="running"&&(l[c].onmouseout=new Function("if(ImageRotator('"+t+"').GetCurrentIndex() != "+c+")return;ImageRotator('"+t+"').ClearCommandQueue();ImageRotator('"+t+"').Start();")))}a();ImageRotator(t).OnImageChange=a;ImageRotator(t).OnImageEnd=function(){ft();it("imageleave")};$ts.addEvent(window,"resize",function(){try{a()}catch(n){}});n[t]&&(b=t+"_lightbox",$ts.Observer.RegisterOneShot(b,"Closing",function(){s.style.visibility="hidden"}),$ts.Observer.RegisterOneShot(b,"ShowComplete",function(){setTimeout(a,1)}))}};this.GetElement=function(n,t){var i=!1;try{typeof top.$elm}catch(r){i=!0}return i?$elm(n):typeof top.$elm!="undefined"&&top.$elm(t+"_lightbox_Wrapper")?top.$elm(n):$elm(n)};this.GetImageGeneratorSrc=function(n,t,i,r,u){var f;n.indexOf("/imagegenerator/")!=-1&&(f=n.substring(0,n.indexOf("/imagegenerator/")),f+=n.substring(n.lastIndexOf("/")),n=f.substring(f.indexOf("/media")));var o=n.substring(0,n.lastIndexOf("/")),s=n.substring(n.lastIndexOf("/")),e="/imagegenerator/"+t+"x"+i;return e+=u?"/canvascolor("+u+")":"/forcedimensions(true)",r&&(e+="/macro("+r+")"),o+e+s}}function ImageRotatorImage(n){this.Source=n;this.Duration="inherit";this.Link="inherit";this.NewWindow="inherit";this.Name=n;this.Description="";this.EditDate=null;var t=null;this.AddTransition=function(n){t||(t=[]);t.push(n)};this.GetTransitions=function(){return t?t.join(","):"inherit"}}function ImageRotator(n,t){function c(){var i=$elm("#"+n+"_lightbox_Wrapper object"),t;i||(s="open",t=Tangora.ImageRotatorManager.GetLightBoxStartIndex(n+"_lightbox"),ImageRotator(n).ReInit(t))}function l(){s="closed"}function v(t,a,v){function b(n,t){if(n!=null&&!/^\d+$/.test(n))throw new Error("ImageRotator: Index must be an integer.");if(n<0||n>t)throw new Error("ImageRotator: Index out of bounds.");}function g(){if(i.length>=64)throw new Error("ImageRotator: Cannot contain more than 64 images.");}function w(n,i,r,u){if(e)return t;i&&b(i,r);switch(n){case"start":y.Start();break;case"pause":y.Pause();break;case"next":y.Next();break;case"previous":y.Previous();break;case"goto":y.Goto(i);break;case"add":_isHtmlFallback?y.Add(i,u):y.Add(i,u.Source,u.Duration,u.Link,u.NewWindow,u.GetTransitions());break;case"remove":y.Remove(i);break;case"clear":y.ClearCommandQueue();break;default:throw new Error("ImageRotator: Method not supported.");}return t}function k(n){for(var r,t,u,f;i.length>0;)i.shift(0,1);for(r=typeof n=="object"?n:eval("("+n+")"),t=0;t<r.length;t++){for(u=new ImageRotatorImage(r[t].source),u.Duration=r[t].duration,u.Link=r[t].link,u.NewWindow=r[t].newwindow,f=0;f<r[t].transitions.length;f++)u.AddTransition(r[t].transitions[f]);typeof r[t].editdate!="undefined"&&(u.EditDate=new Date(r[t].editdate));typeof r[t].name!="undefined"&&(u.Name=r[t].name);typeof r[t].description!="undefined"&&(u.Description=r[t].description);i.push(u)}o&&it()}function d(n){var i=typeof n=="object"?n:eval("("+n+")");u=i.busy;f=i.paused;r=i.currentindex;switch(i.event){case"ImageChange":t.OnImageChange&&t.OnImageChange();break;case"ImageBegin":t.OnImageBegin&&t.OnImageBegin();break;case"ImageEnd":t.OnImageEnd&&t.OnImageEnd()}o&&tt(i)}function p(t){return Tangora.ImageRotatorManager.GetElement(t,n)}function nt(){var n=document.getElementById("debugrotator"),t,i,r,u;n||(n=document.createElement("div"),n.id="debugrotator",n.style.border="#000 1px solid",n.style.backgroundColor="#fff",n.style.padding="10px",document.body.appendChild(n),t=document.createElement("div"),t.id="debugrotator_events",t.style.height="200px",t.style.overflow="auto",t.style.marginBottom="10px",t.innerHTML='<table border="1" style="width:100%;border:1px solid #ccc;margin-bottom:10px;"><tr><th>Event<\/th><th>Busy<\/th><th>Paused<\/th><th>Current index<\/th><\/tr>&nbsp;<\/table>',n.appendChild(t),i=document.createElement("div"),i.id="debugrotator_sorting",n.appendChild(i),r=document.createElement("div"),r.id="debugrotator_queue",n.appendChild(r),u=document.createElement("div"),u.id="debugrotator_images",n.appendChild(u))}function tt(n){var t=document.getElementById("debugrotator_events");t&&(t.innerHTML=t.innerHTML.replace("&nbsp;","&nbsp;<tr><td>"+n.event+"<\/td><td>"+n.busy+"<\/td><td>"+n.paused+"<\/td><td>"+n.currentindex+"<\/td><\/tr>"))}function it(){var r=document.getElementById("debugrotator_images"),n,t;if(r){for(n='<table border="1" style="width:100%;border:1px solid #ccc;margin-bottom:10px;"><tr><th>Index<\/th><th>Source<\/th><th>Duration<\/th><th>Link<\/th><th>New window<\/th><th>Transitions<\/th><\/tr>',t=0;t<i.length;t++)n+="<tr>",n+="<td>"+t+"<\/td>",n+="<td>"+i[t].Source+"<\/td>",n+="<td>"+i[t].Duration+"<\/td>",n+="<td>"+i[t].Link+"<\/td>",n+="<td>"+i[t].NewWindow+"<\/td>",n+="<td>"+i[t].GetTransitions()+"<\/td>",n+="<\/tr>";n+="<\/table>";r.innerHTML=n}}function rt(n){var u,r,t,i;if(o&&(u=document.getElementById("debugrotator_sorting"),u)){for(r=eval("("+n+")"),t='<table border="1" style="width:100%;border:1px solid #ccc;margin-bottom:10px;"><tr><th>Array<\/th><th>Stage<\/th><th>Index<\/th><th>Name<\/th><\/tr>',i=0;i<r.length;i++)t+="<tr>",t+="<td>"+r[i].array+"<\/td>",t+="<td>"+r[i].stage+"<\/td>",t+="<td>"+r[i].index+"<\/td>",t+="<td>"+r[i].name+"<\/td>",t+="<\/tr>";t+="<\/table>";u.innerHTML=t}}function ut(n){var r,u,t,i;if(o&&(r=document.getElementById("debugrotator_queue"),r)){for(u=eval("("+n+")"),t='<table border="1" style="width:100%;border:1px solid #ccc;margin-bottom:10px;"><tr><th>Queue<\/th><\/tr>',i=0;i<u.length;i++)t+="<tr>",t+="<td>"+u[i]+"<\/td>",t+="<\/tr>";t+="<\/table>";r.innerHTML=t}}function ft(o){function b(n,t){t||(t=[]);d.push([n,t])}function at(){for(var n,i,r=d.length,t=0;t<r;t++)if(n=d.shift(),typeof n[0]=="function"){i=n[1].length;switch(i){case 0:n[0]();break;case 1:n[0](n[1][0]);break;case 2:n[0](n[1][0],n[1][1]);break;default:throw new Error("ImageRotator: Number of arguments not supported.");}}}function ot(e){var o;if($ts.exists(e)){for(clearTimeout(l),v=null,o=0;o<i.length;o++)p(n+"_"+o).style.visibility="hidden";p(n+"_"+e).style.visibility="visible";r=e;g()}else lt&&(r=Math.floor(Math.random()*i.length),g());if(f=ut?!1:!ct||i.length<2,f&&(w=function(){clearTimeout(l);l=setTimeout(it,i[r].Duration);v=(new Date).getTime();w=null;f=!1}),i.length==0){u=!1;return}if(nt)$ts.exists(e)||et("in",tt),a().style.visibility="visible",$ts.exists(e)&&!f&&tt();else{for(o=0;o<i.length;o++)p(n+"_"+o).style.visibility="visible";tt()}$ts.exists(e)&&t.OnImageChange&&t.OnImageChange()}function a(){return p(n+"_"+r)}function k(t){return p(n+"_"+t)}function tt(){if(!e){var n=i[r],o=a();a().style.visibility="visible";n.Link!=""&&(o.onclick=function(){n.NewWindow?window.open(n.Link,"rotatorimage"+r+"_link","location=1,resizable=1,toolbar=1,scrollbars=1,status=1"):location.href=n.Link},o.style.cursor="pointer");f||(!h||h&&s=="open")&&(clearTimeout(l),l=setTimeout(it,n.Duration),v=(new Date).getTime());t.OnImageBegin&&t.OnImageBegin();u=!1;at()}}function ft(n){function h(){nt&&(f.style.visibility="hidden");o.style.visibility="hidden";f.style.zIndex=i.length-1;o.style.zIndex=i.length;r=n;t.OnImageChange&&t.OnImageChange();et("in",c);a().style.visibility="visible"}function c(){g();tt()}var f,o,s;if(!e&&(ut||!(i.length<2))&&(u=!0,clearTimeout(l),v=null,a())){for(t.OnImageEnd&&t.OnImageEnd(),f=a(),o=k(n),f.onclick=null,f.style.cursor="default",s=0;s<i.length;s++)k(s).style.zIndex=0;f.style.zIndex=i.length;o.style.zIndex=i.length-1;et("out",h)}}function g(){if(!e&&!(i.length<2)){a().style.zIndex=i.length;for(var t=i.length-1,n=r+1;n<i.length;)k(n).style.zIndex=t,n++,t--;for(n=0;n<r;)k(n).style.zIndex=t,n++,t--}}function it(){if(!e){var n=r<i.length-1?r+1:0;ft(n)}}function et(t,u){function w(n){if(l.push(n),a++,a==h.length){for(var t=0;t<l.length;t++)l[t]();u()}}var o,s,v,y,f;if(!e){if(o=null,ut)c.previewtransitionobj.direction==t&&(o=c.previewtransitionobj);else for(s=i[r].GetTransitions().split(","),f=0;f<s.length;f++)if(s[f]=="-1")t=="in"?o=ht(t):nt&&(o=ht(t));else{if(typeof rt["trans_"+s[f]]=="undefined")continue;if(rt["trans_"+s[f]].direction==t){o=rt["trans_"+s[f]];break}}if(!o){u();return}var h=[],l=[],a=0;for(f=0;f<o.effects.length;f++){v=null;switch(o.effects[f].name){case"htmlfade":y=Tangora.Browser.GetType();(!Tangora.Browser.IE||Tangora.Browser.IE&&ScriptEngineMajorVersion()>=9||!p(n+"_lightbox_Wrapper"))&&h.push(vt);break;case"htmlwipe":h.push(yt)}}if(h.length>0)for(f=0;f<h.length;f++)h[f](t,o.duration,o.effects[f],w);else u()}}function st(n,t,i){var r,u;t=="in"&&(i=100-i);r=i;switch(n){case"regular":u=10;r=Math.log(i*u/100+1)/Math.log(u)*100;break;case"strong":u=50;r=Math.log(i*u/100+1)/Math.log(u)*100}return t=="in"&&(r=100-r),Math.max(Math.min(r,100),0)}function ht(n){var r={},i,t;return r.method="",r.type="none",i={},i.name="htmlfade",i.easing=r,t={},t.direction=n,t.duration=1e3,t.effects=[],t.effects.push(i),t}function vt(n,t,i,r){function o(){var l=(new Date).getTime()-h,a=Math.max(Math.min(l/t*100,100),0),u=st(i.easing.type,i.easing.method,Math.floor(a));f=n=="in"?Math.floor(u):Math.floor(100-u);s();n=="in"&&f<100||n=="out"&&f>0?e=setTimeout(o,10):r(c)}function s(){if(u.style.opacity=(f/100).toString(),typeof document.createElement("div").style.opacity=="undefined"){var n=u.style.visibility;u.style.visibility="visible";u.style.filter="Alpha(Opacity="+f+")";u.style.visibility=n}}function c(){e&&clearTimeout(e);f=100;s();var n=u.style.visibility;u.style.visibility="visible";u.style.filter="";u.style.visibility=n}var u=a(),h=(new Date).getTime(),f=n=="in"?0:100,e=null;o()}function yt(n,t,i,r){function c(){var p=(new Date).getTime()-l,y=Math.max(Math.min(p/t*100,100),0),a=st(i.easing.type,i.easing.method,Math.floor(y));switch(i.startpointvertical){case"top":o=Math.floor(a*u.height/100);n=="out"&&(o=u.height-o);break;case"bottom":f=Math.floor(u.height-a*u.height/100);n=="out"&&(f=u.height-f)}switch(i.startpointhorizontal){case"left":e=Math.floor(a*u.width/100);n=="out"&&(e=u.width-e);break;case"right":s=Math.floor(u.width-a*u.width/100);n=="out"&&(s=u.width-s)}u.style.clip="rect("+f+"px,"+e+"px,"+o+"px,"+s+"px)";y>=100?r(v):h=setTimeout(c,10)}function v(){h&&clearTimeout(h);u.style.clip="rect(auto, auto, auto, auto)"}var u=a(),l=(new Date).getTime(),f=0,e=u.width,o=u.height,s=0,h=null;c()}var rt=Tangora.ImageRotatorManager.GetHtmlTransitions(),c=typeof o=="object"?o:eval("("+o+")"),ct=c.autostart,lt=c.randomstart,ut=c.previewtransition,nt=c.hidequeuedimages,l=null,v=null,w=null,d=[];this.Start=function(){u?b(y.Start):f&&(w&&w(),w=null)};this.Pause=function(){if(u)b(y.Pause);else if(!f){f=!0;clearTimeout(l);var n=v?(new Date).getTime()-v:0,t=Math.max(1,i[r].Duration-n);w=function(){clearTimeout(l);l=setTimeout(it,t);v=(new Date).getTime()-n;w=null;f=!1}}};this.Next=function(){u?b(y.Next):it()};this.Previous=function(){if(u)b(y.Previous);else{var n=r>0?r-1:i.length-1;ft(n)}};this.Goto=function(n){u?b(y.Goto,[n]):ft(n)};this.Add=function(t,r){var e,o,f;if(u)b(y.Add,[t,r]);else{if(r.Duration=="inherit"&&(r.Duration=c.defaultduration),r.Link=="inherit"&&(link=r.Link=c.defaultlink),r.NewWindow=="inherit"&&(r.NewWindow=c.defaultnewwindow),r.GetTransitions()=="inherit"&&(c.defaulttransitionin&&r.AddTransition(c.defaulttransitionin),c.defaulttransitionout&&r.AddTransition(c.defaulttransitionout)),t==i.length)i.push(r);else for(i.splice(t,0,r),e=i.length-1;e>t;e--)k(e-1).setAttribute("id",n+"_"+e);o=document.getElementById("imagerotator_htmlwrapper_"+n);f=document.createElement("img");f.id=n+"_"+t;f.src=Tangora.ImageRotatorManager.GetImageGeneratorSrc(r.Source,c.width,c.height,c.macro,c.paddingcolor);f.width=c.width;f.height=c.height;f.style.visibility=nt?"hidden":"visible";f.style.position="absolute";c.scalable&&(f.style.top="0px",f.style.left="0px",f.style.width="100%",f.style.height="auto",f.style.maxWidth=c.width+"px",f.style.maxHeight=c.height+"px");i.length==0||t==i.length-1?o.appendChild(f):o.insertBefore(f,k(t+1));g()}};this.Remove=function(t){var e,f,o;if(u||i.length!=1&&t==r)b(y.Remove,[t]);else{for(i.splice(t,1),e=k(t),e.parentNode.removeChild(e),f=t;f<i.length;f++)o=document.getElementById(n+"_"+(f+1)),o.setAttribute("id",n+"_"+f);g();i.length<2&&(ImageRotator(n).Pause(),r=0)}};this.ClearCommandQueue=function(){while(d.length>0)d.pop()};this.Debug=function(){alert("Debug is not supported in HTML mode.\nUse DOM explorer instead.")};this.ReInit=function(n){ot(n)};ot()}typeof LightBox!="undefined"&&$ts.exists(LightBox)&&p(n+"_lightbox_Wrapper")&&p("#"+n+"_lightbox_Wrapper object")==null&&($ts.Observer.UnRegister(n+"_lightbox","ShowComplete",c),$ts.Observer.UnRegister(n+"_lightbox","Closed",l),$ts.Observer.Register(n+"_lightbox","ShowComplete",c),$ts.Observer.Register(n+"_lightbox","Closed",l),h=!0,s="closed");o=!1;u=!0;f=!1;i=[];r=0;_isHtmlFallback=!1;d(v);k(a);var y=document.getElementById("imagerotator_ie_"+n);y&&typeof y.Next=="undefined"&&(y=document.getElementById("imagerotator_"+n));(!y||y&&typeof y.Next=="undefined")&&(y=new ft(v),_isHtmlFallback=!0);t.GoKillYourself=function(){e=!0;t.OnImageChange=null;t.OnImageBegin=null;t.OnImageEnd=null;t.OnReady=null;t.IsReady=function(){return!1}};t.Start=function(){return w("start")};t.Pause=function(){return w("pause")};t.Next=function(){return w("next")};t.Previous=function(){return w("previous")};t.Goto=function(n){return w("goto",n,i.length-1)};t.Add=function(n,t){return b(n,i.length),g(),w("add",n,i.length,t)};t.Remove=function(n){return b(n,i.length-1),w("remove",n,i.length-1)};t.ClearCommandQueue=function(){return w("clear")};t.GetItem=function(n){return b(n,i.length-1),i[n]};t.GetLength=function(){return i.length};t.GetCurrentIndex=function(){return r};t.IsBusy=function(){return u};t.IsPaused=function(){return f};t.IsReady=function(){return!0};t.ReInit=function(n){y.ReInit(n)};t.StateChange=function(n){d(n)};t.ImageChange=function(n){k(n)};t.IndexChange=function(n){rt(n)};t.QueueChange=function(n){ut(n)};t.Debug=function(){o=!0;nt();y.Debug()}}var o,u,f,i,r,h=!1,s=null,a=null,e=null;return t?(this.OnImageChange=null,this.OnImageBegin=null,this.OnImageEnd=null,this.OnReady=null,this.IsReady=function(){return!1},this.Ready=function(t,i){function u(){window.loaded&&Tangora.ImageRotatorManager.IsHtmlLightBoxLoaded(n)?(v(r,t,i),$ts.Observer.Broadcast(n,"BeforeOnReady",{id:n,images:t,settings:i}),r.OnReady&&r.OnReady(n),/admin\/designer\.aspx/i.test(location.href)&&(r.ClearCommandQueue(),r.Pause())):setTimeout(u,100)}a=(new Date).getTime()+"-"+Math.floor(Math.random()*9999999999);e=!1;var r=this;u()},this):Tangora.ImageRotatorManager.GetInstance(n)}if(typeof Tangora=="undefined")var Tangora={};Tangora.ImageRotator=ImageRotator;Tangora.ImageRotatorManager=new ImageRotatorManager;// snippethandlers.min.js
function TSFlyouts(){function n(){this.namedItems=[];this.items=[];this.addItem=function(n,t){this.namedItems[n]=t;this.items.push(t)};this.getItem=function(n){return typeof n=="string"?this.namedItems[n]:this.items[n]};this.length=function(){return this.items.length}}function t(){this.instanceName="";this.triggerId=null;this.fadeOut=!1;this.verticalPlacement=0;this.horizontalPlacement=0;this.flyoutId="";this.imgSrcI="";this.imgSrcA="";this.imgSrcH="";this.clickHandler=null;this.active=!1;this.hiddenElements=[];this.element2beFocused=null;this.show=function(n){for(var r,a,o,l,i,f=null,t=0;t<tsFlyouts.storage.length();t++)f=tsFlyouts.storage.getItem(t),f.instanceName!=this.instanceName&&f.hide(document.getElementById(f.flyoutId));this.active=!0;var e=document.getElementById(this.triggerId),u=this.getPos(e),s=u[0],h=u[1];if(this.verticalPlacement==0?h-=n.offsetHeight:h+=e.offsetHeight,this.horizontalPlacement==0&&(s+=e.offsetWidth,s-=n.offsetWidth),n.style.top=h,n.style.left=s,document.all){var u=this.getPos(n),v=[u[0],u[1],n.clientWidth,n.clientHeight],c=document.getElementsByTagName("SELECT");if(c.length>0)for(t=0;t<c.length;t++)r=c[t],u=this.getPos(r),a=[u[0],u[1],r.clientWidth,r.clientHeight],this.intersects(v,a)&&r.style.display.toLowerCase()!="none"&&r.style.visibility.toLowerCase()!="hidden"&&(this.hiddenElements.push(r),r.style.visibility="hidden")}if(o=e.childNodes[0],o.src=this.imgSrcA,o.onmouseover=function(){},o.onmouseout=function(){},this.clickHandler==null&&(this.clickHandler="tsFlyouts.popDown('"+this.instanceName+"')",/Mozilla\/5\.0/.test(navigator.userAgent)?tsCompat.addEvent(window,"onclick",function(){eval(l)}):tsCompat.addEvent(document.body,"onclick",function(){eval(l)}),tsCompat.addEvent(n,"onclick",function(){eval("if(window.event) {window.event.cancelBubble=true;} else {arguments[0].stopPropagation();}")}),l=this.clickHandler),n.filters&&n.filters[0]&&(n.filters[0].enabled=!0,n.filters[0].apply()),n.style.visibility="visible",n.filters&&n.filters[0]&&n.filters[0].play(),i=n.getElementsByTagName("INPUT"),i.length>0)if(n.filters){if(n.filters[0]){for(t=0;t<i.length;t++)if(i[t].type!="hidden"){this.element2beFocused=i[t];window.setTimeout("tsFlyouts.focusElement('"+this.instanceName+"')",1e3);break}}else for(t=0;t<i.length;t++)if(i[t].type!="hidden"){i[t].focus();break}}else for(t=0;t<i.length;t++)if(i[t].type!="hidden"){i[t].focus();break}};this.hide=function(n){var t,i,r;this.active=!1;t=document.getElementById(this.triggerId).childNodes[0];this.fadeOut&&n.filters&&n.filters[0]&&n.filters[0].apply();n.style.visibility="hidden";this.fadeOut&&n.filters&&n.filters[0]&&n.filters[0].play();t.src=this.imgSrcI;i="this.src = '"+this.imgSrcH+"';";t.onmouseover=function(){eval(i)};r="this.src = '"+this.imgSrcI+"';";t.onmouseout=function(){eval(r)};this.hiddenElements.length>0&&n.filters&&n.filters[0]&&window.setTimeout("tsFlyouts.showSelects('"+this.instanceName+"')",n.filters[0].duration*1e3)};this.getPos=function(n){if(!n)return[-1,-1];for(var i=n.offsetLeft,r=n.offsetTop,t=n.offsetParent;t!=null;)i+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;return document.all||(i-=2),[i,r]};this.intersects=function(n,t){var i=parseInt(n[2]/2),r=parseInt(n[3]/2),u=parseInt(t[2]/2),f=parseInt(t[3]/2),e=n[0]+i,o=n[1]+r,s=t[0]+u,h=t[1]+f,c=Math.abs(s-e),l=Math.abs(h-o);return c<i+u&&l<r+f?!0:!1}}this.storage=new n;this.getInstance=function(n){return this.storage.getItem(n)==null&&this.storage.addItem(n,new t),this.storage.getItem(n)};this.addInstance=function(n,t,i,r,u,f,e,o,s){var h=this.getInstance(n);return h.instanceName=n,h.triggerId=t,h.fadeOut=i==1,h.verticalPlacement=r,h.horizontalPlacement=u,h.flyoutId=f,h.imgSrcI=e,h.imgSrcA=o,h.imgSrcH=s,h};this.fly=function(n,t){!t&&window.event&&(t=window.event);var i=tsFlyouts.getInstance(n),r=document.getElementById(i.flyoutId);return r.style.visibility=="visible"||i.active==!0?i.hide(r):i.show(r),t.stopPropagation&&t.stopPropagation(),window.event&&(t.cancelBubble=!0),!1};this.popDown=function(n){var t=tsFlyouts.getInstance(n),i=document.getElementById(t.flyoutId);t.hide(i)};this.showSelects=function(n){for(var t=tsFlyouts.getInstance(n),r=document.getElementById(t.flyoutId),i;t.hiddenElements.length>0;)i=t.hiddenElements.pop(),i.style.visibility="visible"};this.focusElement=function(n){var t=tsFlyouts.getInstance(n);t.element2beFocused&&t.element2beFocused.focus()};this.getParentForm=function(n){for(var t=n.parentNode;t!=null&&t.tagName.toLowerCase()!="form";)t=t.parentNode;return t}}function TSSlideShows(){function n(){this.namedItems=[];this.items=[];this.addItem=function(n,t){this.namedItems[n]=t;this.items.push(t)};this.getItem=function(n){return typeof n=="string"?this.namedItems[n]:this.items[n]};this.length=function(){return this.items.length}}function t(){this.position=1;this.timeout=1e3;this.fadeOut=!1;this.instanceName="";this.init=function(){var n="slideShows_nextSlide('"+this.instanceName+"')";window.setTimeout(n,this.timeout)};this.nextSlide=function(){var t=document.getElementById(this.instanceName+this.position),n,i;this.fadeOut&&t.filters&&t.filters[0]&&t.filters[0].apply();t.style.visibility="hidden";this.fadeOut&&t.filters&&t.filters[0]&&t.filters[0].play();n=document.getElementById(this.instanceName+(this.position+1));n==null?(this.position=1,n=document.getElementById(this.instanceName+this.position)):this.position+=1;n.filters&&n.filters[0]&&n.filters[0].apply();n.style.visibility="visible";n.filters&&n.filters[0]&&n.filters[0].play();i="slideShows_nextSlide('"+this.instanceName+"')";window.setTimeout(i,this.timeout)}}this.storage=new n;this.getInstance=function(n){return this.storage.getItem(n)==null&&this.storage.addItem(n,new t),this.storage.getItem(n)};this.addInstance=function(n,t,i){var r=this.getInstance(n);return r.instanceName=n,r.timeout=t,r.fadeOut=i,r.init(),r}}function slideShows_nextSlide(n){tsSlideShows.getInstance(n).nextSlide()}tsFlyouts=new TSFlyouts;tsSlideShows=new TSSlideShows;// tangora.public.layout.min.js
function LayoutController(){function e(){$chain("[data-responsive-backgroundimage]").each(function(n){function c(n,t,i,r){if(!t&&!i&&!r||n.indexOf("/imagegenerator/")!=-1)return n;var r=r?"/macro("+r+")":"",u=n.substring(0,n.lastIndexOf("/")),f=n.substring(n.lastIndexOf("/"));return u+"/imagegenerator/"+(t||0)+"x"+(i||0)+r+f}function f(n){var r,i;if(t.sort(function(n,t){var i=parseInt(n.mode),r=parseInt(t.mode);return i==r?0:i==0?-1:r==0?1:i<r?1:r<i?-1:void 0}),n==0)return{src:t[0].src,width:Math.max(parseInt(t[0].width||"0"),0),height:Math.max(parseInt(t[0].height||"0"),0),macro:Math.max(parseInt(t[0].macro||"0"),0)};for(r={},i=0;i<t.length;i++){if(t[i].mode<n&&t[i].mode!=0)break;t[i].src&&(r.src=t[i].src);(t[i].width>-1||t[i].height>-1||t[i].macro>-1)&&(r.width=Math.max(parseInt(t[i].width||"0"),0),r.height=Math.max(parseInt(t[i].height||"0"),0),r.macro=Math.max(parseInt(t[i].macro||"0"),0))}return r}var t=eval("("+n.getAttribute("data-responsive-backgroundimage")+")"),u="none",r=f(0),e;if(window.getSelection){if(i>0&&(r=f(i)),!/\/imagegenerator\//.test(r.src)&&(e=$ts.getComputedStyle(n,"background-size")||"",/(\d+)px(\s(\d+)px)?/.test(e))){var l=$ts.safeInt(RegExp.$1),a=$ts.safeInt(RegExp.$3),v=$ts.safeInt(r.width)||999999,y=$ts.safeInt(r.height)||999999;r.width=Math.min(l,v);r.height=Math.min(a,y)}var u=r.src,o=$ts.safeInt(r.width),s=$ts.safeInt(r.height),h=$ts.safeInt(r.macro);u&&(o||s||h)&&(u=c(u,o,s,h));window.matchMedia&&/\/imagegenerator\//.test(u||"")&&!/@2x\./.test(u||"")&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5), (min-resolution: 144dpi)").matches&&(u=u.replace(/\.(jpg|jpeg|gif|png)/i,"@2x.$1"))}else u=r.src;n.style.backgroundImage=/\./.test(u||"")?'url("'+u+'")':"none"})}function o(){function t(n,t,i){for(var r=n;r;){if(r&&/modulelayout-?\d+/.test(r.className))return t==$elm("."+i,r);r=r.parentNode}return!1}function r(n,t){var e,o,i,r,f;if(n.setAttribute("src",t),e=n.getAttribute("srcset"),e){for(o=e.split(","),i=[],r=0;r<o.length;r++)/(\d)x$/.test(o[r])&&(f=RegExp.$1,f==1?i.push(t+" 1x"):i.push(t.replace(/\.(png|jpe?g|gif)$/i,"@"+f+"x.$1")+" "+f+"x"));n.setAttribute("srcset",i.join(", "))}u(n)}function u(n){var t=n.parentNode.parentNode,i,r;t&&(t.style.backgroundImage="",t.style.backgroundSize="",t.style.backgroundRepeat="",$ts.getComputedStyle(n,"visibility")=="hidden"&&(i=n.getAttribute("src"),r=n.getAttribute("data-ts-transitiontriggerstate2"),i==r&&(t.style.backgroundImage="url("+n.getAttribute("src")+")"),t.style.backgroundSize=$ts.getComputedStyle(n,"width")+" "+$ts.getComputedStyle(n,"height"),t.style.backgroundRepeat="no-repeat"))}$chain("[data-responsive-transitions]").each(function(t){function l(n){for(var t=0;t<r.length;t++)if(r[t].mode==n)return r[t].type;return null}function a(n){for(var t=0;t<r.length;t++)if(r[t].mode==n)return r[t].sharedtransitionid;return null}var r=eval("("+t.getAttribute("data-responsive-transitions")+")"),e=l(0),o=a(0),u,f,s,h,c;if(window.getSelection&&i>0)for(u=0;u<n.length;u++){if(f=n[u],f<i)break;s=l(f);s&&(e=s);h=a(f);h&&(o=h)}e?(t.setAttribute("data-ts-transitiontype",e),o&&t.setAttribute("data-ts-transitiongroup",o),window.getSelection||(c=t.style.display,t.setAttribute("data-ie8transitionfallbackdisplayvalue",c),t.style.display="none",setTimeout(function(){t.style.display=c},1))):(t.removeAttribute("data-ts-transitiontype"),t.removeAttribute("data-ts-transitiongroup"))});$chain("[data-ts-transitiontriggerstate2]").each(function(n){if(n.parentNode&&n.parentNode.tagName.toLowerCase()=="a"&&/Tangora.Layout.TransitionManager.RunTransition\('([^']+)'/.test(n.parentNode.getAttribute("onclick"))){var i=RegExp.$1,f=n.getAttribute("src"),e=n.getAttribute("data-ts-transitiontriggerstate2");$ts.Observer.Register(i,"TransitionState2End",function(u,f,o){(!$ts.hasClass(o.trigger,i)||t(n,o.trigger,i))&&r(n,e)});$ts.Observer.Register(i,"TransitionState1End",function(u,e,o){(!$ts.hasClass(o.trigger,i)||t(n,o.trigger,i))&&r(n,f)});$ts.Observer.Register("Tangora.Layout","ResponsiveBreakpoint",function(){u(n)})}});Tangora.Layout.TransitionManager.SetExclusiveGroups()}function l(){function n(n){for(var t,f,e=0,r=0,i=0,s=-999999,a=-999999,h=-999999,c=-999999,o=[],l=!0,u=0;u<n.length;u++){t=n[u];f=t.getBoundingClientRect();e++;f.left>s&&(i++,s=f.left);f.top>a&&(r++,a=f.top,i=1,s=f.left);i>h&&(h=i);r>c&&(c=r);var v=t.getAttribute("data-blocklistindex"),y=t.getAttribute("data-blocklistcolindex"),p=t.getAttribute("data-blocklistrowindex");(v!=e||y!=i||p!=r)&&o.push(t);l&&(v||y||p)&&(l=!1);t.setAttribute("data-blocklistindex",e);t.setAttribute("data-blocklistcolindex",i);t.setAttribute("data-blocklistrowindex",r);t.setAttribute("data-blocklistcolparity",i%2==0?"even":"odd");t.setAttribute("data-blocklistrowparity",r%2==0?"even":"odd")}for(u=0;u<n.length;u++){var t=n[u],e=$ts.safeInt(t.getAttribute("data-blocklistindex")),i=$ts.safeInt(t.getAttribute("data-blocklistcolindex")),r=$ts.safeInt(t.getAttribute("data-blocklistrowindex")),w=n.length-(e-1),b=h-(i-1),k=c-(r-1),d=t.getAttribute("data-blocklistindexreverse"),g=t.getAttribute("data-blocklistcolindexreverse"),nt=t.getAttribute("data-blocklistrowindexreverse");(d!=w||g!=b||nt!=k)&&(o.some(function(n){return n==t})||o.push(t));t.setAttribute("data-blocklistindexreverse",w);t.setAttribute("data-blocklistcolindexreverse",b);t.setAttribute("data-blocklistrowindexreverse",k)}return{initialRun:l,changedLayouts:o}}f.forEach(function(t){for(var f,e=document.querySelectorAll('[id="'+t+'"]'),r=0;r<e.length;r++){var o=e[r],i=o.querySelectorAll('[class^="modulelayout"]'),u=o.querySelectorAll('[id^="blocklistlayout_"]');u.length>0&&(i=Array.prototype.slice.call(i),i=i.filter(function(n){for(var t=0;t<u.length;t++)if(u[t].contains(n))return!1;return!0}));f=n(i);f.changedLayouts.forEach(function(n){var t={trigger:n},i;Tangora.Layout.AddBlocklistIndexArguments(n,t);i=f.initialRun?"OnBlocklistIndexInit":"OnBlocklistIndexChange";$ts.Observer.Broadcast("BlocklistLayout",i,t);$ts.Observer.Broadcast("BlocklistLayout","OnBlocklistIndexInitOrChange",t)})}})}function p(){function l(){Tangora.Layout.AllCssBackgroundsLoaded=!0;$ts.Observer.Broadcast("TangoraPage","OnLoadAllCssBackgrounds")}function a(){s++;s==t.length&&l()}for(var f,i,r,h,c,e,o,s,u,t=[],n=0;n<document.styleSheets.length;n++)if(f=document.styleSheets[n],i=f.cssRules||f.rules,i)for(r=0;r<i.length;r++)try{for(h=i[r].cssText,c=/url\(([^'"][^)]+)\)|url\(['"]?([^'"]+)['"]?\)/g;(e=c.exec(h))!=null;)o=e[1]||e[2],/\.(jpg|jpeg|png|gif)/i.test(o)&&t.push(o)}catch(v){console.log("Error extracting css from following rule:");console.log(i[r])}if(t.length==0){l();return}for(s=0,n=0;n<t.length;n++)u=new Image,u.onerror=a,u.onload=a,u.src=t[n]}function w(){var n,t,i,o,r,s,f,e,a;if((typeof skipShowEmbeddedDetailOnLoad=="undefined"||!skipShowEmbeddedDetailOnLoad)&&(n=location.hash.replace(/^#/,""),n.length!=0)&&(t=$elms('[onclick^="Tangora.Layout.ShowEmbeddedDetailView"]'),t.length!=0)){for(i=0,o=!1,r=0;r<t.length;r++)if(s=t[r],/Tangora.Layout.ShowEmbeddedDetailView\((\d+),(\d+),(\d+),(true|false),'([^\)]+)'\)/.test(s.getAttribute("onclick"))){i=parseInt(RegExp.$1);var u=parseInt(RegExp.$2),c=parseInt(RegExp.$3),l=RegExp.$4=="true",h=RegExp.$5;if(h==n){f=$elm(".detailview-placeholder.record-"+u)||$elm(".detailview-placeholder")||s;e=f.id||"pageloaddetail-"+u;f.id||(f.id=e);$ts.Observer.RegisterOneShot(e,"OnEndScrollTo",function(){Tangora.Layout.ShowEmbeddedDetailView(i,u,c,l,h)});a=Tangora.Layout.ScrollTo(e,{});a||Tangora.Layout.ShowEmbeddedDetailView(i,u,c,l,h);o=!0;break}}o||(location.href=n)}}function s(){if(Tangora.ByPassWebkitBoxIssue)return!1;if(/webkit\/(\d+)/i.test(navigator.userAgent)){var n=parseInt(RegExp.$1,10);if(n==536)return!0}return!1}function y(){var r,i,f,c,e,u,o,n;if(!Tangora.ByPassWebkitBoxIssue&&t.length>0){r=Tangora.Layout;function s(n){for(var i,t,f=r.GetColumnSets(n),u=0;u<f.length;u++)for(i=r.GetColumns(f[u]),t=0;t<i.length;t++)s(i[t]),i[t].style.width=""}function h(n,t){for(var o,f,i,u,s=r.GetColumnSets(n),e=0;e<s.length;e++)for(o=r.GetColumns(s[e]),f=0;f<o.length;f++)i=o[f],h(i,t),(!t||t.some(function(n){return n==i.id||$ts.hasClass(i,n)}))&&(u=0,u+=$ts.safeInt($ts.getComputedStyle(i,"padding-left"))*2,u+=$ts.safeInt($ts.getComputedStyle(i,"padding-right"))*2,u+=$ts.safeInt($ts.getComputedStyle(i,"border-left-width")),u+=$ts.safeInt($ts.getComputedStyle(i,"border-right-width")),u>0&&(i.style.width=i.clientWidth-u+"px"))}for(i=[],n=0;n<t.length;n++)if(f=t[n].id,c=t[n].blocklistMode,c)for(e=$elms("."+f),u=0;u<e.length;u++)i.push({element:e[u],columns:t[n].columns});else o=$elm("#"+f),o&&i.push({element:o,columns:t[n].columns});for(n=0;n<i.length;n++)s(i[n].element);for(n=0;n<i.length;n++)h(i[n].element,i[n].columns)}}var t=[],h=[],i=-1,n=[],c={},u=[],f=[],v=!1,a;this.RegisteredLayouts=[];this.RegisteredLiquidLayouts=[];this.RegisterLayout=function(n,t,i,r){t||(t="Automatic");i||(i=null);r||(r=!1);this.RegisteredLayouts.push({id:n,balanceMode:t,balancedColumns:i,blocklistMode:r})};this.RegisterLiquidLayout=function(i,r,u){var h,e,c,o,l,f;if(u)for(f=0;f<u.length;f++){for(h=!1,e=0;e<n.length;e++)if(n[e]==u[f]){h=!0;break}h||(n.push(u[f]),n.sort(function(n,t){return t-n}))}if(c=parseInt(this.GetIEVersion(),10),o=c>0&&c<8,!o&&document.documentMode&&document.documentMode==7&&(o=!0),o&&this.RegisteredLiquidLayouts.push({id:i,blocklistMode:r}),s()){for(l=!1,f=0;f<t.length;f++)if(t[f].id==i){l=!0;break}l||t.push({id:i,blocklistMode:r})}};this.RegisterListRotator=function(n,t,r){$ts.addEvent(window,"load",function(){$chain('[id="'+n+'"]').each(function(n){var u=n.getAttribute("data-listrotatorid"),f,e,o,s;if(typeof c[u]=="undefined"){if(c[u]=!0,f=t,e=n.getAttribute("data-listrotatordata"),e){o=eval("("+e+")");for(s in o)f[s]=o[s]}t.runInLightbox?Tangora.Layout.BlocklistInLightboxHelper.RegisterRotator(u,f,r):ListRotator(u,f,r).init(i)}})})};this.RegisterIndexedBlocklist=function(n){try{f.indexOf(n)==-1&&f.push(n)}catch(t){}};this.RegisterWebkitBoxSizingBug=function(n,i){if(s()){var r=t.filter(function(t){return t.id==n});r[0].columns=i.split(",")}};this.PreloadCssBackgroundImages=function(){v=!0};this.UnregisterWebkitBoxSizingBug=function(n){s()&&(t=t.filter(function(t){return t.id!=n}))};this.StartupScripts=function(){var t=!window.getSelection,r;if(t&&$ts.addClass(document.body,"ie8"),highlightSearchwords(),Tangora.Layout.Retinize(),r=$ts.getCookie("disablemediaqueries"),r&&r=="true"?(Tangora.Layout.DisableMediaQueries(),e(),o(),$ts.Observer.Broadcast("Tangora.Layout","LoadedNonResponsive")):n.length>0?t?(i=0,e(),o(),$ts.Observer.Broadcast("Tangora.Layout","LoadedNonResponsive")):(Tangora.Layout.CheckMediaQueryChange(),$ts.addEvent(window,"resize",Tangora.Layout.CheckMediaQueryChange)):(i=0,e(),o(),$ts.Observer.Broadcast("Tangora.Layout","LoadedNonResponsive")),!t)try{top.$ts.Observer.Register("List","AfterAutoFetch",Tangora.Layout.RunResponsiveAssist);top.$ts.Observer.Register("OpenPageContent","OpenPageContentShowComplete",Tangora.Layout.RunResponsiveAssist)}catch(s){$ts.Observer.Register("List","AfterAutoFetch",Tangora.Layout.RunResponsiveAssist);$ts.Observer.Register("OpenPageContent","OpenPageContentShowComplete",Tangora.Layout.RunResponsiveAssist)}u.length>0&&(Tangora.Layout.DoCssColumnAssist(),$ts.addEvent(window,"resize",Tangora.Layout.DoCssColumnAssist));Tangora.Layout.TransitionManager.SetAutoTriggers();Tangora.Layout.TransitionManager.SetExclusiveGroups();$ts.Observer.Register("SPA","BeforeLoad",function(){c={}});$ts.Observer.Register("SPA","AnchorNavigation",function(n,t,i){var r=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0);window.scrollTo(0,r);i.targetid?Tangora.Layout.ScrollTo(i.targetid,!0):Tangora.Layout.ScrollTo(i.yposbeforescroll,!0)});$ts.Observer.Broadcast("TangoraPage","OnLoad");f.length>0&&(l(),$ts.addEvent(window,"resize",l));v&&p();location.hash&&w()};this.CheckMediaQueryChange=function(){for(var r=0,t=0;t<n.length;t++)window.matchMedia?window.matchMedia("(max-width: "+n[t]+"px )").matches&&(r=n[t]):document.body.offsetWidth<n[t]&&(r=n[t]);r!=i&&(i=r,Tangora.Layout.RunResponsiveAssist(),$ts.Observer.Broadcast("Tangora.Layout","ResponsiveBreakpoint",{responsivemode:i}))};this.RunResponsiveAssist=function(){e();Tangora.Layout.Retinize();o();l()};this.GetCurrentResponsiveMode=function(){return i};this.Retinize=function(){/tangoralayoutretina=false/i.test(location.href)||Tangora.ByPassRetinaScript||/\/admin\//i.test(location.href)||typeof devicePixelRatio=="undefined"||window.devicePixelRatio<1.5||$chain("img:not([data-ts-retina])").each(function(n){var i,r,t;(n.setAttribute("data-ts-retina","false"),n.getAttribute("srcset"))||n.src.toLowerCase().indexOf(location.hostname.toLowerCase())!=-1&&/\/imagegenerator\/(\d+)x(\d+)\//i.test(n.src)&&(i=RegExp.$1,r=RegExp.$2,$ts.safeInt(n.getAttribute("width"))!=0||$ts.safeInt(n.getAttribute("height"))!=0||/\d/.test(n.style.width)||/\d/.test(n.style.height))&&(n.setAttribute("data-ts-retina","true"),n.src=n.src.replace(/\.(png|jpg|jpeg|gif)/i,"@2x.$1"),t=n.getAttribute("onmouseover"),/\$ts.hover/.test(t)&&/\/imagegenerator\//.test(t)&&(t=t.replace(/\/imagegenerator\/\d+x\d+\//,"/imagegenerator/"+i+"x"+r+"/"),t=t.replace(/\.(png|jpg|jpeg|gif)/i,"@2x.$1"),n.setAttribute("onmouseover",t)))})};this.IE6Patch=function(){for(var i,r,t=document.getElementsByTagName("div"),n=0;n<t.length;n++)i=Tangora.Layout.GetStyle(t[n],"min-height"),r=typeof t[n].style.height!="undefined"&&t[n].style.height!=null&&t[n].style.height.length>0&&t[n].style.height!="auto",i=="auto"||r||(t[n].style.height=Tangora.Layout.GetStyle(t[n],"min-height"),t[n].style.overflowY="visible")};this.IE6Hover=function(){for(var o,s,i,t,f,c,r=document.getElementsByTagName("li"),n=0;n<r.length;n++)r[n].className.indexOf("navigationlistitem")!=-1&&(r[n].onmouseover=function(){this.className+=" ie6hover"},r[n].onmouseout=function(){this.className=this.className.replace(new RegExp(" ie6hover\\b"),"")});var e="",u=document.getElementsByTagName("div"),h=null;for(n=0;n<u.length;n++)if(u[n].className.indexOf("sfnavlevel1")!=-1){e=u[n].className.replace("sfnavlevel1","").replace(/\s/g,"");h=u[n].firstChild;break}if(o=!1,s="150px",e!="")for(n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].href.indexOf(e+"/navigation.css")!=-1){for(i=0;i<document.styleSheets[n].rules.length;i++)document.styleSheets[n].rules[i].selectorText.toLowerCase()=="div.sfnavlevel1 .navigationwrapper"&&/float\s*:\s*left/i.test(document.styleSheets[n].rules[i].style.cssText)&&(o=!0),document.styleSheets[n].rules[i].selectorText.toLowerCase()=="div.sfnavlevel1 li .navigationwrapper"&&/width\s*:\s*(\d*)(%|em|px|pt)/i.test(document.styleSheets[n].rules[i].style.cssText)&&(s=RegExp.$1+RegExp.$2);break}t="";o?(t+="div.sfnavlevel1 .navigationwrapper { clear:none; float:left; width:100%; }\n",t+="div.sfnavlevel1 div.navigationwrapper ul.navigationlist li.navigationlistitem a,\n",t+="div.sfnavlevel1 ul.navigationlist li.navigationlistitem { float:left; width:100%; }\n",t+="div.sfnavlevel1 div.sfnavlevel2 { clear:none; }\n"):(t+="div.sfnavlevel1 .navigationwrapper { clear:both; float:none; width:auto; }\n",t+="div.sfnavlevel1 div.navigationwrapper ul.navigationlist li.navigationlistitem a,",t+="div.sfnavlevel1 ul.navigationlist li.navigationlistitem { float:left; }\n",t+="div.sfnavlevel1 div.sfnavlevel2 ul.navigationlist li.navigationlistitem { width:"+s+"; }\n",t+="div.sfnavlevel1 div.sfnavlevel2 { clear:left; }\n");h&&(f=document.createElement("style"),f.setAttribute("type","text/css"),f.styleSheet.cssText=t,c=document.getElementsByTagName("head")[0],c.appendChild(f))};this.GetIEVersion=function(){var t="0.0",i="0.0",n,r;try{for(n=navigator.userAgent,r=(new Date).getTime();/msie\s\d*\.\d*/gi.test(n);)if(n=n.substr(RegExp.lastIndex),t=RegExp.lastMatch.replace(/[^\d\.]/gi,""),parseInt(t,10)>parseInt(i,10)&&(i=t),(new Date).getTime()-r>100)break}catch(u){}return i};this.Initialize=function(){if(typeof Tangora.Events!="undefined"){Tangora.Events.AddHandler(window,"onload",this.Resize);Tangora.Events.AddHandler(window,"onload",this.StartupScripts);var n=parseInt(this.GetIEVersion(),10);if(n>0&&(n==6&&(Tangora.Events.AddHandler(window,"onload",this.IE6Patch),Tangora.Events.AddHandler(window,"onload",this.IE6Hover)),n<8&&Tangora.Events.AddHandler(window,"onresize",this.ResizeDelay)),Tangora.Browser.GetType(),Tangora.Browser.IE&&Tangora.Browser.Version=="7.0")try{location.href==top.location.href?$ts.addEvent(window,"DOMContentLoaded",function(){$chain("UL.breadcrumb LI").setStyle("display","inline")}):$ts.addEvent(window,"load",function(){$chain("UL.breadcrumb LI").setStyle("display","inline")})}catch(t){$ts.addEvent(window,"load",function(){$chain("UL.breadcrumb LI").setStyle("display","inline")})}s()&&$ts.addEvent(window,"resize",y)}else $ts.addEvent(window,"load",this.Resize),$ts.addEvent(window,"resize",this.Resize)};a=null;this.ResizeDelay=function(){clearTimeout(a);a=setTimeout(Tangora.Layout.Resize,500)};this.Resize=function(){function h(){function s(){for(var i,f,u,n=null,t=0;t<r.length;t++){for(n=r[t],i=0;i<r.length;i++)if(t!=i){for(f=r[i].elm.getElementsByTagName("div"),u=0;u<f.length;u++)if(f[u]==n.elm){n=null;break}if(!n)break}if(n){r.splice(t,1);break}}return n}for(var n,i,e,o,r=[],f=document.getElementsByTagName("div"),u=0;u<t.RegisteredLayouts.length;u++)if(n=t.RegisteredLayouts[u],n.blocklistMode)for(i=0;i<f.length;i++)f[i].className==n.id&&r.push({version:"1.0",elm:f[i],id:n.id,balanceMode:n.balanceMode,balancedColumns:n.balancedColumns,blocklistMode:n.blocklistMode});else r.push({version:"1.0",elm:document.getElementById(n.id),id:n.id,balanceMode:n.balanceMode,balancedColumns:n.balancedColumns,blocklistMode:n.blocklistMode});for(u=0;u<t.RegisteredLiquidLayouts.length;u++)if(n=t.RegisteredLiquidLayouts[u],n.blocklistMode)for(i=0;i<f.length;i++)f[i].className==n.id&&r.push({version:"2.0",elm:f[i],id:n.id,balanceMode:"Automatic",balancedColumns:null,blocklistMode:n.blocklistMode});else{if(!document.getElementById(n.id))continue;r.push({version:"2.0",elm:document.getElementById(n.id),id:n.id,balanceMode:"Automatic",balancedColumns:null,blocklistMode:n.blocklistMode})}for(e=[],o=s();o;)e.push(o),o=s();return e.reverse(),e}var t,s,i,r,o,f,u,n,e;if(!/tangoralayoutresize=false/i.test(location.href)&&!Tangora.ByPassResizeScript){if(t=Tangora.Layout,y(),t.RegisteredLiquidLayouts.length>0)for(s=h(),n=0;n<s.length;n++)i=s[n],i.version=="1.0"?(t.ConvertLiquidLayout(i.elm),t.AdjustColumns(i.elm,i.balanceMode,i.balancedColumns,i.blocklistMode)):i.version=="2.0"&&(t.ConvertLiquidLayout(i.elm),t.AdjustColumns(i.elm,i.balanceMode,i.balancedColumns,i.blocklistMode));else for(n=0;n<t.RegisteredLayouts.length;n++)if(r=t.RegisteredLayouts[n],r.balanceMode!="Manual"||r.balancedColumns!=null)if(r.blocklistMode)for(o=document.getElementsByTagName("div"),f=0;f<o.length;f++)o[f].className==r.id&&t.AdjustColumns(o[f],r.balanceMode,r.balancedColumns,r.blocklistMode);else t.AdjustColumns(document.getElementById(r.id),r.balanceMode,r.balancedColumns,r.blocklistMode);if(Tangora.FixIEPositionAbsoluteBug&&navigator.userAgent.indexOf("MSIE")!=-1)for(u=document.body.getElementsByTagName("*"),n=0;n<u.length;n++)e=t.GetStyle(u[n],"position"),e!=null&&(u[n].style.position="static",e.toLowerCase()=="absolute"?u[n].style.position="absolute":e.toLowerCase()=="relative"?u[n].style.position="relative":e.toLowerCase()=="fixed"&&(u[n].style.position="fixed"))}};this.AdjustColumns=function(n,t,i,r){var f,u;if(n)for(f=this.GetColumnSets(n),u=0;u<f.length;u++)this.EnsureColumnHeights(f[u],t,i,r)};this.GetStyle=function(n,t){if(n.currentStyle)r=n.currentStyle[this.CssCamelCase(t)];else if(document.defaultView&&document.defaultView.getComputedStyle){var i=document.defaultView.getComputedStyle(n,null);i&&(r=i.getPropertyValue(t))}return r};this.EnsureColumnHeights=function(n,t,i,r){function a(n){if(!i)return!1;for(var t=0;t<i.length;t++)if(r||n.id!=i[t]){if(r&&n.className.indexOf(i[t])!=-1)return!0}else return!0;return!1}var u=this.GetColumns(n),o,f,c,h,e,l,s;for(n.style.height=parseInt(this.GetIEVersion(),10)<8&&n.style.height!=""?"auto":"",o=0,f=0;f<u.length;f++)this.AdjustColumns(u[f],t,i,r),c=this.GetStyle(u[f],"font-size"),(navigator.userAgent.indexOf("MSIE 6.0")==-1||this.GetStyle(u[f],"height")=="auto")&&(u[f].style.height=typeof u[f].converted!="undefined"?"auto":c=="0pt"?"0px":""),h=u[f].offsetHeight,h>o&&(o=h);for(e=0;e<u.length;e++)l=this.GetHeightSubtracts(u[e]),s=o-l,s<0&&(s=0),(t!="Manual"||a(u[e]))&&(u[e].style.height=s+"px");n.style.height=o+"px"};this.GetColumnSets=function(n){return this.GetChildNodes(n,"div","layoutcolumnset")};this.GetColumns=function(n){return this.GetChildNodes(n,"div","layoutcolumn")};this.GetChildNodes=function(n,t,i){for(var r,f=[],u=0;u<n.childNodes.length;u++)r=n.childNodes[u],r.nodeType!=3&&r.tagName&&r.tagName.toLowerCase()==t.toLowerCase()&&r.className.indexOf(i)>-1&&r.parentNode==n&&f.push(r);return f};this.GetHeightSubtracts=function(n){return Tangora.Layout.GetSubtracts(n,["border-top-width","border-bottom-width","padding-top","padding-bottom","margin-top","margin-bottom"])};this.GetWidthSubtracts=function(n,t){var i=["border-left-width","border-right-width","padding-left","padding-right","margin-left","margin-right"];return t&&(i=["margin-left","margin-right"]),Tangora.Layout.GetSubtracts(n,i)};this.GetSubtracts=function(n,t){for(var i,e,o,r,u=0,f=0;f<t.length;f++)i=t[f],e=i.indexOf("border")>-1?this.CssCamelCase(i.substr(0,i.lastIndexOf("-"))+"Style"):null,n.currentStyle?(r=e&&n.currentStyle[e]=="none"?0:parseInt(n.currentStyle[this.CssCamelCase(i)]),isNaN(r)||(u+=r)):document.defaultView&&document.defaultView.getComputedStyle&&(o=document.defaultView.getComputedStyle(n,null),o&&(r=parseInt(o.getPropertyValue(i)),isNaN(r)||(u+=r)));return u};this.CssCamelCase=function(n){for(var t,i="",r=!1,u=0;u<n.length;u++)t=n.substr(u,1),t=="-"?r=!0:r?(i+=t.toUpperCase(),r=!1):i+=t;return i};this.SetBrowserSpecificStylesheet=function(n,t,i){function e(n,t,i){var r=parseFloat(n),u=parseFloat(t);switch(i){case"equal":return r==u;case"not_equal":return r!=u;case"less_than":return r<u;case"greater_than":return r>u;case"less_than_or_equal":return r<=u;case"greater_than_or_equal":return r>=u}}for(var s,h,c,l,a,u=!1,o=0;o<t.length;o++){var r=t[o],f=navigator.userAgent;if(r.Browser)switch(r.Browser){case"Internet Explorer":/msie\s(\d+\.\d)/i.test(f)?u=r.Version=="all"?!0:e(RegExp.$1,r.Version,r.Operator):/trident\/(\d+\.\d+)/i.test(f)&&(r.Version=="all"?u=!0:(s=RegExp.$1,h=s=="7.0"?"11.0":"0.0",u=e(h,r.Version,r.Operator)));break;case"FireFox":/firefox\/(\d+\.\d)/i.test(f)&&(u=r.Version=="all"?!0:e(RegExp.$1,r.Version,r.Operator));break;case"Safari":/safari/i.test(f)&&!/chrome/i.test(f)&&(u=r.Version=="all"?!0:/version\/(\d+\.\d)/i.test(f)?e(RegExp.$1,r.Version,r.Operator):e("2.0",r.Version,r.Operator));break;case"Chrome":/chrome\/(\d+\.\d)/i.test(f)&&(u=r.Version=="all"?!0:e(RegExp.$1,r.Version,r.Operator));break;case"Opera":/opera/i.test(f)&&(r.Version=="all"?u=!0:/version\/(\d+\.\d)/i.test(f)?u=e(RegExp.$1,r.Version,r.Operator):/opera\/(\d+\.\d)/i.test(f)&&(u=e(RegExp.$1,r.Version,r.Operator)))}else r.Regex&&(c=new RegExp(r.Regex,"gi"),u=c.test(f));if(!u&&i=="and")break;if(u&&i=="or")break}u&&(l=$ts.createElement("link",{rel:"stylesheet",type:"text/css",href:n}),a=document.getElementsByTagName("head")[0],a.appendChild(l))};this.ConvertLiquidLayout=function(n){function s(n){for(var r,c,f,i,e,u,l=t.GetColumnSets(n),h=0;h<l.length;h++){for(r=l[h],r.style.display="block",r.style.clear="both",r.style.width="auto",c=t.GetColumns(r),f=0;f<c.length;f++)i=c[f],$ts.getComputedStyle(i,"display").toLowerCase()!="none"&&(i.style.display="block"),i.style.overflow="hidden",i.style.styleFloat="left",o+=t.GetWidthSubtracts(i),e=t.GetStyle(i,"height"),e=/^(\d+)px$/i.test(e)?Math.max(0,parseInt(RegExp.$1,10)-t.GetHeightSubtracts(i))+"px":"auto",i.style.height=e,i.style.minHeight=Math.max(0,i.offsetHeight-t.GetHeightSubtracts(i))+"px",i.converted=!0,s(i);u=t.GetChildNodes(r,"div","layoutfloatbreaker")[0];u&&(u.style.display="block",u.style.clear="both",u.style.width="auto")}}for(var t,o,r,i,f,c,e=!1,u=0;u<h.length;u++)if(h[u]==n){e=!0;break}if(!e){if(h.push(n),t=Tangora.Layout,o=0,s(n),r=t.GetStyle(n,"width"),r.indexOf("%")!=-1?n.orgpct=parseInt(r,10):/px/i.test(r)&&!/px/i.test(n.style.width)&&(n.style.width=parseInt(r,10)-(parseInt(t.GetStyle(n,"padding-left"),10)+parseInt(t.GetStyle(n,"padding-right")))+"px"),typeof n.orgpct!="undefined"){for(i=n.parentNode;i!=null&&i.offsetWidth==0;)i=i.parentNode;f=parseInt(t.GetStyle(n,"padding-left"),10)+parseInt(t.GetStyle(n,"padding-right"));i&&(f+=parseInt(t.GetStyle(i,"padding-left"),10)+parseInt(t.GetStyle(i,"padding-right")));c=i.offsetWidth*(n.orgpct/100);n.style.width=Math.max(0,c-f)+"px"}t.ConvertLiquidColumns(n)}};this.ConvertLiquidColumns=function(n){for(var f,r,e,o,t,l,i,u=Tangora.Layout,a=u.GetColumnSets(n),h=0;h<a.length;h++){for(f=a[h],r=u.GetColumns(f),f.style.width=n.style.width,i=0;i<r.length;i++)t=r[i],e=u.GetStyle(t,"width"),e.indexOf("%")!=-1&&(t.orgpct=parseInt(e,10));var v=0,y=0,s=[],c=0;for(i=0;i<r.length;i++)if(t=r[i],typeof t.orgpct!="undefined")y+=t.orgpct,s.push(t);else{if($ts.getComputedStyle(t,"display").toLowerCase()=="none"){c+=parseInt($ts.getComputedStyle(t,"width"),10);continue}e=parseInt(u.GetStyle(t,"width"),10);v+=e;t.style.width=Math.max(0,e-u.GetWidthSubtracts(t))+"px"}if(c)for(i=0;i<r.length;i++)if(t=r[i],$ts.getComputedStyle(t,"display").toLowerCase()!="none"&&typeof t.orgpct=="undefined"){t.style.width=parseInt(t.style.width,10)+c+"px";break}o=parseInt(f.style.width,10);isNaN(o)&&(o=f.clientWidth);isNaN(o)&&(o=f.offsetWidth);var p=o-v,b=p/y,w=0;for(i=0;i<s.length;i++)t=s[i],l=Math.round(t.orgpct*b),i<s.length-1?(t.style.width=Math.max(0,l-u.GetWidthSubtracts(t))+"px",w+=l):t.style.width=Math.max(0,p-w-u.GetWidthSubtracts(t))+"px";for(i=0;i<r.length;i++)u.ConvertLiquidColumns(r[i])}};this.GetResponsiveMode=function(){return i};this.DisableMediaQueries=function(){for(var r,u,t,f,n,i=0;i<document.styleSheets.length;i++){for(r=[],u=document.styleSheets[i],n=u.cssRules.length-1;n>=0;n--)if(t=u.cssRules[n],/cssmediarule/i.test(t.toString())){if(t.media.mediaText.indexOf("min-width")!=-1&&t.media.mediaText.indexOf("max-width")==-1)for(f=t.cssRules.length-1;f>=0;f--)r.push(t.cssRules[f].cssText);t.parentStyleSheet.deleteRule(n)}for(n=0;n<r.length;n++)u.insertRule(r[n],0)}$ts.setCookie("disablemediaqueries","true");$ts.Observer.Broadcast("Tangora.Layout","MediaQueriesDisabled")};this.RegisterDropdownNavigations=function(n){function t(t){$chain(n).each(function(r){var o=$elm("#"+r.id+"_dropdownnavigation"),e,u,f;if((o&&o.parentNode.removeChild(o),r["mode"+t])&&(e=$elm(r.id),e)){for(u=e.parentNode;u&&u.nodeType==1;){for(f=0;f<n.length;f++)if(n[f].id!=e.id&&n[f].id==u.id&&n[f]["mode"+t])return;u=u.parentNode}i(e,t)}})}function i(n){function u(n,t){$chain(n).each(function(n){var o,f,e;$ts.getComputedStyle(n,"display")!="none"&&(o=$elm("a > span",n).innerHTML,f=$elm("a",n).getAttribute("href"),i.push({name:o,value:f,depth:t}),/activeitem/.test(n.className)&&(r=f),e=$elms("#"+n.getAttribute("id")+" > div > div.navigationwrapper > ul.navigationlist > li.navigationlistitem"),e.length>0&&u(e,t+1))})}var i=[],r="",f=$elms("#"+n.id+" > div.navigationwrapper > ul.navigationlist > li.navigationlistitem"),t;u(f,0);t=$ts.createElement("select",{id:n.id+"_dropdownnavigation"});t.onchange=function(){location.href=t.value};$chain(i).each(function(n){for(var i,r="",u=0;u<n.depth;u++)r+="&nbsp;&nbsp;&nbsp;";i=$ts.createElement("option",{innerHTML:r+n.name,value:n.value,title:n.value});n.selected&&(i.selected=!0);t.appendChild(i)});t.value=r;n.parentNode.insertBefore(t,n)}$ts.Observer.Register("Tangora.Layout","ResponsiveBreakpoint",function(n,i,r){t(r.responsivemode)});$ts.Observer.Register("Tangora.Layout","LoadedNonResponsive",function(){t(0)})};this.RegisterCollapsableNavigations=function(t){function i(i){function r(n,t){n.style.transition=t}function u(n,t){function i(){$ts.removeEvent(n,"transitionend",i);$ts.removeEvent(n,"oTransitionEnd",i);$ts.removeEvent(n,"mozTransitionEnd",i);$ts.removeEvent(n,"webkitTransitionEnd",i);t()}$ts.addEvent(n,"transitionend",i);$ts.addEvent(n,"oTransitionEnd",i);$ts.addEvent(n,"mozTransitionEnd",i);$ts.addEvent(n,"webkitTransitionEnd",i)}window.getSelection&&$chain(t).each(function(t){var o,f,e;if(typeof t["mode"+i]!="undefined"){if(!t["mode"+i])return}else{for(o=t.mode0,f=0;f<n.length;f++)if(n[f]>=i)typeof t["mode"+n[f]]!="undefined"&&(o=t["mode"+n[f]]);else break;if(!o)return}(e=$elms('[id="'+t.id+'"]'),e.length==0&&(e=$elms('[data-tsnavid="'+t.id+'"]')),e.length!=0)&&$chain(e).each(function(n){var a,s,h,t,f,e,c,v,l,o;if($ts.isTouchDevice()){if(!/([A-Z0-9]{10,})/.test(n.className))throw new Error("WTF...");for(a=RegExp.$1,s=0;s<document.styleSheets.length;s++){var i=document.styleSheets[s],y=(location.origin||location.protocol+"//"+location.hostname).toLowerCase(),p=i.href&&i.href.toLowerCase().indexOf(y)!=0;if(!p&&i.cssRules)for(h=i.cssRules.length-1;h>=0;h--)if(t=i.cssRules[h],t.type==CSSRule.MEDIA_RULE){if(!window.matchMedia(t.media.mediaText).matches)continue;for(f=0;f<t.cssRules.length;f++)if((e=t.cssRules[f],e.type==CSSRule.STYLE_RULE)&&e.selectorText.indexOf(a)!=-1&&e.selectorText.indexOf(":hover")!=-1){for(c=[],v=e.selectorText.split(","),l=0;l<v.length;l++)o=v[l],/^\s*$/.test(o)||o.indexOf(a)!=-1&&o.indexOf(":hover")!=-1||c.push(o);c.length==0?t.deleteRule(f):t.selectorText=c.join(",")}}}}$chain(".navigationlistitem.activeitem",n).each(function(t){if(($elms("li.activeitem",t).length!=0||Tangora.Layout.ExpandActiveItemSubmenu&&$elms("a.activelink + div > .navigationwrapper",t))&&!$ts.hasClass(t,"expanded")){var i=$elm("#"+t.id+" > div",n);i&&($ts.addClass(t,"killtransitions"),$ts.addClass(t,"expanded"),r(i,"none"),i.style.height="auto",setTimeout(function(){$ts.removeClass(t,"killtransitions")}))}});$chain(".navigationlistitem > a:first-child:nth-last-child(2)",n).each(function(t){var f,s,e,o,i;if($ts.removeClass(t,"nosubitems"),f=t.parentNode,s=$elm("#"+f.id+" > div",n),s){for(e=!1,o=$elms("#"+f.id+" > div > div > ul > li",n),i=0;i<o.length;i++)if($ts.getComputedStyle(o[i],"display")!="none"){e=!0;break}e||$ts.addClass(t,"nosubitems")}t.onmousedown=function(n){var i="data-collapsable-navigation-action";t.removeAttribute(i);n.target!=t&&(t.getAttribute("data-pagetype")!="link"||Tangora.NavigateOnLinkPages)||(t.setAttribute(i,"true"),t.onmouseup=function(){setTimeout(function(){t.removeAttribute(i)},0)})};t.onclick=function(i){var e,f,o;return i.target!=t&&location.href!=t.href&&(t.getAttribute("data-pagetype")!="link"||Tangora.NavigateOnLinkPages)?!0:(e=t.parentNode,f=$elm("#"+e.id+" > div",n),e.getAttribute("data-busy")=="true")?!1:(e.setAttribute("data-busy","true"),$ts.hasClass(e,"expanded")?(f.style.height=f.offsetHeight+"px",$ts.removeClass(e,"expanded"),setTimeout(function(){r(f,"");$ts.removeClass(e,"expanded");f.style.height=""},50),u(f,function(){e.removeAttribute("data-busy")})):(f.style.height="auto",o=f.offsetHeight,f.style.height="",setTimeout(function(){$ts.addClass(e,"expanded");f.style.height=o+"px"},50),u(f,function(){r(f,"none");f.style.height="auto";e.removeAttribute("data-busy")})),!1)}})})})}$ts.Observer.Register("Tangora.Layout","ResponsiveBreakpoint",function(n,t,r){i(r.responsivemode)});$ts.Observer.Register("Tangora.Layout","LoadedNonResponsive",function(){i(0)})};this.RegisterSuckerfishFadeAssists=function(n){function i(){var n=$elm(".sfnavlevel2 .navigationwrapper",this);n&&(n.style.left="auto")}function t(n){n.target.style.left=""}function r(r){Tangora.Layout.TransitionManager.SupportsTransitions()&&$chain(n).each(function(n){var u=$elm(n.id);u&&$chain("#"+n.id+".sfnavlevel1 .navigationlistitem").each(function(u){var f=$elm(".sfnavlevel2 .navigationwrapper",u);f&&(n["mode"+r]?($ts.addEvent(f,"transitionend",t),$ts.addEvent(f,"oTransitionEnd",t),$ts.addEvent(f,"mozTransitionEnd",t),$ts.addEvent(f,"webkitTransitionEnd",t),$ts.addEvent(u,"mouseout",i)):($ts.removeEvent(f,"transitionend",t),$ts.removeEvent(f,"oTransitionEnd",t),$ts.removeEvent(f,"mozTransitionEnd",t),$ts.removeEvent(f,"webkitTransitionEnd",t),$ts.removeEvent(u,"mouseout",i)))})})}$ts.isTouchDevice()||($ts.Observer.Register("Tangora.Layout","ResponsiveBreakpoint",function(n,t,i){r(i.responsivemode)}),$ts.Observer.Register("Tangora.Layout","LoadedNonResponsive",function(){r(0)}))};this.RegisterSuckerfishSlideAssists=function(n){function i(){var n=$elm(".sfnavlevel2 .navigationwrapper",this);n&&(n.style.height=n.getAttribute("data-height"))}function r(){var n=$elm(".sfnavlevel2 .navigationwrapper",this),t;n&&(t=n.style.left,n.style.left="",setTimeout(function(){var i=$ts.getComputedStyle(n,"left");(n.style.left=t,/^\-\d/.test(i))&&(n.style.overflow="hidden",n.style.left="auto",n.style.height="0px")},1))}function t(n){n.target.style.left="";n.target.style.overflow=n.target.style.height=="0px"?"hidden":""}function u(u){Tangora.Layout.TransitionManager.SupportsTransitions()&&$chain(n).each(function(n){var f=$elm(n.id);f&&$chain("#"+n.id+".sfnavlevel1 .navigationlistitem").each(function(f){var e=$elm(".sfnavlevel2 .navigationwrapper",f),o;e&&(n["mode"+u]?(e.style.height="auto",e.setAttribute("data-height",e.clientHeight+"px"),e.style.height="0px",e.style.overflow="hidden",$ts.addEvent(e,"transitionend",t),$ts.addEvent(e,"oTransitionEnd",t),$ts.addEvent(e,"mozTransitionEnd",t),$ts.addEvent(e,"webkitTransitionEnd",t),$ts.addEvent(f,"mouseover",i),$ts.addEvent(f,"mouseout",r)):(o=e.getAttribute("data-height"),o&&/\d/.test(o)&&(e.removeAttribute("data-height"),e.style.height="",e.style.overflow="",e.style.left=""),$ts.removeEvent(e,"transitionend",t),$ts.removeEvent(e,"oTransitionEnd",t),$ts.removeEvent(e,"mozTransitionEnd",t),$ts.removeEvent(e,"webkitTransitionEnd",t),$ts.removeEvent(f,"mouseover",i),$ts.removeEvent(f,"mouseout",r)))})})}$ts.isTouchDevice()||($ts.Observer.Register("Tangora.Layout","ResponsiveBreakpoint",function(n,t,i){u(i.responsivemode)}),$ts.Observer.Register("Tangora.Layout","LoadedNonResponsive",function(){u(0)}))};this.RegisterSuckerfishTouchAssists=function(n){function r(i){t=[];$chain(n).each(function(n){var r=$elm(n.id);r&&$chain('.navigationlistitem > a + div[class*="sfnavlevel"] > .navigationwrapper',r).each(function(r){for(var u=r.parentNode.previousSibling,e,f;u&&u.nodeType!=1;)u=u.previousSibling;u&&(n["mode"+i]?(f=u.getAttribute("href"),f&&f!="#"&&u.setAttribute("data-href",f),u.setAttribute("href","#"),t.push({a:u,submenu:r})):(e=u.getAttribute("data-href"),e&&u.setAttribute("href",u.getAttribute("data-href"))))})})}function u(n){for(var i=n.offsetLeft,t=n.offsetParent;t;){if(t.nodeType!=1)break;if($ts.getComputedStyle(t,"position")!="static")break;i+=t.offsetLeft;t=t.offsetParent}return i}function f(n){function i(t){if(!n)return!1;for(var i=n.parentNode;i;){if(i==t)return!0;i=i.parentNode}return!1}t.forEach(function(n){i(n.submenu)||(n.submenu.style.left="")})}function s(n){for(var i=n.target,o,r,e,s;i&&i.nodeType==1&&i.tagName.toLowerCase()!="a";)i=i.parentNode;if(o=t.filter(function(n){return n.a==i}),r=o.length>0?o[0]:null,r){if(e=u(r.a),/sfnavlevel(\d+)/.test(r.submenu.parentNode.className)&&$ts.safeInt(RegExp.$1)>2&&(e+=r.a.offsetWidth),s="data-collapsable-navigation-action",n.target.removeAttribute(s),r.submenu.offsetLeft<0)return f(r.submenu),r.submenu.style.left=e+"px",n.target.setAttribute(s,"true"),$ts.cancelBubble(n),!1;if(u(r.submenu)==e)return location.href=r.a.getAttribute("data-href"),$ts.cancelBubble(n),!1}else i&&i.nodeType==1&&i.tagName.toLowerCase()=="a"&&/navigationlistitem/.test(i.parentNode.className)||f()}var o=$ts.isTouchDevice(),i,t,e;o&&((i=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),i)||(t=null,e="ontouchstart"in document.documentElement?"touchstart":"pointerdown",$ts.addEvent(document,e,s),$ts.Observer.Register("Tangora.Layout","ResponsiveBreakpoint",function(n,t,i){r(i.responsivemode)}),$ts.Observer.Register("Tangora.Layout","LoadedNonResponsive",function(){r(0)})))};this.RegisterCssColumnAssist=function(n){for(var t=0;t<u.length;t++)if(u[t]==n)break;u.push(n)};this.DoCssColumnAssist=function(){function r(n,t){function e(){for(var u,f=n.offsetLeft+n.offsetWidth,r=0,i=0;i<t.length;i++)u=t[i].offsetLeft+t[i].offsetWidth,u>r&&(r=u);return r-f}function o(){for(var u,f=n.offsetTop+n.offsetHeight,r=0,i=0;i<t.length;i++)u=t[i].offsetTop+t[i].offsetHeight,u>r&&(r=u);return r-f}function c(){var t=e();return t<0?(i&&console.log("FIX: Horizontal -> A column without content was detected - changing container height from "+n.style.height+" to "+(n.offsetHeight-1)+"px."),n.style.height=n.offsetHeight-1+"px",!0):t>0?(i&&console.log("FIX: Horizontal -> Missing content was detected - changing container height from "+n.style.height+" to "+(n.offsetHeight+1)+"px."),n.style.height=n.offsetHeight+1+"px",!0):(i&&console.log("Found no horizontal problems..."),!1)}function l(){var t=o();return t<0?(i&&console.log("FIX: Vertical -> Changing container height from "+n.offsetHeight+" to "+(n.offsetHeight+t)+" to make it fit its content."),n.style.height=n.offsetHeight+t+"px",!0):(i&&console.log("Found no vertical problems..."),!1)}function a(){var s=0,l=20,f=0,h=16384,t=null,c,r,u;do{if(s++,s>l){i&&console.log("! Breaking after reached maximum number ("+l+") of allowed attempts in binaryGuessFallback()!");c=10;t&&t.space<=c?(n.style.height=t.value+"px",i&&console.log("Meh! Setting the height to "+t.value+"px. This leaves the continer with "+t.space+"px of empty space at the bottom. This is the best we can do and within the "+c+"px tolerance...")):(n.style.height="",i&&console.log("No container height is set - the CssColumnAssist script could not fix the issue :-("));break}if(r=f+Math.ceil((h-f)/2),n.style.height=r+"px",overflowH=e(),overflowH>0)f=r;else if(overflowH<0)h=r;else if(overflowH==0)if(u=o(),u>0)f=r;else if(u<0)h=r,(!t||t.space>Math.abs(u))&&(t={value:r,space:Math.abs(u)});else if(u==0){i&&console.log("Fixed! Resolved the issue via binary search guessing in "+s+" attempts");break}}while(1)}var u="",r=0,f=4,i=Tangora.Layout.CssColumnAssistDebug,s,h;do{if(n.style.height=u,s=l(),h=c(),!s&&!h){i&&console.log(r==0?"No issue to resolve...":"Resolved issue after "+r+" attempts!");break}if(r++,r>f){i&&console.log("Maximum number of attempts reached ("+f+"). Trying to resolve via binary guessing...");n.style.height="";a();break}u=n.style.height;i&&console.log("* Attempt "+r+", containerHeight is now "+u+"...")}while(1);i&&console.log("Leaving the fixIt function. Container height is "+(n.style.height||"auto")+".");i&&console.log("-------------------------------------------------------------------------------------------")}var n,t,i;if(location.href.indexOf("nocsscolumnassist=true")==-1&&!Tangora.Layout.NoCssColumnAssist)for(n=0;n<u.length;n++)t=$elm("#"+u[n]),i=$elms("#"+u[n]+" > div"),r(t,i)};this.ScrollTo=function(n,t){function v(){var n=(new Date).getTime()-w,y;if(n>=h){if(window.scrollTo(0,c+r),!u&&!t){var f=l(),e=i||"",p={targetid:e,yposbeforescroll:a,yposafterscroll:f},o=null,s=null;/scroll\(([^\)]*)\)/.test(location.hash||"")||(o=location.href,s={targetid:"",yposbeforescroll:a,yposafterscroll:f});$spa.registerAnchor("#scroll("+e+")",p,o,s)}i&&$ts.Observer.Broadcast(i,"OnEndScrollTo")}else y=b(n,c,r,h),window.scrollTo(0,y),window.requestAnimationFrame(v)}var i=n&&isNaN(n)?n:null,u=n&&!isNaN(n)?n:null,e;if(typeof pageYOffset=="undefined"){i?($ts.Observer.Broadcast(i,"OnBeginScrollTo"),setTimeout(function(){location.href="#"+i;$ts.Observer.Broadcast(i,"OnEndScrollTo")},100)):u&&window.scrollTo(0,u);return}var r=0,f=document.documentElement,o=document.body,y=Math.max(o.scrollHeight,o.offsetHeight,f.scrollHeight,f.offsetHeight,f.clientHeight),p=Math.max(f.clientHeight,window.innerHeight),s=y-p;if(i?(e=document.getElementById(i),e&&(r=e.getBoundingClientRect().top,r<0?Math.abs(r)>pageYOffset&&(r=-pageYOffset):r>0&&pageYOffset+r>s&&(r=s-pageYOffset))):r=u?u-pageYOffset:-pageYOffset,r==0)return!1;var h=Tangora.Layout.ScrollDuration||800,w=(new Date).getTime(),c=pageYOffset,b=function(n,t,i,r){return(n/=r/2)<1?i/2*n*n*n*n*n+t:i/2*((n-=2)*n*n*n*n+2)+t},l=function(){return(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)},a=l();return i&&$ts.Observer.Broadcast(i,"OnBeginScrollTo"),window.requestAnimationFrame(v),!1};this.HandleTextContentCondition=function(n,t,i,r){function u(n){var u=!1,f=(n.textContent||n.innerText||"").trim(),e,o;switch(t){case"nullvalue":u=!f||f.length==0;break;case"stringequals":u=f.toLowerCase()==i.toLowerCase();break;case"stringnotequals":u=f.toLowerCase()!=i.toLowerCase();break;case"stringcontains":u=f.toLowerCase().indexOf(i.toLowerCase())!=-1;break;case"stringnotcontains":u=f.toLowerCase().indexOf(i.toLowerCase())==-1;break;case"stringregex":e=i.toLowerCase();o=new RegExp(e,"i");u=o.test(f.toLowerCase())}r({trigger:n,conditionIsTrue:u})}var o=/layoutbox\d+/.test(n),f=o?n:n+" > .vdcontent",e=$elm("#"+f);e?u(e):$chain("."+f).each(function(n){u(n)})};this.AddBlocklistIndexArguments=function(n,t){for(var i=n;i;){if(/(^|\s)modulelayout-?\d+/.test(i.className)){t.blocklistIndex=$ts.safeInt(i.getAttribute("data-blocklistindex"));t.blocklistColIndex=$ts.safeInt(i.getAttribute("data-blocklistcolindex"));t.blocklistRowIndex=$ts.safeInt(i.getAttribute("data-blocklistrowindex"));t.blocklistIndexReverse=$ts.safeInt(i.getAttribute("data-blocklistindexreverse"));t.blocklistColIndexReverse=$ts.safeInt(i.getAttribute("data-blocklistcolindexreverse"));t.blocklistRowIndexReverse=$ts.safeInt(i.getAttribute("data-blocklistrowindexreverse"));t.blocklistColParity=i.getAttribute("data-blocklistcolparity")||"";t.blocklistRowParity=i.getAttribute("data-blocklistrowparity")||"";return}i=i.parentNode}};this.ShowEmbeddedDetailView=function(n,t,i,r,u){function e(n,t,i,r,u){function s(n,t){for(var r,u=document.querySelectorAll(t+'[data-refsource="detailloader"]'),i=0;i<u.length;i++)u[i].parentNode.removeChild(u[i]);for(i=0;i<n.length;i++)if(n[i]&&!new RegExp(n[i],"i").test(document.head.innerHTML)){if(r=document.createElement(t),r.setAttribute("data-refsource","detailloader"),t=="script")r.setAttribute("src",n[i]);else if(t=="link")r.setAttribute("href",n[i]),r.setAttribute("rel","stylesheet");else throw new Error("tagname not supported");document.head.appendChild(r)}}function h(n,t){var r=document.querySelector(t+'[data-blocksource="detailloader"]'),i;r&&r.parentNode.removeChild(r);i=document.createElement(t);i.setAttribute("data-blocksource","detailloader");i.appendChild(document.createTextNode(n));document.head.appendChild(i)}function l(n,t,i){for(var u=document.querySelectorAll(".detailview-placeholder"),r=0;r<u.length;r++)u[r].innerHTML="",u[r].removeAttribute("data-recordid");t.innerHTML=n;t.setAttribute("data-recordid",i)}function a(n){if(n.state)Tangora.Layout.ShowEmbeddedDetailView(n.state.pageId,n.state.recordId,n.state.delay,!1,n.state.detailLink);else{var t=document.querySelector(".detailview-placeholder:not(:empty)");$ts.Observer.Broadcast("TangoraPage","OnEmbeddedDetailViewUnload",{trigger:t})}}var f=document.querySelector(".detailview-placeholder.record-"+t),c=document.querySelector('.detailview-placeholder:not([class*="record-"])'),e=f||c,o;if(!e)throw new Error("Placeholder for embedded detail-view not found.");r&&(window.onpopstate=a);$ts.Observer.Broadcast("TangoraPage","OnEmbeddedDetailViewRequested",{trigger:f});o=(new Date).getTime()+(i||0);$ts.ajax({url:"displaypage.ashx?id="+n+"&pagetemplatebypass=1&recordid"+n+"="+t+"&rndkey="+(new Date).getTime(),async:!0,complete:function(i,c){var a=Math.max(o-(new Date).getTime(),1);setTimeout(function(){var i=c.split("x#x|x#x");s(i[0].split("#|#|#"),"script");s(i[2].split("#|#|#"),"link");h(i[3],"style");l(i[4],e,t);h(i[1],"script");Tangora.Layout.RunResponsiveAssist();$ts.Observer.Broadcast("TangoraPage","OnEmbeddedDetailViewLoad",{trigger:f});r&&history.pushState({pageId:n,recordId:t,delay:a,detailLink:u},null,"#"+u)},a)}})}var f=document.querySelector(".detailview-placeholder[data-recordid]");if(f){if(f.getAttribute("data-recordid")==t){$ts.Observer.Broadcast("TangoraPage","OnEmbeddedDetailViewLoad",{trigger:f});return}$ts.Observer.Broadcast("TangoraPage","OnEmbeddedDetailViewUnload",{trigger:f});e(n,t,i,r,u)}else e(n,t,0,r,u)};this.Initialize();parseInt(this.GetIEVersion(),10)<=8&&($ts.createElement("address"),$ts.createElement("article"),$ts.createElement("aside"),$ts.createElement("footer"),$ts.createElement("header"),$ts.createElement("nav"),$ts.createElement("section"))}function TransitionManager(){function h(t,r,u){var e,l,h,w,f;if(!c()){b(t,r);return}e=t.getAttribute("data-ts-transitiontype");e||(Tangora.Layout.RunResponsiveAssist(),e=t.getAttribute("data-ts-transitiontype"));l=t.getAttribute("data-ts-transitionstate");switch(e){case"pushtopdown":if(r&&r==l)return;o(t,"");h=nt(g(v(t)));o(t,"0ms");y(t);w=setTimeout(function(){h>0&&(n=n.filter(function(n){return n.target!=t}));var i=d(t,l);i&&k(t,i.trigger,i.completeHandler)},h);h>0&&n.push({target:t,timer:w});break;case"fade":case"userdefined":var a=!1,tt=!1,p=t.getAttribute("data-ts-transitiongroup");if(p)for(f=0;f<i.length;f++)if(i[f].id==p){a=i[f].exclusive;tt=i[f].alwaysactive;break}if(a&&tt&&t.getAttribute("data-ts-transitionstate")=="state2")return;s(t,r,u);a&&t.getAttribute("data-ts-transitionstate")=="state2"&&$chain('[data-ts-transitiongroup="'+p+'"]').each(function(n){n!=t&&n.getAttribute("data-ts-transitionstate")=="state2"&&s(n,"state1")})}}function c(){var i=$ts.createElement("div").style,t,n;if(typeof i.transition!="undefined")return!0;for(t=["OTransition","MozTransition","WebkitTransition"],n=0;n<t.length;n++)if(typeof i[t[n]]!="undefined")return!0;return!1}function b(n,t){s(n,t)}function k(n,t,i){function r(){$ts.removeEvent(n,"transitionend",r);$ts.removeEvent(n,"oTransitionEnd",r);$ts.removeEvent(n,"mozTransitionEnd",r);$ts.removeEvent(n,"webkitTransitionEnd",r);s(n);i&&(u(n),i(),setTimeout(function(){f(n)},0));p(n)}y(n);$ts.addEvent(n,"transitionend",r);$ts.addEvent(n,"oTransitionEnd",r);$ts.addEvent(n,"mozTransitionEnd",r);$ts.addEvent(n,"webkitTransitionEnd",r);t()}function d(n,t){function e(t){if(!/^\s*$/.test(n.id)&&$elm("#"+n.id))$ts.Observer.Broadcast(n.id,t,{trigger:n});else{var i=n.className.split(" ");$chain(i).each(function(i){var r=i.replace(/\s*/g,"");$ts.Observer.Broadcast(r,t,{trigger:n})})}}var o=null,s=null,i,r;u(n);var h=n.getAttribute("data-ts-transitiontype"),t=n.getAttribute("data-ts-transitionstate"),c=$ts.hasClass(n,"layoutbox");return n.removeAttribute("data-ts-transitiontype"),n.removeAttribute("data-ts-transitionstate"),i={borderTopWidth:$ts.safeInt($ts.getComputedStyle(n,"border-top-width"))+"px",borderBottomWidth:$ts.safeInt($ts.getComputedStyle(n,"border-bottom-width"))+"px",paddingTop:$ts.safeInt($ts.getComputedStyle(n,"padding-top"))+"px",paddingBottom:$ts.safeInt($ts.getComputedStyle(n,"padding-bottom"))+"px",height:(n.offsetHeight||.1)+"px"},n.setAttribute("data-ts-transitiontype",h),n.setAttribute("data-ts-transitionstate",t),r="",r+=$ts.getComputedStyle(n,"border-top-width"),r+=$ts.getComputedStyle(n,"border-bottom-width"),r+=$ts.getComputedStyle(n,"padding-top"),r+=$ts.getComputedStyle(n,"padding-bottom"),r+=n.offsetHeight,f(n),t=="state1"?(o=function(){n.style.borderTopWidth=i.borderTopWidth;n.style.borderBottomWidth=i.borderBottomWidth;n.style.paddingTop=i.paddingTop;n.style.paddingBottom=i.paddingBottom;n.style.height=i.height;e("TransitionState2Begin")},s=function(){n.style.borderTopWidth="";n.style.borderBottomWidth="";n.style.paddingTop="";n.style.paddingBottom="";n.style.minHeight="";n.style.height="";e("TransitionState2End")}):t=="state2"&&(o=function(){u(n);n.style.borderTopWidth=i.borderTopWidth;n.style.borderBottomWidth=i.borderBottomWidth;n.style.paddingTop=i.paddingTop;n.style.paddingBottom=i.paddingBottom;n.style.height=i.height;setTimeout(function(){f(n);n.style.borderTopWidth="0px";n.style.borderBottomWidth="0px";n.style.paddingTop="0px";n.style.paddingBottom="0px";n.style.minHeight="0px";n.style.height="0px";e("TransitionState1Begin")},0)},s=function(){n.style.borderTopWidth="";n.style.borderBottomWidth="";n.style.paddingTop="";n.style.paddingBottom="";n.style.minHeight="";n.style.height="";e("TransitionState1End")}),{trigger:o,completeHandler:s}}function u(n){e(n,"0s")}function f(n){e(n,"")}function e(n,t){n.style.transitionDuration=t;var i=$ts.getComputedStyle(n,"transition-duration")}function o(n,t){n.style.transitionDelay=t;var i=$ts.getComputedStyle(n,"transition-delay")}function l(n,t){n.style.transitionTimingFunction=t;var i=$ts.getComputedStyle(n,"transition-timing-function")}function a(n){var t=null;return t||(t=$ts.getComputedStyle(n,"transition-duration")),t}function v(n){var t=null;return t||(t=$ts.getComputedStyle(n,"transition-delay")),t}function g(n){if(n&&n.indexOf(",")!=-1){var t=[],i=n.split(",");$chain(i).each(function(n){for(var r=$ts.trim(n),u=!1,i=0;i<t.length;i++)if(t[i]==r){u=!0;break}u||t.push(r)});t.length==1&&(n=t[0])}return n}function nt(n){if(/([\d+\.]+)(m?s)/.test(n)){var t=parseFloat(RegExp.$1);return RegExp.$2=="s"&&(t*=1e3),t}return 0}function s(n,t,i){var h=n.getAttribute("data-ts-transitionstate"),r=t?t:h=="state1"?"state2":"state1",f,y,s,u,w,b,d;if(r!=h&&(i?(o(n,i.delay?i.delay+"ms":""),e(n,i.duration?i.duration+"ms":""),l(n,i.easing||"")):(o(n,""),e(n,""),l(n,""))),n.setAttribute("data-ts-transitionstate",r),r=="state2"?$ts.addClass(n,"transitionendstate"):$ts.removeClass(n,"transitionendstate"),r=="state1"&&(f=n.getAttribute("data-ts-transitionautotrigger"),f&&!/^\s*$/.test(f)&&(y=eval("("+f+")"),y.type=="cancelable"&&$ts.setCookie(y.id,"abortautotransition"))),s=!c(),s&&setTimeout(function(){n.style.display="none";setTimeout(function(){n.style.display=n.getAttribute("data-ie8transitionfallbackdisplayvalue")||""},1)},2),(n.getAttribute("data-ts-transitiontype")=="userdefined"||n.getAttribute("data-ts-transitiontype")=="fade"||s)&&h!=r){if(u=0,!s){function p(n){if(/^(\d+(\.\d+)?)(\w+)$/.test(n)){var t=parseFloat(RegExp.$1);return RegExp.$3=="s"&&(t*=1e3),t}return 0}w=a(n);b=v(n);u=p(w)+p(b)}function k(t,i){function f(i,u){r==n.getAttribute("data-ts-transitionstate")&&$ts.Observer.Broadcast(t,i,u)}r=="state2"?($ts.Observer.Broadcast(t,"TransitionState2Begin",{trigger:i}),setTimeout(function(){f("TransitionState2End",{trigger:i})},u)):r=="state1"&&($ts.Observer.Broadcast(t,"TransitionState1Begin",{trigger:i}),setTimeout(function(){f("TransitionState1End",{trigger:i})},u));$ts.Observer.Broadcast(t,"TransitionStateBegin",{trigger:i,stateid:r});setTimeout(function(){f("TransitionStateEnd",{trigger:i,stateid:r})},u)}$elm(n.id)?k(n.id,n):(d=n.className.split(" "),$chain(d).each(function(t){k(t.replace(/\s*/g,""),n)}))}}function y(n){w(n)||r.push(n)}function p(n){r=r.filter(function(t){return t!=n});var u=t.filter(function(t){return t.target==n}),i=u.length>0?u[0]:null;t=t.filter(function(t){return t.target!=n});i&&h(i.target,i.forcedState)}function w(n){for(var t=0;t<r.length;t++)if(r[t]==n)return!0;return!1}var r=[],t=[],n=[],i=[];this.SetAutoTriggers=function(){$chain("[data-ts-transitionautotrigger]").each(function(n){var t=eval("("+n.getAttribute("data-ts-transitionautotrigger")+")"),u=$ts.safeInt(t.delay1,-1),r=$ts.safeInt(t.delay2,-1),i=t.type||"always";if(i=="session"||i=="cancelable"){if($ts.getCookie(t.id))return;i=="session"&&$ts.setCookie(t.id,"abortautotransition")}setTimeout(function(){var n=$elms("#"+t.id);n.length==0&&(n=$elms("."+t.id));$chain(n).each(function(n){var i,u;Tangora.Layout.TransitionManager.RunTransition(t.id,n,"state2");r>-1&&(i=a(n),/([\d\.]+)(\w+)/.test(i)?(i=parseFloat(RegExp.$1),RegExp.$2=="s"&&(i*=1e3)):i=0,u=r+i,setTimeout(function(){Tangora.Layout.TransitionManager.RunTransition(t.id,n,"state1")},u))})},u)})};this.SetExclusiveGroups=function(){$chain(i).each(function(n){var e,t,r,o,i,s;if(n.exclusive){if(e=null,t=$elms('[data-ts-transitiongroup="'+n.id+'"][data-ts-transitionstate="state2"]'),t.length>0)for(e=t[0],r=1;r<t.length;r++)t[r].setAttribute("data-ts-transitionstate","state1");!e&&n.startindex>=1&&(o=$elms('[data-ts-transitiongroup="'+n.id+'"]'),o.length>=n.startindex&&(i=o[n.startindex-1],s=!1,s?h(i,"state2"):(u(i),i.setAttribute("data-ts-transitionstate","state2"),setTimeout(function(){f(i)},100))))}})};this.SetTransitionGroups=function(n){i=n};this.RunTransition=function(i,r,u,f){function o(n,t){return/rotatornavigation/.test(n)?t.getAttribute("data-listrotatorid"):/modulelayout-?\d+/.test(t.className)}var e=i.split(",");$chain(e).each(function(i){var e=$elm(i.replace(/\s*/,"")),l,c,s;if(!e&&r){if(r=="all"){for(l=$elms("."+i.replace(/\s*/,"")),c=0;c<l.length;c++)Tangora.Layout.TransitionManager.RunTransition(i.replace(/\s*/,""),l[c],u,f);return}for(s=r;s;)if(o(i,s)){e=$elm("."+i.replace(/\s*/,""),s);break}else s=s.parentNode}e&&(n.some(function(n){return n.target==e})&&(n.filter(function(n){return n.target==e}).forEach(function(n){clearTimeout(n.timer)}),n=n.filter(function(n){return n.target!=e}),p(e)),w(e)?(t=t.filter(function(n){return n.target!=e}),t.push({target:e,forcedState:u})):h(e,u,f))})};this.SupportsTransitions=function(){return c()}}function BlocklistInLightboxHelper(){function t(t,i){for(var f=t.getAttribute("data-listrotatorid"),r=null,u=0;u<n.length;u++)if(f==n[u].rotatorId){r=n[u];break}r.globalSettings.startIndex=i;ListRotator(f,r.globalSettings,r.responsiveSettingsArray).init(Tangora.Layout.GetResponsiveMode());t.style.width=t.offsetWidth+"px"}var n=[];this.RegisterRotator=function(t,i,r){for(var u=0;u<n.length;u++)if(t==n[u].rotatorId)return;n.push({rotatorId:t,globalSettings:i,responsiveSettingsArray:r})};this.Open=function(n,i,r,u){function it(){f.style.display="none";f.style.width=b;f.style.height=k;o.parentNode.insertBefore(f,o);o.parentNode.removeChild(o);$chain("img",f).each(function(n){n.style.maxWidth=n.getAttribute("data-maxwidthbeforelightbox")})}var f=null,a=$elms('[id="'+i+'"]'),e,o,p,w,c,l,s;if(a.length==1)f=a[0];else{for(e=n.nextSibling;e&&!f;)e.getAttribute("id")==i?f=e:e=e.nextSibling;if(!f){for(e=n.nextSibling;e&&!f;)/blocklistlayout_\d+_-?\d+/.test(e.getAttribute("id")||"")?f=e:e=e.nextSibling;if(!f)throw new Error("Blocklist element not found");}}f.style.display="block";o=$ts.createElement("div");f.parentNode.insertBefore(o,f);var v=f.getAttribute("data-listrotatorid"),b=f.style.width,k=f.style.height;if($chain("img",f).each(function(n){$ts.getComputedStyle(n,"max-width")&&n.setAttribute("data-hasmaxwidth",!0);n.setAttribute("data-maxwidthbeforelightbox",n.style.maxWidth||"")}),v&&v!=""){document.body.appendChild(f);var y=$ts.Animation.CurrentView(),d=y.Width*.9>>0,g=y.Height*.9>>0,nt=d/f.offsetWidth,tt=g/f.offsetHeight,h=Math.min(nt,tt);h<1&&(p=Math.ceil(f.offsetWidth*h*.9),w=Math.ceil(f.offsetHeight*h*.9),f.style.width=p+"px",f.style.height=w+"px");t(f,r)}c=null;l=null;u&&(c=u.OverlayColor,l=u.OverlayOpacity,u.behaviors=u.behaviors||{},u.behaviors.overflow="hide");s=LightBox.Open(f,c,l,null,null,null,null,u);typeof s=="object"&&s.Id&&(s=s.Id);$ts.Observer.RegisterOneShot(s,"Closed",it)}}function ContentSwapTransitionManager(){function h(n){var i=null,o=null,u,r;if(typeof(t[n.id]!="undefined"))i=t[n.id];else for(u=n.className.split(" "),r=0;r<u.length;r++)if(typeof t[u[r]]!="undefined"){i=t[u[r]];break}if(i&&i.length>0){var s=Tangora.Layout.GetCurrentResponsiveMode(),f=null,e=null;if(i.sort(function(n,t){return n.responsiveMode==0?-1:t.responsiveMode==0?1:t.responsiveMode-n.responsiveMode}),i[0].responsiveMode==0&&(f=i[0].method,e=i[0].duration),s!=0)for(r=0;r<i.length;r++)i[r].responsiveMode!=0&&parseInt(i[r].responsiveMode)>=parseInt(s)&&(f=i[r].method,e=i[r].duration);f&&e&&(o={method:f,duration:e})}return o}function u(n,t){i.push({element:n,abortMethod:t})}function f(n){i=i.filter(function(t){return t.element!=n})}function c(n){return i.some(function(t){return t.element==n||t.element.id==n.id})}function l(n){var t=i.filter(function(t){return t.element==n||t.element.id==n.id});t.length==1&&t[0].abortMethod(!1)}function a(t,i,r){function a(){var n=0;return $chain(["padding-top","padding-bottom","border-top-width","border-bottom-width"]).each(function(i){var r=$ts.getComputedStyle(t,i);/(-?\d+(\.\d+)?)px/.test(r)&&(n+=$ts.safeInt(RegExp.$1))}),n}function v(){t.style.opacity=="0"?(t.innerHTML=i,t.style.opacity="1",r.callback()):y(!0)}function y(r){clearTimeout(l);s(t,v);n(t,"");t.style.height="";t.style.opacity="";r||(t.innerHTML=i);f(t)}var l=null,h,e,c;u(t,y);o(t,v);h=t.clientHeight-a();e=t.cloneNode(!0);e.innerHTML=i;t.parentNode.insertBefore(e,t.nextSibling);c=e.clientHeight-a();e.parentNode.removeChild(e);e=null;t.style.height=h+"px";n(t,"opacity "+r.duration*.5+"ms linear, height "+r.duration*.5+"ms ease "+(h<c?0:r.duration*.5)+"ms");l=setTimeout(function(){t.style.height=c+"px";t.style.opacity="0"},50)}function v(t,i,u){function f(n,t,i){var r=n.offsetHeight;newHeight=t.offsetHeight;n.style.opacity="1";t.style.opacity="0";i.style.height=r+"px"}function e(t,i,r){n(r,"height "+u.duration+"ms ease");n(t,"opacity "+u.duration+"ms linear");n(i,"opacity "+u.duration+"ms linear")}function o(n,t,i){n.style.opacity="0";t.style.opacity="1";i.style.height=t.offsetHeight+"px"}r(t,i,u,f,e,o)}function e(t,i,u,f){function e(n,t,i){i.style.height=n.offsetHeight+"px";t.style.left=u?"-100%":"100%"}function o(t,i,r){n(t,"left "+f.duration+"ms ease");n(i,"left "+f.duration+"ms ease");n(r,"height "+f.duration+"ms ease")}function s(n,t,i){n.style.left=u?"100%":"-100%";t.style.left="0%";i.style.height=t.offsetHeight+"px"}r(t,i,f,e,o,s)}function y(t,i,u){function e(n,t,i){var r=n.offsetHeight,u=t.offsetHeight;n.style.opacity="1";n.style.webkitFilter="blur(0px)";n.style.filter="blur(0px)";t.style.opacity="0";t.style.webkitFilter="blur("+f+"px)";t.style.filter="blur("+f+"px)";i.style.height=r+"px"}function o(t,i,r){n(r,"height "+u.duration+"ms ease");n(t,"opacity "+u.duration+"ms linear, -webkit-filter "+u.duration+"ms linear, filter "+u.duration+"ms linear");n(i,"opacity "+u.duration+"ms linear, -webkit-filter "+u.duration+"ms linear, filter "+u.duration+"ms linear")}function s(n,t,i){n.style.opacity="0";n.style.webkitFilter="blur("+f+"px)";n.style.filter="blur("+f+"px)";t.style.opacity="1";t.style.webkitFilter="blur(0px)";t.style.filter="blur(0px)";i.style.height=t.offsetHeight+"px"}var f=10;r(t,i,u,e,o,s)}function r(n,t,i,r,e,h){function y(n){n.target==c&&p(!0)}function p(){clearTimeout(v);s(c,y);n.innerHTML=t;n.style.display="";l.parentNode.removeChild(l);f(n);l=null;a=null;c=null;i.callback()}var v=null,l=$ts.createElement("div",null,{position:"relative"}),a=n.cloneNode(!0),c=n.cloneNode(!0);c.innerHTML=t;u(n,p);o(c,y);n.parentNode.insertBefore(l,n.nextSibling);l.appendChild(a);l.appendChild(c);l.style.overflow="hidden";a.style.position="relative";c.style.position="relative";a.style.top="0%";a.style.left="0%";c.style.top="-"+a.offsetHeight+"px";c.style.left="0%";n.style.display="none";r(a,c,l);v=setTimeout(function(){e(a,c,l);v=setTimeout(function(){h(a,c,l)},50)},50)}function n(n,t){n.style.transition=t;n.style.OTransition=t;n.style.MozTransition=t;n.style.WebkitTransition=t}function o(n,t){$ts.addEvent(n,"transitionend",t);$ts.addEvent(n,"oTransitionEnd",t);$ts.addEvent(n,"mozTransitionEnd",t);$ts.addEvent(n,"webkitTransitionEnd",t)}function s(n,t){$ts.removeEvent(n,"transitionend",t);$ts.removeEvent(n,"oTransitionEnd",t);$ts.removeEvent(n,"mozTransitionEnd",t);$ts.removeEvent(n,"webkitTransitionEnd",t)}var t={},i=[];this.RegisterBatch=function(n){for(var f,u,i=0;i<n.length;i++){var r=n[i].id,o=n[i].method,s=n[i].duration,e=n[i].responsiveMode;for(typeof t[r]=="undefined"&&(t[r]=[]),f=!1,u=0;u<t[r].length;u++)if(t[r][u].responsiveMode==e){f=!0;break}f||t[r].push({method:o,duration:s,responsiveMode:e})}};this.SwapContent=function(n,t,i){var o,r;if(i||(i={}),o=typeof i.callback=="function"?i.callback:function(){},!Tangora.Layout.TransitionManager.SupportsTransitions()){n.innerHTML=t;o();return}var u=h(n),s=u?u.method:"",f=u?u.duration:0;typeof i.method!="undefined"&&(s=i.method);typeof i.duration!="undefined"&&(f=i.duration);f=Math.max(f,1);r={duration:f,callback:o};c(n)&&l(n);switch(s||""){case"fade":a(n,t,r);break;case"crossfade":v(n,t,r);break;case"slide":e(n,t,!1,r);break;case"slideback":e(n,t,!0,r);break;case"blur":y(n,t,r);break;default:n.innerHTML=t;r.callback()}}}if(typeof Tangora=="undefined")var Tangora={};typeof Tangora.Layout=="undefined"&&(Tangora.Layout=new LayoutController);typeof(Tangora.Layout.TransitionManager=="undefined")&&(Tangora.Layout.TransitionManager=new TransitionManager);typeof Tangora.Layout.BlocklistInLightboxHelper=="undefined"&&(Tangora.Layout.BlocklistInLightboxHelper=new BlocklistInLightboxHelper);typeof(Tangora.Layout.ContentSwapTransitionManager=="undefined")&&(Tangora.Layout.ContentSwapTransitionManager=new ContentSwapTransitionManager),function(){function i(i,r,u){var f=null,o,e;try{o=n.filter(function(n){return n.id==i});o.length>0&&(f=o[0])}catch(s){for(e=0;e<n.length;e++)if(n[e].id==i){f=n[e];break}}if(!f&&r&&u&&(f=new t(i,r,u),n.push(f)),!f)throw new Error("The ListRotator "+i+" is not registered...");return f}function t(n,t,i){this.id=n;this.settingsArray=i;this.globalSettings=t;this.settings=null;this.broadcasterId=$elm('[data-listrotatorid="'+n+'"]').getAttribute("id")}if(!window.ListRotator){var n=[];t.prototype={resolveSettings:function(n){var r=this.settingsArray[0][1],t,u,i;if(n>0&&this.settingsArray.length>1)for(t=1;t<this.settingsArray.length;t++){if(u=this.settingsArray[t][0],u<n)break;r=this.settingsArray[t][1]}this.settings=r;for(i in this.globalSettings)this.settings[i]=this.globalSettings[i];this.settings.startIndex=this.settings.startIndex||0;this.settings.transitionDuration=this.settings.transitionDuration||1e3;this.element=$elm('[data-listrotatorid="'+this.id+'"]');this.setOffsetStart()},addCleanUpFunc:function(n){this.cleanUpStack.push(n)},cleanUpStack:null,cleanUp:function(){for(var n;n=this.cleanUpStack.pop();)n()},touchOptimize:function(){function d(n){/input|select|textarea/i.test(n.tagName)||(n.style.webkitTouchCallout="none",n.style.webkitUserSelect="none",n.style.khtmlUserSelect="none",n.style.mozUserSelect="none",n.style.msUserSelect="none",n.style.userSelect="none",n.tagName&&n.tagName.toLowerCase()==="img"&&n.setAttribute("onmousedown","if (event.preventDefault) event.preventDefault()"))}function at(n){n.style.msTouchAction="pan-y";n.style.webkitTransitionProperty="transform";n.style.mozTransitionProperty="transform";n.style.oTransitionProperty="transform";n.style.transitionProperty="transform";n.style.webkitTransformOrigin="0% 0%";n.style.msTransformOrigin="0% 0%";n.style.transformOrigin="0% 0%";n.style.webkitTransform="translate(0px, 0px) scale(1)";n.style.msTransform="translate(0px, 0px) scale(1)";n.style.transform="translate(0px, 0px) scale(1)"}function s(n,t){n.style.webkitTransitionTimingFunction=t;n.style.mozTransitionTimingFunction=t;n.style.msTransitionTimingFunction=t;n.style.oTransitionTimingFunction=t;n.style.transitionTimingFunction=t}function g(n,t){t="translate("+t+"px, 0px) scale(1)";n.style.transform=t;n.style.msTransform=t;n.style.webkitTransform=t}function nt(n,t){t="translate(0px, "+t+"px) scale(1)";n.style.transform=t;n.style.msTransform=t;n.style.webkitTransform=t}function vt(n){n.style.webkitPerspective="1px";n.style.perspective="1px";n.style.webkitBackfaceVisibility="hidden";n.style.mozBackfaceVisibility="hidden";n.style.msBackfaceVisibility="hidden";n.style.backfaceVisibility="hidden";n.style.webkitTransform="translateZ(0)";n.style.msTransform="translateZ(0)";n.style.transform="translateZ(0)"}function ft(n){n.origPosition=n.style.position;n.origFloat=n.style.float;n.origCssFloat=n.style.cssFloat;n.style.position="static";n.style.float="left";n.style.cssFloat="left";n.style.width=n.offsetWidth+"px";n.revertTouchOptimization=function(){n.style.position=n.origPosition;n.style.float=n.origFloat;n.style.cssFloat=n.origCssFloat;n.origPosition=null;n.origFloat=null;n.origCssFloat=null;n.revertTouchOptimization=null}}function ct(){if(t.settings.autoFetchEnabled){var e=t.fetchMoreItems(),f;if(e.length>0){while(e.length>0)f=e.shift(),ft(f),$chain("*",f).each(d),d(f),u?h+=l.offsetWidth:c+=l.offsetHeight,n.appendChild(f),et++;return $ts.Observer.Broadcast("List","AfterAutoFetch"),et<t.settings.totalRecordCount?n.appendChild(r):r!==null&&(u?h-=r.offsetWidth:c-=r.offsetHeight,r.parentNode.removeChild(r),r=null),u?n.style.width=h+"px":n.style.height=c+"px",i=t.getItems(),r!==null&&i.push(r),!0}return!1}return!1}function ut(){var i=n.childNodes,t=0,r,f;if(u){for(r=n.currentLeft*-1;t<i.length;t++)if(i[t].offsetLeft>r){t>0&&Math.abs(i[t-1].offsetLeft-r)<Math.abs(i[t].offsetLeft-r)&&(t-=1);break}}else for(f=n.currentTop*-1;t<i.length;t++)if(i[t].offsetTop>f){t>0&&Math.abs(i[t-1].offsetTop-f)<Math.abs(i[t].offsetTop-f)&&(t-=1);break}return t>i.length-1&&(t=i.length-1),t}function wt(){v=!1}function lt(n,t){var i,r;if((i=n.length)<2)return n[i-1];for(r=Math.abs(n[--i]-t);i--;)if(r<(r=Math.abs(n[i]-t)))break;return n[i+1]}function gt(){var o=100*a,h=o*a,v=0,c,p,w,l,b,k,f,y;if(o=Math.max(o,250),u){if(e==="right"||e==="left"){for(c=[],f=0;f<i.length;f++)c.push(i[f].offsetLeft);for(c.sort(function(n,t){return n-t}),t.setTransitionDuration(n,o+"ms"),s(n,"cubic - bezier(0.100, 0.9, 0.100, 0.9)"),e==="right"?n.currentLeft+=h:e==="left"&&(n.currentLeft-=h),n.currentLeft=lt(c,n.currentLeft*-1)*-1,t.settings.activeCount>1&&(p=n.firstChild.offsetWidth,w=n.offsetWidth,n.currentLeft=Math.max(n.currentLeft,(w-p*t.settings.activeCount)*-1)),g(n,n.currentLeft),setTimeout(function(){t.setTransitionDuration(n,"0ms");s(n,"cubic-bezier(0.33, 0.66, 0.66, 1)");t.stopAutoRotate()},o),f=0;f<i.length;f++)if(i[f].offsetLeft===Math.abs(n.currentLeft)){v=f;break}}}else if(e==="up"||e==="down"){for(l=[],f=0;f<i.length;f++)l.push(i[f].offsetTop);for(l.sort(function(n,t){return n-t}),t.setTransitionDuration(n,o+"ms"),s(n,"cubic - bezier(0.100, 0.9, 0.100, 0.9)"),e==="down"?n.currentTop+=h:e==="up"&&(n.currentTop-=h),n.currentTop=lt(l,n.currentTop*-1)*-1,t.settings.activeCount>1&&(b=n.firstChild.offsetHeight,k=n.offsetHeight,n.currentTop=Math.max(n.currentTop,(k-b*t.settings.activeCount)*-1)),nt(n,n.currentTop),setTimeout(function(){t.setTransitionDuration(n,"0ms");s(n,"cubic-bezier(0.33, 0.66, 0.66, 1)")},o),f=0;f<i.length;f++)if(i[f].offsetTop==Math.abs(n.currentTop)){v=f;break}}r!==null&&t.settings.totalRecordCount>n.childNodes.length-1&&(y=!1,y=u?n.currentLeft*-1+n.firstChild.offsetWidth*t.settings.activeCount>=r.offsetLeft:n.currentTop*-1+n.firstChild.offsetHeight*t.settings.activeCount>=r.offsetTop,y&&ct());h>0&&t.updateNavigation(v)}function w(){var s=arguments[0]||event,h=$time(),r=t.resolveCoordinates(s),d=r.x-y.x,tt=r.y-y.y,f=r.x-p.x,o=r.y-p.y,c=h-it,l,i;if(!(c<10)){if(rt===!1)Math.max(Math.abs(d),Math.abs(tt))>50&&(rt=!0);else if(u?n.currentLeft+=f:n.currentTop+=o,l=Math.max(Math.abs(f),Math.abs(o)),i=l/c,i=a>0?(i+a)/2:i,i!==Infinity&&(a=i),Math.abs(f)>Math.abs(o)?(e=f>0?"right":"left",u&&$ts.cancelBubble(s)):(e=o>0?"down":"up",u||$ts.cancelBubble(s)),u){var v=n.firstChild.offsetWidth,ut=n.offsetWidth,w=Math.round(v/3),ft=(ut-(v*t.settings.activeCount-w))*-1;n.currentLeft=Math.min(n.currentLeft,w);n.currentLeft=Math.max(n.currentLeft,ft);g(n,n.currentLeft)}else{var b=n.firstChild.offsetHeight,et=n.offsetHeight,k=Math.round(b/3),ot=(et-(b*t.settings.activeCount-k))*-1;n.currentTop=Math.min(n.currentTop,k);n.currentTop=Math.max(n.currentTop,ot);nt(n,n.currentTop)}p=r;it=h}}function b(){$ts.removeEvent(document.body,"mousemove",w);$ts.removeEvent(document.body,"touchmove",w);gt();rt=!1}function k(){var i=t.getItems().length<t.settings.rotatorClasses.length,n;i||t.settings.totalRecordCount<=1||(n=arguments[0]||event,n.touches&&n.touches.length>1)||(y=t.resolveCoordinates(n),p=y,it=$time(),a=0,$ts.addEvent(document.body,"mousemove",w),$ts.addEvent(document.body,"touchmove",w))}for(var ni=$elm('[data-listrotatorid="'+this.id+'"]'),t=this,ti=$ts.isTouchDevice(),i=t.getItems(),et=i.length,f=i[0].parentNode,ot=i[0].offsetWidth,st=i[0].offsetHeight,n=f.appendChild($ts.createElement("div",{id:t.id+"_slider",currentLeft:0,currentTop:0})),u=t.settings.swipeDirection!=="frombottom",yt=u?t.settings.activeCount:1,pt=u?1:t.settings.activeCount,h=0,c=0,r=null,ht,tt,o,l;t.shouldClone(i);){for(ht=i[0].parentNode,o=0;o<i.length;o++)tt=i[o].cloneNode(!0),tt.setAttribute("data-listrotatorclone","true"),ht.appendChild(tt);i=t.getItems()}for(t.addCleanUpFunc(function(){for(var t=0;t<i.length;t++)n.parentNode.insertBefore(i[t],n);n.parentNode.removeChild(n);n=null}),at(n),t.setTransitionDuration(n,"0ms"),s(n,"cubic-bezier(0.33, 0.66, 0.66, 1)"),vt(n),o=0;o<i.length;o++)l=i[o],ft(l),n.appendChild(l),u?h+=l.offsetWidth:c+=l.offsetHeight;$chain("*",n).each(d);n.style.width=Math.max(ot,h)+"px";n.style.height=Math.max(st,c)+"px";f.originalWidth=f.style.width;f.originalHeight=f.style.height;f.style.width=ot*yt+"px";f.style.height=st*pt+"px";t.settings.autoFetchEnabled&&t.settings.totalRecordCount>i.length&&(r=n.appendChild(i[0].cloneNode(!0)),r.activeSpinner=!0,r.firstChild.innerHTML="",r.firstChild.appendChild($ts.createElement("div",null,{background:"transparent url(/setup/ajax-loader.gif) no-repeat center center",width:r.firstChild.offsetWidth+"px",height:r.firstChild.offsetHeight+"px"})),u?(h+=r.offsetWidth,n.style.width=h+"px"):(c+=r.offsetHeight,n.style.height=c+"px"),i.push(r));var y,p,it,a=0,e,rt=!1,v=!1;t.addCleanUpFunc(function(){var i,n;for(f.style.width=f.originalWidth,f.style.height=f.originalHeight,f.originalWidth=null,f.originalHeight=null,i=t.getItems(),n=0;n<i.length;n++)i[n].revertTouchOptimization()});var bt=t.next,kt=t.next,dt=t.goto;t.next=function(n){if(!v){var i=ut(),r=t.getItems();i++;i<r.length&&t.goto(i+1,n)}};t.previous=function(){if(!v){var n=ut();n--;n>=0&&t.goto(n+1)}};t.goto=function(i,r,f){if(!v){r!==!0&&this.stopAutoRotate();for(var e=i-1,h=e,c=ut(),o=(Math.abs(c-e)+1)*125+250;t.settings.autoFetchEnabled&&t.settings.totalRecordCount>n.childNodes.length&&n.childNodes.length<i+t.settings.activeCount&&ct(););v=!0;f!==!0&&(t.setTransitionDuration(n,o+"ms"),s(n,"cubic - bezier(0.100, 0.9, 0.100, 0.9)"));n.childNodes.length-t.settings.activeCount<e&&(e=n.childNodes.length-t.settings.activeCount);u?(n.currentLeft=n.childNodes[e].offsetLeft*-1,g(n,n.currentLeft)):(n.currentTop=n.childNodes[e].offsetTop*-1,nt(n,n.currentTop));setTimeout(function(){t.setTransitionDuration(n,"0ms");s(n,"cubic-bezier(0.33, 0.66, 0.66, 1)");wt()},o);t.updateNavigation(h)}};t.addCleanUpFunc(function(){t.next=bt;t.previous=kt;t.goto=dt});$ts.addEvent(n,"mousedown",k);$ts.addEvent(n,"touchstart",k);$ts.addEvent(document.body,"mouseup",b);$ts.addEvent(document.body,"touchend",b);t.addCleanUpFunc(function(){$ts.removeEvent(n,"mousedown",k);$ts.removeEvent(n,"touchstart",k);$ts.removeEvent(document.body,"mouseup",b);$ts.removeEvent(document.body,"touchend",b)});t.isVisible=!0;t.stopAutoRotate();t.shouldAutoRotate()&&(t.startAutoRotate(t.settings.autoDuration),t.addCleanUpFunc(function(){t.stopAutoRotate()}));t.updateNavigation(t.settings.startIndex);t.settings.startIndex&&t.settings.startIndex>0&&t.goto(t.settings.startIndex+1,!0,!0)},resolveCoordinates:function(n){var t={x:0,y:0};return t.x=n.pageX||(n.clientX||n.touches[0].clientX)+document.body.scrollLeft+document.documentElement.scrollLeft,t.y=n.pageY||(n.clientY||n.touches[0].clientY)+document.body.scrollTop+document.documentElement.scrollTop,t},updateNavigation:function(n){var t=this,u=t.getItems(),e=u.length<t.settings.rotatorClasses.length,o,r,f,i;if(t.settings.navigationType==="dots"&&t.settings.navigationActiveDotClass&&t.settings.navigationActiveDotClass!==""&&t.settings.navigationDotsContainerClass&&t.settings.navigationDotsContainerClass!==""){if(o=$elm("."+t.settings.navigationDotsContainerClass,t.element),r=$elms("a",o),u.length>r.length){for(i=r.length;i<u.length;i++)f=r[0].cloneNode(!0),f.setAttribute("onclick",f.getAttribute("onclick").replace("goto(1)","goto("+(i+1)+")")),r[0].parentNode.appendChild(f);r=$elms("a",o)}for(i=0;i<r.length;i++)e?r[i].style.display="none":(r[i].style.display="",$ts.removeClass(r[i],t.settings.navigationActiveDotClass),i===n&&$ts.addClass(r[i],t.settings.navigationActiveDotClass))}else if(t.settings.navigationType==="arrows"){var s=$elm("."+t.settings.navigationPrevArrowClass,t.element),h=$elm("."+t.settings.navigationNextArrowClass,t.element),c=t.queue.length>0?t.queue[t.queue.length-1].index:n;c===0&&t.settings.repeat===!1||e?$ts.addClass(s,t.settings.navigationInactiveArrowClass):$ts.removeClass(s,t.settings.navigationInactiveArrowClass);c>=u.length-t.settings.activeCount&&t.settings.repeat===!1||e?$ts.addClass(h,t.settings.navigationInactiveArrowClass):$ts.removeClass(h,t.settings.navigationInactiveArrowClass)}},init:function(n){var o,l,t;this.cleanUpStack!==null&&this.cleanUp();this.currentIndex=null;this.cleanUpStack=[];this.removeClones();var f=$elm('[data-listrotatorid="'+this.id+'"]'),t=this,a=$ts.isTouchDevice();if(f.style.visibility="visible",this.resolveSettings(n),this.settings.touchOptimized)this.touchOptimize();else{if(a&&this.touchWired!==!0){this.touchWired=!0;function c(){var i=arguments[0]||event,r=t.resolveCoordinates(i),u=r.x-o.x,f=r.y-o.y,n=250;Math.abs(u)>Math.abs(f)&&t.settings.swipeDirection=="fromright"?($ts.cancelBubble(i),u>0?t.previous(n):t.next(null,n),e()):t.settings.swipeDirection=="frombottom"&&($ts.cancelBubble(i),f<0?t.next(null,n):t.previous(n),e())}function e(){$ts.removeEvent(f,"touchmove",c);$ts.removeEvent(document.body,"touchend",e)}function v(){var n,i;Tangora.SkipRotatorSwipe||(n=t.getItems().length<t.settings.rotatorClasses.length,n)||(i=arguments[0]||event,o=t.resolveCoordinates(i),$ts.addEvent(f,"touchmove",c),$ts.addEvent(document.body,"touchend",e))}$ts.addEvent(f,"touchstart",v)}if(this.queue=[],this.disableTransitions(!0),this.mapRotatorClasses(this.settings.startIndex),this.settings.fadeType=="crossfade"&&(this.queuedIndex=this.settings.startIndex-1,this.currentIndex=this.settings.startIndex-1,this.next(!0)),this.addCleanUpFunc(function(){t.stripRotatorClasses()}),/MSIE\s(\d)\.\d/.test(navigator.userAgent)&&parseInt(RegExp.$1,10)<=8){var u=$elm('[data-listrotatorid="'+this.id+'"]'),r=$elm(".listrotator-navigation-previous",u),i=$elm(".listrotator-navigation-next",u),s=$elm(".listrotator-navigation-dots",u);if(r&&i){var y=$elm("img",i)!=null,h=this.settings.swipeDirection=="frombottom",p=h&&!(/\d/.test($ts.getComputedStyle(i,"left"))||/\d/.test($ts.getComputedStyle(i,"right"))),w=!h&&!(/\d/.test($ts.getComputedStyle(i,"top"))||/\d/.test($ts.getComputedStyle(i,"bottom")));y||($chain([r,i]).each(function(n){n.style.textDecoration="none";n.style.fontSize=$ts.getComputedStyle(n,"height");n.style.color=$ts.getComputedStyle($elm("span",n),"backgroundColor")}),h?(r.innerHTML="&#x25b2;",i.innerHTML="&#x25bc;"):(r.innerHTML="&#x25c4;",i.innerHTML="&#x25ba;"));p&&(r.style.left=u.offsetWidth/2-r.offsetWidth/2+"px",r.style.right="auto",i.style.left=u.offsetWidth/2-i.offsetWidth/2+"px",i.style.right="auto");w&&(r.style.top=u.offsetHeight/2-r.offsetHeight/2+"px",r.style.bottom="auto",i.style.top=u.offsetHeight/2-i.offsetHeight/2+"px",i.style.bottom="auto")}else s&&(l=$elms("a > img",s).length>0,l||$chain("a",s).each(function(n){n.innerHTML="&bull;";n.style.textDecoration="none";n.style.color=$ts.getComputedStyle(n,"background-color");n.style.backgroundColor="transparent";n.style.fontSize=$ts.safeInt($ts.getComputedStyle(n,"height"))*3+"px";n.style.width="auto";n.style.height="auto";n.style.margin="0px 1px"}))}t=this,function(){function n(n){var r="visible",u="hidden",f={focus:r,focusin:r,pageshow:r,blur:u,focusout:u,pagehide:u},e;n=n||window.event;e=n.type in f?f[n.type]:this[i]?"hidden":"visible";t.isVisible=e==="visible"}var i="hidden";i in document?document.addEventListener("visibilitychange",n):(i="mozHidden")in document?document.addEventListener("mozvisibilitychange",n):(i="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",n):(i="msHidden")in document?document.addEventListener("msvisibilitychange",n):"onfocusin"in document?document.onfocusin=document.onfocusout=n:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=n}();t.isVisible=!0;t.stopAutoRotate();t.shouldAutoRotate()&&(t.startAutoRotate(t.settings.autoDuration),t.addCleanUpFunc(function(){t.stopAutoRotate()}))}$ts.Observer.Broadcast(t.broadcasterId,"listRotatorInitialized")},startAutoRotate:function(n){var t=this,r=t.settings.trigger=="oncssbackgroundload"&&!Tangora.Layout.AllCssBackgroundsLoaded;if(r){$ts.Observer.Register("TangoraPage","OnLoadAllCssBackgrounds",function(){t.startAutoRotate(n)});return}if(t.shouldRenderAsMarquee()){function i(){t.isVisible&&t.next(!0)}setTimeout(function(){clearTimeout(t.settings.transitionInProgress);t.settings.transitionInProgress=null;i();t.autoRotate=setInterval(i,t.settings.autoDuration+t.settings.transitionDuration)},t.settings.autoDuration)}else t.autoRotate=setInterval(function(){t.isVisible&&t.next(!0)},n)},stopAutoRotate:function(){this.autoRotate&&(clearInterval(this.autoRotate),this.autoRotate=null)},stripRotatorClasses:function(){function t(t){for(var i=0;i<n.settings.rotatorClasses.length;i++)$ts.removeClass(t,n.settings.rotatorClasses[i])}var n=this;n.executeOnAllItems(t)},executeOnAllItems:function(n){$chain('[data-listrotatorid="'+this.id+'"] .'+this.settings.itemClass).each(n)},getItems:function(){for(var t=$elms('[data-listrotatorid="'+this.id+'"] .'+this.settings.itemClass),i=[],n=0;n<t.length;n++)t[n].activeSpinner!==!0&&i.push(t[n]);return i},fetchMoreItems:function(){if(this.settings.autoFetchEnabled){for(var t=this.getItems(),r=this.settings.totalRecordCount-t.length,n=$ts.createElement("div",{innerHTML:Tangora.ListUtils.getData(t.length+1,Math.min(this.settings.pageSize,r))}),i=[];n.childNodes.length>0;)i.push(n.firstChild),n.removeChild(n.firstChild);return n=null,i}return[]},shouldClone:function(n){function i(){return t.settings.touchOptimized?!1:t.settings.totalRecordCount<=t.settings.rotatorClasses.length&&n.length<t.settings.rotatorClasses.length||!t.settings.autoFetchEnabled&&n.length<t.settings.rotatorClasses.length?!0:!1}function r(){return n.length>=t.settings.activeCount?n.length==1?!1:!0:!1}var t=this;if(n.length>=t.settings.rotatorClasses.length||t.settings.totalRecordCount>=t.settings.rotatorClasses.length&&t.settings.autoFetchEnabled)return!1;switch(t.settings.itemShortage){case"notset":return i();case"nocopy":return!1;case"copy":return!0;case"conditionalcopy":return r();default:return i()}},removeClones:function(){$chain('[data-listrotatorid="'+this.id+'"] [data-listrotatorclone="true"]').each(function(n){n.parentNode.removeChild(n);n=null})},shouldAutoRotate:function(){var n=this,t;return n.settings.autoRotate?(t=n.getItems(),t.length>=n.settings.rotatorClasses.length):!1},mapRotatorClasses:function(n,t,i,r){function f(){var k,it,rt,d,ut,a,s,i,et;if(u.settings.transitionTimeStamp=$time(),u.queue.length!==0){if(n=u.queue[0].index,t=u.queue[0].reverse,typeof r=="undefined"&&(r=e?c:c/u.queue.length),u.currentIndex==n){u.queue.shift();f();return}u.stripRotatorClasses();var o=u.getItems(),h=o,v=[],l=[],w=[],g=[],p=[],b=[],nt=[],tt=[],y=n-u.settings.afterCount,ft=!0,ot=o.length;if(u.currentIndex>=0)for(ft=!1;u.settings.autoFetchEnabled&&u.settings.totalRecordCount>o.length&&u.queuedIndex>=o.length-u.settings.pageSize;)if(k=u.fetchMoreItems(),k.length>0){for(d=o[0].parentNode,it=o[o.length-1];k.length>0;)rt=k.shift(),d.insertBefore(rt,it.nextSibling),it=rt;$ts.Observer.Broadcast("List","AfterAutoFetch");o=u.getItems();ot=o.length}else{console.log("ERROR: Leaving infinite loop in ListRotator, RunQueuedItem. Unexpected result from server.");break}while(u.shouldClone(o)){for(d=o[0].parentNode,i=0;i<o.length;i++)ut=o[i].cloneNode(!0),ut.setAttribute("data-listrotatorclone","true"),d.appendChild(ut);o=u.getItems();h=o}for(y!=0&&(h=y<0?o.slice(o.length+y).concat(o.slice(0,o.length+y)):o.slice(y).concat(o.slice(0,y))),i=0;i<h.length;i++)i>=u.settings.afterCount&&i<u.settings.afterCount+u.settings.activeCount&&l.push(h[i]);if(u.previousActiveItems){for(v=u.previousActiveItems,i=0;i<v.length;i++){for(a=!1,s=0;s<l.length;s++)if(a=v[i]===l[s],a)break;a===!1&&tt.push(v[i])}for(i=0;i<l.length;i++){for(a=!1,s=0;s<v.length;s++)if(a=l[i]===v[s],a)break;a===!1&&nt.push(l[i])}}else if(o.length<=u.settings.activeCount)for(i=0;i<o.length;i++)(function(n){$ts.Observer.Broadcast(u.broadcasterId,"listRotatorAnimationInEnd",{trigger:n.firstChild})})(o[i]);else for(i=0;i<l.length;i++)(function(n){$ts.Observer.Broadcast(u.broadcasterId,"listRotatorAnimationInEnd",{trigger:n.firstChild})})(l[i]);for(u.previousActiveItems=l,e||(u.transitionTimeout=setTimeout(function(){u.transitionTimeout=null;u.queue.shift();f()},r)),i=0;i<h.length;i++)i===0&&p.push(h[i]),u.setTransitionDuration(h[i],r+"ms"),$ts.addClass(h[i],u.settings.rotatorClasses[Math.min(u.settings.rotatorClasses.length-1,i)]),i>=u.settings.rotatorClasses.length-1&&b.push(h[i]);if(u.preFirstClassItems){for(w=u.preFirstClassItems,g=u.preLastClassItems,i=0;i<w.length;i++)for(s=0;s<b.length;s++)w[i]===b[s]&&u.setTransitionDuration(w[i],"0s");for(i=0;i<p.length;i++)for(s=0;s<g.length;s++)p[i]===g[s]&&u.setTransitionDuration(p[i],"0s")}for(u.preFirstClassItems=p,u.preLastClassItems=b,i=0;i<nt.length;i++)(function(n){$ts.Observer.Broadcast(u.broadcasterId,"listRotatorAnimationInBegin",{trigger:n.firstChild});setTimeout(function(){$ts.Observer.Broadcast(u.broadcasterId,"listRotatorAnimationInEnd",{trigger:n.firstChild})},r)})(nt[i]);for(i=0;i<tt.length;i++)(function(n){$ts.Observer.Broadcast(u.broadcasterId,"listRotatorAnimationOutBegin",{trigger:n.firstChild});setTimeout(function(){$ts.Observer.Broadcast(u.broadcasterId,"listRotatorAnimationOutEnd",{trigger:n.firstChild})},r)})(tt[i]);if(o.length<u.settings.rotatorClasses.length)for(u.stripRotatorClasses(),i=0;i<o.length;i++)et=Math.min(i+u.settings.afterCount,u.settings.rotatorClasses.length-1),$ts.addClass(o[i],u.settings.rotatorClasses[et]);u.currentIndex=n;u.updateNavigation(u.currentIndex);ft&&u.queue.shift();e&&(u.settings.transitionInProgress=setTimeout(function(){u.settings.transitionInProgress=null},r))}}var u=this,c=u.settings.transitionDuration,h=i!==!0,e=u.shouldRenderAsMarquee(),o,s,l;if(e&&u.settings.transitionInProgress){requestAnimationFrame(function(){u.mapRotatorClasses(n,t,i,r)});return}u.queue.push({index:n,reverse:t});u.queuedIndex=n;this.queue.length===1&&h?f():u.transitionTimeout?(clearTimeout(u.transitionTimeout),u.transitionTimeout=null,h&&(o=$time()-u.settings.transitionTimeStamp,s=u.settings.transitionDuration/u.queue.length,e&&(o=0,s=u.settings.transitionDuration),o>s?f():(l=s-o,u.setTransitionDurationOnAll("0ms"),u.transitionTimeout=setTimeout(function(){u.transitionTimeout=null;u.queue.shift();f()},l)))):h&&f()},disableTransitions:function(n){this.executeOnAllItems(function(t){var i=n?"none":"";t.style.transition=i})},getTransitionDuration:function(n){$ts.getComputedStyle(n,"transition-duration")},parseTransitionDurationToMS:function(n){return n?n.indexOf("ms")>-1?parseInt(n,10):n.indexOf("s")>-1?parseInt(n,10)*1e3:!1:!1},setTransitionDuration:function(n,t){n.style.transitionDuration=t},setTransitionDurationOnAll:function(n){var t=this;this.executeOnAllItems(function(i){t.setTransitionDuration(i,n)})},setTransitionTimingFunction:function(n,t){n.style.transitionTimingFunction=t},setTransitionTimingFunctionAll:function(n){var t=this;this.executeOnAllItems(function(i){t.setTransitionTimingFunction(i,n)})},setTransitionCallback:function(n,t){function e(){$ts.removeEvent(n,u,e);t()}var i,f,r,u,o;if(!this.validTransitionEnd){f=$ts.createElement("fakeelement");r={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(i in r)if(f.style[i]!==undefined){this.validTransitionEnd=r[i];break}}u=this.validTransitionEnd;o=0;$ts.addEvent(n,u,e)},next:function(n,t){n!==!0&&this.stopAutoRotate();this.disableTransitions(!1);var i=this.queuedIndex+1;i>=this.getItems().length&&(i=this.settings.repeat?0:this.queuedIndex);this.mapRotatorClasses(i,null,null,t)},previous:function(n){this.stopAutoRotate();this.disableTransitions(!1);var t=this.queuedIndex-1;t<0&&(t=this.settings.repeat?this.getItems().length-1:this.queuedIndex);this.mapRotatorClasses(t,!0,null,n)},goto:function(n){if(this.stopAutoRotate(),n--,n!=this.queuedIndex){if(this.shouldRenderAsMarquee()){clearTimeout(this.settings.transitionInProgress);this.settings.transitionInProgress=null;this.mapRotatorClasses(n,null,null,0);return}if(this.settings.gotoMethod=="jump")this.mapRotatorClasses(n);else{this.setTransitionDurationOnAll("");var i=this.getItems(),r=n>this.queuedIndex,u=this.parseTransitionDurationToMS($ts.getComputedStyle(i[this.queuedIndex],"transition-duration")),f=Math.abs(n-this.queuedIndex),e=Math.round(u/f/2)+"ms",t=this;for(this.disableTransitions(!1),this.setTransitionTimingFunctionAll("linear");t.queuedIndex!==n;)r?t.mapRotatorClasses(t.queuedIndex+1,!1,t.queuedIndex+1!=n):t.mapRotatorClasses(t.queuedIndex-1,!0,t.queuedIndex-1!=n)}}},shouldRenderAsMarquee:function(){var n=this;return n.settings.touchOptimized?!1:n.shouldAutoRotate()&&n.settings.transitionDuration>n.settings.autoDuration},setOffsetStart:function(){var n,t,i,r;if(!this.settings.touchOptimized&&this.settings.startOffset!=0)for(n=this.settings.startOffset;n!=0;){if(t=$elms('[data-listrotatorid="'+this.id+'"] .'+this.settings.itemClass),t.length<3)break;if(t.lenght<n)break;i=t[0];r=t[t.length-1];n>0?(r.parentNode.insertBefore(i,r.nextSibling),n--):n<0&&(i.parentNode.insertBefore(r,i),n++)}},changeResponsiveMode:function(n){this.init(n)}};$ts.Observer.Register("Tangora.Layout","ResponsiveBreakpoint",function(t,i,r){for(var u=0;u<n.length;u++)n[u].changeResponsiveMode(r.responsivemode)});window.ListRotator=i}}(),function(){function n(){function r(n,t){var u="outside",f="outside",i,r;return t=="viewport"&&(t={},t.top=0,t.left=0,t.bottom=window.innerHeight||document.documentElement.clientHeight,t.right=window.innerWidth||document.documentElement.clientWidth),i=t,r=n.getBoundingClientRect(),r.left>=i.left&&r.right<=i.right?u="contained":r.left<=i.left&&r.right>=i.right?u="covers":r.left<=i.left&&r.right>=i.left?u="overlap-left":r.left<=i.right&&r.right>=i.right&&(u="overlap-right"),r.top>=i.top&&r.bottom<=i.bottom?f="contained":r.top<=i.top&&r.bottom>=i.bottom?f="covers":r.top<=i.top&&r.bottom>=i.top?f="overlap-top":r.top<=i.bottom&&r.bottom>=i.bottom&&(f="overlap-bottom"),{x:u,y:f}}function t(){var e,f;for(i&&u(),e=0;e<n.length;e++){var t=n[e],o=r(t.element,t.targetRect),s=o.x=="outside"||o.y=="outside",h=t.stateX=="outside"||t.stateY=="outside";s&&!h?t.targetRect=="viewport"&&(f={trigger:t.element},Tangora.Layout.AddBlocklistIndexArguments(t.element,f),$ts.Observer.Broadcast(t.senderId,"OutsideViewport",f)):!s&&h&&t.targetRect=="viewport"&&(f={trigger:t.element},Tangora.Layout.AddBlocklistIndexArguments(t.element,f),$ts.Observer.Broadcast(t.senderId,"InsideViewport",f));t.stateX=o.x;t.stateY=o.y}}function u(){var n=document.body.scrollLeft||document.documentElement.scrollLeft,t=document.body.scrollTop||document.documentElement.scrollTop;$ts.Observer.Broadcast("TangoraPage","OnScroll",{x:n,y:t})}var n=[],i=!1;this.Register=function(t,i){function u(u){for(var o,f,e=0;e<n.length;e++)if(n[e].element==u&&n[e].targetRect==i)return;o=r(u,i);n.push({senderId:t,element:u,targetRect:i,stateX:o.x,stateY:o.y});o.x=="outside"||o.y=="outside"?i=="viewport"&&(f={trigger:u},Tangora.Layout.AddBlocklistIndexArguments(u,f),$ts.Observer.Broadcast(t,"OutsideViewport",f)):i=="viewport"&&(f={trigger:u},Tangora.Layout.AddBlocklistIndexArguments(u,f),$ts.Observer.Broadcast(t,"InsideViewport",f))}var f=$elm("#"+t);f?u(f):$chain("."+t).each(function(n){u(n)})};this.RegisterPageScroll=function(){i=!0};$ts.addEvent(window,"scroll",t);$ts.addEvent(window,"resize",t);$ts.Observer.Register("Tangora.Layout","ResponsiveBreakpoint",t)}window.tsScrollEventManager=new n}(),function(){function n(){function t(t,i){for(var r,f,u;t&&!n.some(function(n){return(n.elementid==t.id||$ts.hasClass(t,n.elementid))&&n.event==i});)t=t.parentNode;if(r=null,t&&(r=t.id,!n.some(function(n){return n.elementid==r&&n.event==i})))for(f=t.className.split(" "),u=0;u<f.length;u++)if(n.some(function(n){return n.elementid==$ts.trim(f[u])&&n.event==i})){r=$ts.trim(f[u]);break}return{element:t,sender:r}}function r(n){var i=t(n.currentTarget||n.target,"click"),r;i.sender&&(r={event:n,trigger:i.element},Tangora.Layout.AddBlocklistIndexArguments(i.element,r),$ts.Observer.Broadcast(i.sender,"OnClick",r))}function u(n){var i=t(n.currentTarget||n.target,"mouseover"),r;i.sender&&(r={event:n,trigger:i.element},Tangora.Layout.AddBlocklistIndexArguments(i.element,r),$ts.Observer.Broadcast(i.sender,"OnMouseOver",r))}function f(n){var i=t(n.currentTarget||n.target,"mouseout"),r;i.sender&&(r={event:n,trigger:i.element},Tangora.Layout.AddBlocklistIndexArguments(i.element,r),$ts.Observer.Broadcast(i.sender,"OnMouseOut",r))}var n=[],i=[{event:"click",handler:r},{event:"mouseover",handler:u},{event:"mouseout",handler:f}];this.Register=function(t,r){function u(n){var t=i.filter(function(n){return n.event==r})[0].handler;$ts.removeEvent(n,r,t);$ts.addEvent(n,r,t)}if(!i.some(function(n){return n.event==r}))throw new Error("The event type is not supported in tsMouseEventManager");n.some(function(n){return n.elementid==t&&n.event==r})||n.push({elementid:t,event:r});$elm("#"+t)?u($elm("#"+t)):$chain("."+t).each(function(n){u(n)})}}window.tsMouseEventManager=new n}(),function(){var n=/applewebkit/i.test(navigator.userAgent)&&!/chrome/i.test(navigator.userAgent)&&!/edge/i.test(navigator.userAgent),t=/firefox/i.test(navigator.userAgent);n||t||$ts.ready(function(){function f(){return $elm('#TangoraViewData > [id^="blocklistlayout_"][id$="_2"]')}function s(){return $elm('[id^="modulelayout"][id$="_1"]')}function r(n){var i=JSON.parse(sessionStorage.getItem("bfcache")||"[]"),t=i.filter(function(t){return t.page==n})[0];return t?t.value:null}function u(n,t){var i=JSON.parse(sessionStorage.getItem("bfcache")||"[]"),r=i.filter(function(t){return t.page==n})[0];r?r.value=t:i.push({page:n,value:t});sessionStorage.setItem("bfcache",JSON.stringify(i))}function h(){sessionStorage.removeItem("bfcache")}var o,t;if(typeof skipBFCachePolyfill=="undefined"||!skipBFCachePolyfill){var n=null,i=f(),e=s();i&&/blocklistlayout_(\d+)_2/.test(i.id)?(n=RegExp.$1,t=r(n),o=window.performance&&window.performance.navigation.type==window.performance.navigation.TYPE_BACK_FORWARD,t&&t.detail&&o?(console.log("Blocklist content is loaded by bfcache-polyfill (v2)."),"scrollRestoration"in history&&(history.scrollRestoration="manual"),i.innerHTML=t.content,t.detail=!1,setTimeout(function(){window.scrollTo(0,t.scroll)},1),$ts.Observer.RegisterOneShot("Tangora.ListUtils","AfterInitListPageStuff",function(){Tangora.ListUtils.scrollPageNumber=t.pagenumber;t.eventsargs&&Tangora.Observer.Broadcast("List","AfterAutoFetch",t.eventargs)})):t={scroll:0,detail:!1,content:i.innerHTML,eventargs:null,pagenumber:1},u(n,t)):e&&/modulelayout(\d+)_1/.test(e.id)?(n=RegExp.$1,t=r(n),t&&(t.detail=!0,u(n,t))):h();$ts.Observer.Register("*","AfterAutoFetch",function(t,e,o){if(n&&i){var s=r(n);s.content=f().innerHTML;s.eventargs=o;s.pagenumber=Tangora.ListUtils.scrollPageNumber;u(n,s)}});$ts.Observer.Register("*","AfterAutoFilter",function(){if(n&&i){var t=r(n);t.content=f().innerHTML;t.pagenumber=Tangora.ListUtils.scrollPageNumber;u(n,t)}});$ts.addEvent(window,"scroll",function(){if(n&&i){var t=r(n);t.scroll=window.scrollY;u(n,t)}})}})}();// tangora.public.list.min.js
function TangoraListUtils(){function y(n,t){var i=[],u,r;for(u in f[n])i.push(f[n][u]);if(i&&i.length>0)for(r=0;r<i.length;r++)(function(n){n.func(function(r){n.done=r;for(var u=0;u<i.length;u++)if(i[u].done!==!0)return;t()})})(i[r]);else t()}function p(n,t){for(var i=typeof n=="String"?document.getElementById(n):n,r=0;i&&i.nodeName.toUpperCase()!="BODY";)r+=parseInt(t=="top"?i.offsetTop:i.offsetLeft),i=i.offsetParent;return r}var s=0,i=null,n="",r="",c=0,l=0,e=0,v=0,u=!1,f={},b,a,h,d,o;this.positionUrl=function(n,t){this.saveScrollPosition();$spa.enabled&&$spa.supported()?$spa.register(n+"&savedscrolltop"+t+"="+e):location.href=n+"&savedscrolltop"+t+"="+e};this.inlineEditMode=function(n,t,i,r,u){this.inlineEditMode2(n,t,i,r,u,"",0)};this.inlineEditMode2=function(t,i,u,f,e,o,h){function k(n){return w=$ts.getContentWidth(n),w=w-4,Math.round(w)}var p,l,y,a,v,d,b,c;Tangora.ListUtils.clearWarningsIgnored(u,f);eventArgs={};eventArgs.pageid=t;eventArgs.recordid=f;eventArgs.fieldid=0;try{p=arguments.callee.caller.arguments[0].target}catch(g){p=null}for(eventArgs.trigger=p,$ts.Observer.Broadcast("ListEditing","BeforeEdit",eventArgs),$ts.Observer.Broadcast("List","BeforeEdit",eventArgs),this.saveScrollPosition(),l="",y=$elms('*[class="layoutfieldwrapper"]',document),a=0;a<y.length-1;a++)c=y[a],c.id.indexOf("layout"+t+"sub1mergefield")!=-1?(v=c.id.replace("layout"+t+"sub1mergefield",""),v.indexOf("_")==-1&&(l=l+v+"[]"+c.offsetHeight+"[]"+k(c)+";")):c.id.indexOf("tangoravalue_")==0&&(v=c.id.replace("tangoravalue_",""),l=l+v+"[]"+c.offsetHeight+"[]"+k(c)+";");for(y=document.getElementsByTagName("td"),a=0;a<y.length-1;a++)c=y[a],c.id.indexOf("tangora_tablecell_")==0&&c.id.lastIndexOf("_"+f)==c.id.length-String(f).length-1&&(v=c.id.replace("tangora_tablecell_",""),v.indexOf("0_0_")==-1&&(l=l+v+"[]"+c.offsetHeight+"[]"+k(c)+";"));s=t;this.hideEditButtons();d="editrecord";f==0&&(d="createrecord");b=0;f==0&&(c=document.getElementById("modulelayout"+t+"_1"),c==null&&(c=document.getElementById("TangoraRecord_"+t+"_"+f)),c==null&&(c=document.getElementById("blocklistlayout_"+t+"_2")),c==null&&(c=document.getElementById("tangora_tablerow_"+t+"_"+f)),c==null&&(c=document.getElementById("TangoraRecords_"+t)),c==null&&(c=document.getElementById("layout"+t+"sub11mergefield3"),c&&c.innerHTML.indexOf("tangora_tablerow_")==-1&&(c=null)),c==null&&(b=1));$ts.ajax({url:"/listediting.ashx?action="+d+"&pageid="+t+"&layoutid="+i+"&listid="+u+"&recordid="+f+"&fielddefs="+l+"&firstrecord="+b+this.filterUrl+"&copyrecordid="+h+o,async:"false",type:"GET",complete:function(i,u){var v,g,c,ut,nt,ft,a,l,h,y,w,d,tt,it,et;u==""&&location.reload();var o,s=u.split("#|#|#")[0],ot=u.split("#|#|#")[1],k="",rt=0;if(u.split("#|#|#").length>=3&&(k=u.split("#|#|#")[2]),u.split("#|#|#").length>=4&&(rt=u.split("#|#|#")[3]),v=document.getElementsByTagName("head")[0],k&&k!=""&&(g=!1,c=document.getElementById("tangora_editing_css"),c==null&&(c=$ts.top().$ts.createElement("style",{type:"text/css"}),c.id="tangora_editing_css",g=!0),c.styleSheet?c.styleSheet.cssText=k:(ut=$ts.top().document.createTextNode(k),c.appendChild(ut)),g&&v.appendChild(c)),nt=!1,b==0){if(o=document.getElementById("modulelayout"+t+"_1"),o==null&&(o=document.getElementById("TangoraRecord_"+t+"_"+f)),o==null&&(o=document.getElementById("blocklistlayout_"+t+"_2"),o&&f==0&&(nt=!0),e==2&&(ft=document.getElementById("blocklistlayout_"+t+"_10"),ft)))for(o=null,l=document.getElementsByClassName("layout"+t+"sub10mergefield_2"),h=l.length-1;h>=0&&o==null;h--)a=l[h],a.childNodes[0]&&a.childNodes[0].childNodes[0]&&(a=a.childNodes[0].childNodes[0]),a&&a.id=="blocklistlayout_"+t+"_2"&&(o=a);if(o==null&&(o=document.getElementById("tangora_tablerow_"+t+"_"+f)),o==null&&(o=document.getElementById("TangoraRecords_"+t)),o==null&&(o=document.getElementById("layout"+t+"sub11mergefield3"),o))if(l=o.getElementsByTagName("TABLE"),e==2)for(o=null,h=l.length-1;h>=0&&o==null;h--)y=l[h],y.innerHTML.indexOf("tangora_tablerow_")!=-1&&(o=y);else if(e==1)for(o=null,h=0;h<l.length&&o==null;h++)y=l[h],y.innerHTML.indexOf("tangora_tablerow_")!=-1&&(o=y);n=o.id;r=o.outerHTML;nt?e==2?o.innerHTML+=s:e==1&&(o.innerHTML=s+o.innerHTML):o.tagName=="TR"||o.tagName=="TABLE"?Tangora.ListUtils.splitHtmlInCells(o,s,e):(o.outerHTML=s,n=s.split(' id="')[1].split('"')[0]);Tangora.Layout.Resize()}else w=document.getElementById("tangoraformhelper"+t),s!=null&&s.length>0&&(d=s.lastIndexOf("\r\n<\/table>"),d!=-1&&s.length-10==d&&(s=s.substring(0,d)),s.indexOf("<tr")==0&&w.parentNode.tagName.toLowerCase()=="div"&&(s="<table>"+s+"<\/table>")),e==1?w.parentNode.innerHTML=s+w.parentNode.innerHTML:w.parentNode.innerHTML+=s,rt==1&&v.innerHTML.indexOf("/setup/layoutpanels/general.css")==-1&&(tt=$ts.top().$ts.createElement("link",{rel:"stylesheet"}),tt.href="/setup/layoutpanels/general.css",it=v.getElementsByTagName("style"),et=it.length>0?it[0]:null,v.insertBefore(tt,et)),o=w;v.appendChild($ts.top().$ts.createElement("script",{type:"text/javascript",text:ot}));eventArgs={};eventArgs.pageid=t;eventArgs.recordid=f;eventArgs.fieldid=0;eventArgs.trigger=p;eventArgs.mutatedObject=o;n&&(eventArgs.mutatedObject=$elm(n));$ts.Observer.Broadcast("ListEditing","AfterEdit",eventArgs);$ts.Observer.Broadcast("List","AfterEdit",eventArgs)}})};this.registerPrePostFunc=function(n,t,i){var r,t;f[n]||(f[n]={});r=!0;for(t in f[n])f[n][t].func==i&&(r=!1);r&&(f[n][t]={done:!1,func:i})};this.SaveRecord=function(t,r,f,o,s,h,a,v,p){function w(n,t){var r,i,u,o,f;for(n.indexOf("editkey=")!=-1&&(i=n.indexOf("editkey="),r=n.indexOf("&",i),n=n.replace(n.substring(i,r+1),"")),i=n.indexOf("savedscrolltop"),u=0;i!=-1&&u<10;)r=n.indexOf("&",i),n=r==-1?n.substring(0,i-1):n.substring(0,i)+n.substring(r+1),i=n.indexOf("savedscrolltop"),u=u+1;return o=n.split("#")[0],f="",n.indexOf("#")!=-1&&(f=n.split("#")[1]),n=o,n+=n.indexOf("?")==-1?"?":"&",n+="savedscrolltop"+t+"="+e,f!=""&&(n+="#"+f),n}function k(n,t,i,r){for(var h,e,u,a,c,s,v,y,o,l,w,p=$elms('*[class="formreq"]',document),f=0;f<p.length;f++)u=p[f],$ts.UI.EditorUtils.isNodeInNode(u,t)&&$ts.removeClass(u,"formreq");for(h=n.split("[FIELDS]")[1].split("[/FIELDS]")[0],f=0;f<h.split("][").length;f++)if(e=h.split("][")[f],e&&e!=""){if(u=$elm("#"+e+"_QS"),u==null&&(u=document.getElementById(e)),!u&&(a=document.getElementsByName(e),a.length>0))for(u=a[0],c=$elms("div[.choicegroup]"),s=0;u&&s<c.length;s++)$ts.UI.EditorUtils.isNodeInNode(u,c[s])&&($ts.addClass(c[s],"formreq"),u=null);u&&(v=$elm('label[class="uploadControl"][for="'+e+'"]'),v?$ts.addClass(v,"formreq"):$ts.addClass(u,"formreq"))}if(y=n.indexOf("[WARNING]1[/WARNING]")!=-1,y||(o={},o.pageid=i,o.recordid=r,o.errorFieldIds=h,o.trigger=b,$ts.Observer.Broadcast("ListEditing","ValidationError",o)),n.indexOf("[ERRORTEXT]")!=-1&&(l=n.split("[ERRORTEXT]")[1].split("[/ERRORTEXT]")[0],l!=""))if(y){if(w=confirm(l),w)return n.split("[VALIDATIONID]")[1].split("[/VALIDATIONID]")[0]}else alert(l)}function g(){var g=document.getElementById("tangoraformhelper"+t),y,nt;g&&!a?(y=v&&v!=0?document.getElementById("tangora_tablerow_"+v+"_"+t+"_"+o+"_"+f):document.getElementById("tangora_tablerow_"+t+"_"+o+"_"+f),y?(nt=-(Number(o*100)+Number(c*10)),g.action="/listediting.ashx?action=saverecord&pageid="+t+"&listid="+r+"&recordid="+f+"&fieldid="+o+"&layoutid="+nt+"&primaryrecordid="+l+"&saverefreshtype="+s+"&copyrecordid="+p):(g.action="/listediting.ashx?action=saverecord&pageid="+t+"&layoutid=2&listid="+r+"&recordid="+f+"&saverefreshtype="+s+"&copyrecordid="+p,y=document.getElementById("tangora_tablerow_"+t+"_"+f),y==null&&(y=document.getElementById("TangoraRecord_"+t+"_"+f),y&&$elms("input",y).length==0&&y.getElementsByTagName("select").length==0&&(y=null))),y!=null?(d.moveControls(y,g),$ts.ajaxPostForm($elm('form[name="tangoraformhelper'+t+'"]'),function(e,c){if($ts.UI.BusyView.Clear(!0),c=="")location.reload();else if(c.indexOf("[]ERROR[]")==0){var l=k(c,y,t,f);l&&l!=0&&(Tangora.ListUtils.addWarningIgnored(r,f,l),Tangora.ListUtils.SaveRecord(t,r,f,o,s,h,a,v,p))}else c.indexOf("SYSMSG:")==0?alert(c.split("SYSMSG:")[1]):(c=c.split("%!%")[0],s==0||f==0?(f==0||location.href.indexOf("editkey=")!=-1)&&o==0?Tangora.ListUtils.embeddedPage?$spa.enabled&&$spa.supported()?$spa.register(w(location.href,t)):location.href=w(location.href,t):$spa.enabled&&$spa.supported()?$spa.register(w("/page"+t+".aspx",t)):location.href=w("/page"+t+".aspx",t):$spa.enabled&&$spa.supported()?$spa.register(w(location.href,t)):location.href=w(location.href,t):(y.tagName=="TR"?Tangora.ListUtils.splitHtmlInCells(y,c):y.outerHTML=c,Tangora.ListUtils.showEditButtons()),u=!1,setTimeout(function(){eventArgs={};eventArgs.trigger=b;$ts.Observer.Broadcast("ListEditing","AfterSave",eventArgs);$ts.Observer.Broadcast("List","AfterSave",eventArgs)},500),n="",i=null)},{iframed:!0})):(document.tangoraform.action.indexOf("saverefreshtype")==-1&&(document.tangoraform.action+="&saverefreshtype="+s),location.href.indexOf("fromdetailpage")!=-1&&(document.tangoraform.action+="&fromdetailpage=1"),$ts.ajaxPostForm($elm('form[name="tangoraform"]'),function(c,l){var d,g;$ts.UI.BusyView.Clear(!0);d="";l.indexOf("%!%")!=-1&&(d=l.split("%!%")[1]);d!=""?$spa.enabled&&$spa.supported()?$spa.register(d):location.href=d:(y=document.getElementById("TangoraRecord_"+t+"_"+o+"_"+f),l.indexOf("[]ERROR[]")==0?(g=k(l,y,t,f),g&&g!=0&&(Tangora.ListUtils.addWarningIgnored(r,f,g),Tangora.ListUtils.SaveRecord(t,r,f,o,s,h,a,v,p))):l.indexOf("SYSMSG:")==0?alert(l.split("SYSMSG:")[1]):(s!=0&&o!=0&&y?(y.parentElement.outerHTML=l,Tangora.ListUtils.showEditButtons(),document.getElementById("listrelation_"+o+"_1")&&LightBox.Close("listrelation_"+o+"_1")):(f==0||location.href.indexOf("editkey=")!=-1)&&o==0&&(location.href.indexOf("layoutid=1")==-1||s==2)?$spa.enabled&&$spa.supported()?$spa.register(w("/page"+t+".aspx",t),function(){$ts.UI.BusyView.Clear()}):location.href=w("/page"+t+".aspx",t):(e=window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,$spa.enabled&&$spa.supported()?$spa.register(w(location.href,t),function(){$ts.UI.BusyView.Clear()}):location.href=w(location.href.replace("&action"+t+"=editrecord",""),t)),u=!1,setTimeout(function(){eventArgs={};eventArgs.trigger=b;$ts.Observer.Broadcast("ListEditing","AfterSave",eventArgs);$ts.Observer.Broadcast("List","AfterSave",eventArgs)},500),n="",i=null))},{iframed:!0}))):$ts.ajaxPostForm($elm('form[name="tangoraform"]'),function(r,u){var h,c,a,l,e;u.indexOf("[]ERROR[]")==0?($ts.UI.BusyView.Clear(),window.setTimeout('Tangora.ListUtils.validationError("'+u+'",document.tangoraform)',500),e={},e.pageid=t,e.recordid=f,e.errorFieldIds=u.split("[FIELDS]")[1].split("[/FIELDS]")[0],e.trigger=b,$ts.Observer.Broadcast("ListEditing","ValidationError",e)):(f==0||location.href.indexOf("editkey=")!=-1)&&o==0?(u.split("%!%").length>=3&&(l=u.split("%!%")[2],e={},e.trigger=b,e.recordid=l,$ts.Observer.Broadcast("ListEditing","AfterSave",e),$ts.Observer.Broadcast("List","AfterSave",e)),s==3?$ts.UI.BusyView.Clear():(h=location.href,c=h.indexOf("editkey="),c!=-1&&(a=h.indexOf("&",c),h=a==-1?h.substring(0,c-1):h.substring(0,c)+h.substring(a)),$spa.enabled&&$spa.supported()?$spa.register(w(h,t)):location.href=w(h,t)),n="",i=null):(u.split("%!%").length>=3&&(l=u.split("%!%")[2],e={},e.trigger=b,e.recordid=l,$ts.Observer.Broadcast("ListEditing","AfterSave",e),$ts.Observer.Broadcast("List","AfterSave",e)),s==3?$ts.UI.BusyView.Clear():$spa.enabled&&$spa.supported()?$spa.register(w(location.href,t)):location.href=w(location.href,t),n="",i=null)},{iframed:!1})}var b,d;eventArgs={};eventArgs.pageid=t;eventArgs.recordid=f;eventArgs.fieldid=0;try{b=arguments.callee.caller.arguments[0].target}catch(nt){b=null}eventArgs.trigger=b;$ts.Observer.Broadcast("ListEditing","BeforeSave",eventArgs);$ts.Observer.Broadcast("List","BeforeSave",eventArgs);d=this;$ts.UI.BusyView.Show({text:h});y(t,g)};this.validationError=function(n,t){for(var f,u,r,e,o=$elms('*[class="formreq"]',document),i=0;i<o.length;i++)r=o[i],$ts.UI.EditorUtils.isNodeInNode(r,t)&&$ts.removeClass(r,"formreq");for(f=n.split("[FIELDS]")[1].split("[/FIELDS]")[0],i=0;i<f.split("][").length;i++)u=f.split("][")[i],u&&u!=""&&(r=document.getElementById(u),r&&$ts.addClass(r,"formreq"));n.indexOf("[ERRORTEXT]")!=-1&&(e=n.split("[ERRORTEXT]")[1].split("[/ERRORTEXT]")[0],e!=""&&alert(e))};this.editRelationRecord=function(t,u,f,e,o,h,a,v,y,p,w,b,k,d,g){var it,rt,ft,tt,nt,ut,et;for(eventArgs={},eventArgs.pageid=t,eventArgs.fieldid=e,eventArgs.recordid=a,$ts.Observer.Broadcast("ListEditing","BeforeEdit",eventArgs),$ts.Observer.Broadcast("List","BeforeEdit",eventArgs),this.saveScrollPosition(),it="",rt=$elms('*[class="layoutfieldwrapper"]',document),tt=0;tt<rt.length-1;tt++)nt=rt[tt],nt.id.indexOf("tangoravalue_"+e+"_")==0&&(ut=nt.id.replace("tangoravalue_",""),it=it+ut+"[]"+nt.offsetHeight+"[]"+nt.offsetWidth+";");for(ft=0,rt=document.getElementsByTagName("td"),tt=0;tt<rt.length-1&&ft<20;tt++)nt=rt[tt],nt.id.indexOf("tangora_tablecell_")==0&&(ut=nt.id.replace("tangora_tablecell_",""),it=it+ut+"[]"+nt.offsetHeight+"[]"+nt.offsetWidth+";",ft++);s=t;c=f;l=o;this.hideEditButtons();p&&p!=""&&(et=new RegExp("amp;","gi"),p=p.replace(et,"&"));$ts.ajax({url:"/listediting.ashx?action=editrelationrecord&pageid="+t+"&layoutid="+f+"&listid="+u+"&fieldid="+e+"&recordid="+o+"&layouttype="+h+"&relationrecordid="+a+"&editingtype="+v+"&fielddefs="+it+p+"&rndkey="+(new Date).getTime(),async:"false",type:"GET",complete:function(u,s){var c=s.split("#|#|#")[0],rt=s.split("#|#|#")[1],b="",ut=0,et,tt,it,ot,h,st,nt,k,p;if(s.split("#|#|#").length>=3&&(b=s.split("#|#|#")[2]),s.split("#|#|#").length>=4&&(ut=s.split("#|#|#")[3]),b&&b!=""){var p=document.getElementsByTagName("head")[0],ft=!1,l=document.getElementById("tangora_editing_css_"+e);l==null&&(l=$ts.top().$ts.createElement("style",{type:"text/css"}),l.id="tangora_editing_css_"+e,ft=!0);l.styleSheet?l.styleSheet.cssText=b:(et=$ts.top().document.createTextNode(b),l.appendChild(et));ft&&p.appendChild(l);ut==1&&p.innerHTML.indexOf("/setup/layoutpanels/general.css")==-1&&(tt=$ts.top().$ts.createElement("link",{rel:"stylesheet"}),tt.href="/setup/layoutpanels/general.css",it=p.getElementsByTagName("style"),ot=it.length>0?it[0]:null,p.insertBefore(tt,ot))}if(v==-2)LightBox.Open(c,d,g,"",rt,"","listrelation_"+e+"_"+f,w);else{if(f==2?(h=document.getElementById("TangoraRecord_"+o+"_"+t+"_"+e+"_"+a),h==null&&(h=document.getElementById("tangora_tablerow_"+o+"_"+t+"_"+e+"_"+a))):(h=document.getElementById("TangoraRecord_"+t+"_"+e+"_"+a),h==null&&(h=document.getElementById("tangora_tablerow_"+t+"_"+e+"_"+a))),h)n=h.id,r=h.outerHTML,h.tagName=="TR"?Tangora.ListUtils.splitHtmlInCells(h,c,y):h.outerHTML=c;else{if(h==null&&(h=document.getElementById("TangoraRelation_"+e)),h==null&&(h=document.getElementById("TangoraRelation_"+o+"_"+e)),h==null&&f==2)for(st=document.getElementById("TangoraRecord_"+t+"_"+o),nt=st.getElementsByTagName("div"),k=0;k<nt.length&&!h;k++)nt[k].id=="blocklistlayout_"+t+"_-"+(Number(e*100)+Number(f*10))&&(h=nt[k]);h==null&&(h=document.getElementById("blocklistlayout_"+t+"_-"+(Number(e*100)+Number(f*10))));h.childNodes.length>0&&h.childNodes[0].tagName=="TBODY"?(h=h.childNodes[0],c=c.split("[THEROW]")[1],n=f==2?"tangora_tablerow_"+o+"_"+t+"_"+e+"_0":"tangora_tablerow_"+t+"_"+e+"_0",r="NEWELEMENT",y==1||y==2?(h=h.parentNode,Tangora.ListUtils.splitHtmlInCells(h,c,y)):h.innerHTML+=c):(c=c.replace("[THEROW]",""),c=c.replace("[THEROW]",""),h.id.indexOf("TangoraRelation")!=-1&&h.innerHTML==""?(h.innerHTML+='<div id="blocklistlayout_'+t+"_-"+(e*100+f*10)+'">'+c+"<\/div>",i=h,r=""):(i=h,r=h.innerHTML,y==1?h.innerHTML=c+h.innerHTML:h.innerHTML+=c))}p=document.getElementsByTagName("head")[0];p.appendChild($ts.top().$ts.createElement("script",{type:"text/javascript",text:rt}));eventArgs={};eventArgs.pageid=t;eventArgs.fieldid=e;eventArgs.recordid=a;eventArgs.mutatedObject=h;$ts.Observer.Broadcast("ListEditing","AfterEdit",eventArgs);$ts.Observer.Broadcast("List","AfterEdit",eventArgs)}}})};this.catchDataChange=function(n){var h=document.activeElement,e,o,t,s,i,f,r;if(h&&(e=n?n:window.event,o=0,e.type=="keydown"&&(o=e.keyCode),t=h.id,t&&t!=""&&(t.indexOf("mergefield")==-1||t.indexOf("layout")==-1)&&o!=27&&(u=!0,s=document.tangoraform,s))){if(t.split("_").length==4){for(i="",f=0;f<t.split("_").length-1;f++)i!=""&&(i+="_"),i+=t.split("_")[f];t=i}r=s.tangora_editing_editedfields;r&&(";"+r.value+";").indexOf(";"+t+";")==-1&&(r.value=r.value+";"+t)}};this.cancelEditing=function(){var o,s,f,h,e;n!=""?(o=!0,u&&(s=$elms('*[class="tangorasavebutton"]',document)[0],o=!confirm(s.getAttribute("data-saveescapetext")),o||s.click()),o&&(f=document.getElementById(n),r=="NEWELEMENT"?f.parentElement.removeChild(f):f.tagName=="TR"?Tangora.ListUtils.splitHtmlInCells(f,r):f.outerHTML=r,n="",i=null,u=!1,Tangora.ListUtils.showEditButtons(),h={},$ts.Observer.Broadcast("ListEditing","EditingCancelled",h))):location.href.indexOf("editkey=")!=-1&&(e=location.href,t=e.split("editkey=")[1].split("&")[0],e=e.replace("editkey="+t+"&","").replace("editkey="+t,""),setTimeout(function(){window.location=e},500))};this.formFieldKeyDown=function(n){var r=n?n:window.event,i,t;r.keyCode==27?Tangora.ListUtils.cancelEditing():r.keyCode==13&&(i=n&&n.target?n.target:window.event.srcElement,i&&i.tagName=="INPUT"&&(t=document.getElementById("tangorasaverecord"+s),t||(t=document.getElementById("tangorasaverecord"+Tangora.ListUtils.activePageId)),t&&t.click()))};this.relevantClick=function(n){for(var r=!0,i=$elms("div[.calendarWrapper]",document),t=0;t<i.length;t++)$ts.UI.EditorUtils.isNodeInNode(n,i[t])&&(r=!1);if(r)for(i=$elms("div[.lbContentsWrapper]",document),t=0;t<i.length;t++)$ts.UI.EditorUtils.isNodeInNode(n,i[t])&&(r=!1);return r};this.documentClick=function(t){var w,d,e,b,a,v,k,h,c;if(n&&n!=""||i!=null){var y=0,g=!1,f=t&&t.target?t.target:window.event.srcElement,p=i;n&&!i?(p=document.getElementById(n),i=p):p!=null&&(n=p.id);p&&!$ts.UI.EditorUtils.isNodeInNode(f,p)&&Tangora.ListUtils.relevantClick(f)&&(w=!0,e=$elms('*[class="tangorasavebutton"]',document)[0],e||(e=document.getElementById("tangorasaverecord"+s)),e.getAttribute("data-savecanceltype")!=""&&(y=e.getAttribute("data-savecanceltype")),u&&(g=!0,y==0&&(w=e.getAttribute("data-saveescapetext")==""||!confirm(e.getAttribute("data-saveescapetext")),w||e.click())),w&&y==0&&(h=document.getElementById(n),h&&h.parentElement&&h.parentElement.tagName.toLowerCase()=="form"&&(h=h.parentElement),r=="NEWELEMENT"?h.parentElement.removeChild(h):h.tagName=="TR"?Tangora.ListUtils.splitHtmlInCells(h,r):$ts.Observer.Broadcast("SPA","BeforeLoad",null),n="",Tangora.ListUtils.showEditButtons(),b={},$ts.Observer.Broadcast("ListEditing","EditingCancelled",b)));i==null||$ts.UI.EditorUtils.isNodeInNode(f,i)||(d=Tangora.ListUtils.relevantClick(f),d&&!g&&u&&(c=$elms('*[class="tangorasavebutton"]',document),c&&c.length!=0||(c=$elms("input[.tangorasavebutton]",document)),e=null,c&&c.length>0&&(e=c[0]),e&&e.getAttribute("data-savecanceltype")!=""&&(y=e.getAttribute("data-savecanceltype")),e&&y==0&&e.getAttribute("data-saveescapetext")!=""&&(w=!confirm(e.getAttribute("data-saveescapetext")),w||e.click())),d&&y==0&&(i.innerHTML=r,i=null,Tangora.ListUtils.showEditButtons(),b={},$ts.Observer.Broadcast("ListEditing","EditingCancelled",b)))}else if(Tangora.ListUtils.editRecordOnClick&&Tangora.ListUtils.editRecordOnClick!=""){var f=t&&t.target?t.target:window.event.srcElement,o=!1,l=!1;for(f.tagName=="A"&&(o=!0);f&&!o&&!l;){if(f.id&&f.id!=""&&f.id.indexOf("tangora_tablerow_")==0&&f.id.split("_").length==4&&(a=f.id.replace("tangora_tablerow_",""),v=a.split("_")[0],(","+Tangora.ListUtils.editRecordOnClick+",").indexOf(","+v+",")!=-1?l=!0:o=!0),l||o||!f.id||f.id==""||f.id.indexOf("TangoraRecord")!=0||f.id.split("_").length!=3||(a=f.id.replace("TangoraRecord_",""),v=a.split("_")[0],(","+Tangora.ListUtils.editRecordOnClick+",").indexOf(","+v+",")!=-1?l=!0:o=!0),!l&&!o&&f.id&&f.id!=""&&f.id.indexOf("modulelayout")==0&&f.id.split("_").length==2&&f.id.split("_")[1]!="5"){if(a=f.id.replace("modulelayout",""),v=a.split("_")[0],(","+Tangora.ListUtils.editRecordOnClick+",").indexOf(","+v+",")!=-1)for(c=$elms('*[class="TangoraEditButton"]',document),k=0;k<c.length&&!o;k++)h=c[k],h.href.indexOf("inlineEditMode ("+v+",")!=-1&&(o=!0,document.getElementById("modulelayout"+v+"_11")==null&&h.click());o=!0}if(f.id&&f.id!=""&&f.id.indexOf("tangora_tablerow_")==0&&f.id.split("_").length==5){var a=f.id.replace("tangora_tablerow_",""),v=a.split("_")[0],nt=a.split("_")[1];(","+Tangora.ListUtils.editRecordOnClick+",").indexOf(","+v+"_"+nt+",")!=-1?l=!0:o=!0}if(!l&&!o&&f.id&&f.id!=""&&f.id.indexOf("TangoraRecord")==0&&f.id.split("_").length==4){var a=f.id.replace("TangoraRecord_",""),v=a.split("_")[0],nt=a.split("_")[1];(","+Tangora.ListUtils.editRecordOnClick+",").indexOf(","+v+"_"+nt+",")!=-1?l=!0:o=!0}l||o||(f=f.parentElement);f&&f.id&&f.id.indexOf("modulelayout")!=-1&&f.id.split("_").length==2&&f.id.split("_")[1]==11&&(o=!0)}l&&(c=$elms('*[class="TangoraEditButton"]',f),c.length==1&&c[0].click())}};this.moveControls=function(n,t){for(var r,u,f,e,i,o;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);for(r=$elms("input",n),i=0;i<r.length;i++)r[i].type=="file"?t.appendChild(r[i]):(Tangora.DOM.CloneElement(r[i],t),r[i].type=="checkbox"&&(document.getElementById(r[i].id+"_1").value=r[i].value,document.getElementById(r[i].id+"_1").checked=r[i].checked));for(u=n.getElementsByTagName("select"),i=0;i<u.length;i++)if(u[i].id!="")for(Tangora.DOM.CloneElement(u[i],t),o=document.getElementById(u[i].id+"_1"),f=0;f<u[i].options.length;f++)o.options[f].selected=u[i].options[f].selected;for(e=n.getElementsByTagName("textarea"),i=0;i<e.length;i++)Tangora.DOM.CloneElement(e[i],t),o=document.getElementById(e[i].id+"_1"),o.value=e[i].value};this.saveScrollPosition=function(){v=window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;e=window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop};this.hideEditButtons=function(){for(var t=$elms('*[class="TangoraEditButton"]',document),n=0;n<t.length;n++)t[n].style.visibility="hidden";for(t=$elms('*[class="TangoraCreateButton"]',document),n=0;n<t.length;n++)t[n].style.visibility="hidden";for(t=$elms('*[class="actionlink TangoraCreateButton"]',document),n=0;n<t.length;n++)t[n].style.visibility="hidden";for(t=$elms('*[class="TangoraDeleteButton"]',document),n=0;n<t.length;n++)t[n].style.visibility="hidden"};this.showEditButtons=function(){for(var t=$elms('*[class="TangoraEditButton"]',document),n=0;n<t.length;n++)t[n].style.visibility="visible";for(t=document.getElementsByClassName("TangoraCreateButton"),n=0;n<t.length;n++)t[n].style.visibility="visible";for(t=$elms('*[class="TangoraDeleteButton"]',document),n=0;n<t.length;n++)t[n].style.visibility="visible"};this.splitHtmlInCells=function(n,t,i){var e=n,v=!1,r,o,u,s,c,f,a,l,h;for(t.indexOf("<TD")!=-1&&(r=new RegExp("<TD","g"),t=t.replace(r,"<td"),r=new RegExp("<\/TD>","g"),t=t.replace(r,"<\/td>"),r=new RegExp("<TR","g"),t=t.replace(r,"<tr"),r=new RegExp("<\/TR>","g"),t=t.replace(r,"<\/tr>")),n.tagName=="TABLE"&&(i==1?(o=0,n.rows.length>0&&n.rows[0].innerHTML.indexOf("<th")==0&&(o=1),o==n.rows.length&&(o=-1),e=n.insertRow(o)):e=n.insertRow(-1),t.indexOf("<tr id=")==0&&(u=t.split("<tr id=")[1].split(">")[0],u=u.indexOf(" ")!=-1?u.substring(1,u.indexOf(" ")-1):u.substring(1,u.length-1),e.id=u),v=!0),s=t.indexOf("<td"),c=0;s!=-1;)j=t.indexOf(">",s),f=t.indexOf("<table",j),k=t.indexOf("<\/td>",j),f!=-1&&f<k&&(f=t.indexOf("<\/table>",f),k=t.indexOf("<\/td>",f)),a=t.substring(j+1,k),v?(l=e.insertCell(-1),l.innerHTML=a,h=t.substring(s,j),h.indexOf(" valign='")!=-1&&(l.valign=h.split(" valign='")[1].split("'")[0]),h.indexOf(" align='")!=-1&&(l.align=h.split(" align='")[1].split("'")[0])):e.cells[c].innerHTML=a,c=c+1,s=t.indexOf("<td",k)};this.TangoraViewDataScrollReset=function(){Tangora.ListUtils.scrollPageNumber=1;Tangora.ListUtils.recordCount>Tangora.ListUtils.scrollPageSize&&(Tangora.ListUtils.scrollReady=!0,Tangora.ListUtils.TangoraViewDataScroll())};this.TangoraViewDataScrollFromLoad=function(){Tangora.ListUtils.TangoraViewDataScroll(!0)};this.TangoraViewDataScroll=function(){Tangora.ListUtils.TangoraViewDataScroll(!0,!1,!1)};this.TangoraViewDataScroll=function(n,t,i){var r,f,s,v,e,h,c,l,a,o;if((t||!this.autoFetchDisabled&&!Tangora.ListUtils.autoFetchDisabled)&&(r=document.getElementById("TangoraViewData"),window.pageYOffset?(f=window.pageYOffset,s=window.innerHeight):(f=document.body.scrollTop,f==0&&document.documentElement&&(f=document.documentElement.scrollTop),s=window.innerHeight?window.innerHeight:document.documentElement.clientHeight),v=f,t||r&&Tangora.ListUtils.scrollReady===!0&&f+s>=p(r,"top")+r.clientHeight&&(!Tangora.ListUtils.lastGroupValue||Tangora.ListUtils.lastGroupValue!="ISEOF"))){e="List";Tangora.ListUtils.scrollModuleId==2&&(e="News");Tangora.ListUtils.scrollModuleId==15&&(e="EventCalendar");eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;$ts.Observer.Broadcast(e,"BeforeAutoFetch",eventArgs);Tangora.ListUtils.scrollReady=!1;h="<p style='text-align:center;margin-top:0px;margin-bottom:0px;padding:0px'><img src='"+Tangora.ListUtils.loadingImage+"'><\/p>";r.innerHTML+=h;Tangora.ListUtils.scrollPageNumber+=1;var y=i?1:0,u=Tangora.ListUtils.lastGroupValue,c=new RegExp("&","gi");if(u=u.replace(c,"%26"),c=new RegExp("#","gi"),u=u.replace(c,"%23"),u=encodeURI(u),l="",Tangora.ListUtils.filterUrl!=""&&Tangora.ListUtils.filterUrl.indexOf("sortfield"+Tangora.ListUtils.scrollPageId+"=")==-1){a=$ts.urlParser.Parse(location.href);for(o in a)(o=="sortfield"+Tangora.ListUtils.scrollPageId||o=="direction"+Tangora.ListUtils.scrollPageId)&&(l+="&"+o+"="+a[o])}$ts.ajax({url:"/listediting.ashx?action=autofetchdata&pageid="+Tangora.ListUtils.scrollPageId+"&pagenumber="+Tangora.ListUtils.scrollPageNumber+"&"+Tangora.ListUtils.filterUrl+l+"&moduleid="+Tangora.ListUtils.scrollModuleId+"&accumulatedrecordcount="+Tangora.ListUtils.accumulatedRecordCount+"&lastgroupvalue="+u+"&getall="+y,async:"false",type:"POST",data:{sourceurl:location.href},complete:function(t,i){var b,a,k,d,g,f,y,c,p,o,nt,ft,tt,w,it,u,et,rt,ut,s,ot,l;if(r.innerHTML=r.innerHTML.substring(0,r.innerHTML.length-h.length),Tangora.ListUtils.accumulatedRecordCount+=Number(i.split("#|#|#")[1]),Tangora.ListUtils.lastGroupValue=i.split("#|#|#")[2],b=i.split("#|#|#")[3],a=i.split("#|#|#")[4],i=i.split("#|#|#")[0],Tangora.ListUtils.showType==2&&Tangora.ListUtils.lastGroupValue=="")for(k=r.getElementsByTagName("table")[0],d=document.createElement("div"),d.innerHTML=i,g=d.childNodes[0],u=0;u<g.rows.length;u++)for(f=g.rows[u],y=k.insertRow(k.rows.length),y.id=f.id,y.className=f.className,c=0;c<f.cells.length;c++)p=y.insertCell(y.cells.length),p.innerHTML=f.cells[c].innerHTML,p.id=f.cells[c].id,p.align=f.cells[c].align,p.vAlign=f.cells[c].vAlign;else if(o=document.getElementById("blocklistlayout_"+Tangora.ListUtils.scrollPageId+"_10"),o==null&&(o=document.getElementById("blocklistlayout_"+Tangora.ListUtils.scrollLayoutPageId+"_2")),o)if(nt=$elms("#"+o.id+' > *[class="flexspacer"]',o),nt.length>0)for(ft=new RegExp('<div class="flexspacer"><\/div>',"gi"),i=i.replace(ft,""),tt=document.createElement("DIV"),tt.innerHTML=i,w=tt.childNodes,it=w.length,u=0;u<it;u++)et=w.length<it?w[0]:w[u],o.insertBefore(et,nt[0]);else o.innerHTML+=i;else r.innerHTML+=i;rt=document.getElementsByTagName("head")[0];a&&a!=""&&(ut=!1,s=document.getElementById("tangora_autofetch_css"),s==null&&(s=$ts.top().$ts.createElement("style",{type:"text/css"}),s.id="tangora_autofetch_css",ut=!0),s.styleSheet?s.styleSheet.cssText=a:(ot=$ts.top().document.createTextNode(a),s.appendChild(ot)),ut&&rt.appendChild(s));b&&b!=""&&rt.appendChild($ts.top().$ts.createElement("script",{type:"text/javascript",text:b}));document.getElementById("q")&&highlightSearchwords();Tangora.Layout.Resize();Tangora.Layout.Retinize();Tangora.ListUtils.scrollPageNumber*Tangora.ListUtils.scrollPageSize<Tangora.ListUtils.recordCount&&Tangora.ListUtils.lastGroupValue!="#EOF#"&&(Tangora.ListUtils.scrollReady=!0);eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;var st=$ts.urlParser.Parse(location.href),ct=location.pathname+"?",ht="";for(l in st)l.indexOf("doshow")>-1||l.indexOf("pagenumber")>-1||l!=""&&(ht+="&"+l+"="+st[l]);eventArgs.url=location.pathname+"?doshow"+Tangora.ListUtils.scrollPageId+"=1&pagenumber"+Tangora.ListUtils.scrollPageId+"="+Tangora.ListUtils.scrollPageNumber+ht;eventArgs.scrollTop=v;$ts.Observer.Broadcast(e,"AfterAutoFetch",eventArgs);n&&Tangora.ListUtils.TangoraViewDataScrollFromLoad()}})}};this.getData=function(n,t){return $ts.ajax({url:"/listediting.ashx?action=autofetchdata_specific&pageid="+Tangora.ListUtils.scrollPageId+"&fromindex="+n+"&count="+t+"&"+Tangora.ListUtils.filterUrl,async:!1})};this.VariantPropertyChange=function(n,t,i,r,u,f,e){var pt=resolveVariantId(i),ot,d,g,tt,c,it,y,p,h,s,ct,rt,lt,at,a,vt,kt,l,w,et,o,k;if(eventArgs={},eventArgs.fieldid=n,eventArgs.recordid=i,eventArgs.variantId=pt,$ts.Observer.Broadcast("ShoppingBasket","BeforeVariantChange",eventArgs),ot=eval("productVariants_"+i),u&&u==10)for(d=f,c=document.getElementsByClassName("variantimage"),o=0;o<c.length;o++)a=c[o],a.id.indexOf(t)==0&&(a.id==t+"_"+f?a.setAttribute("class","variantimage variantimageactive"):a.setAttribute("class","variantimage variantimageinactive"));else if(r==0)d=document.getElementById(t).options[document.getElementById(t).options.selectedIndex].value;else if(r==1)for(c=document.getElementsByName(t),o=0;o<c.length;o++)c[o].checked&&(d=c[o].value);if(g="",e==1||d&&d!="0"){for(tt="",y=!1,o=0;o<productVariantFields.split(",").length;o++)if(p=productVariantFields.split(",")[o].split("=")[0],h=productVariantFields.split(",")[o].split("=")[1],y||h!=t.replace("_"+i,"")){if(y||e==1)if(s=document.getElementById(h+"_"+i),s&&s.tagName.toUpperCase()=="SELECT")for(tt+=","+p+"="+s.options[s.selectedIndex].value+",";s.options.length>1;)s.options[1]=null;else if(s&&s.tagName.toUpperCase()=="TABLE"){for(c=document.getElementsByName(h),l=0;l<c.length;l++)c[l].checked&&(tt+=","+p+"="+c[l].value+",");while(s.rows.length>0)s.deleteRow(0)}else s&&s.tagName.toUpperCase()=="SPAN"&&(c=s.getElementsByClassName("variantimageactive"),c.length==1&&(g=g+","+h+"="+c[0].id.split("_")[2]),s.innerHTML="")}else y=!0;var wt=null,b=null,st="",nt="";for(o=0;o<ot.split("||").length;o++)if(it="¤¤"+ot.split("||")[o],it.indexOf("¤¤"+n+"@@"+d)!=-1)for(y=!1,l=0;l<productVariantFields.split(",").length;l++)if(p=productVariantFields.split(",")[l].split("=")[0],h=productVariantFields.split(",")[l].split("=")[1],y||h!=t.replace("_"+i,"")){if((y||e)&&it.indexOf("¤¤"+p+"@@")!=-1&&(s=document.getElementById(h+"_"+i),s)){var bt=it.split("¤¤"+p+"@@")[1].split("||")[0],ht=bt.split("@@")[1],v=bt.split("@@")[0];if(s.tagName.toUpperCase()=="SELECT"){for(ct=!0,rt=0;rt<s.options.length;rt++)s.options[rt].value==v&&(ct=!1);ct&&(s.options[s.options.length]=new Option(ht,v),s.options[s.options.length-1].selected=tt.indexOf(","+p+"="+v+",")!=-1,(","+nt+",").indexOf(","+h+"_"+i+",")==-1&&(nt!=""&&(nt+=","),nt+=h+"_"+i))}else s.tagName.toUpperCase()=="TABLE"?(lt=Number(s.getAttribute("data-sections")),(o==0||lt!=0&&o%lt==0)&&(at=s.insertRow(s.rows.length)),at.insertCell(at.cells.length).innerHTML="<input name='"+h+"' type='radio' value='"+v+"' onclick='Tangora.ListUtils.VariantPropertyChange("+n+',"'+h+'",'+i+","+r+")' id='"+h+"_"+o+"' class='radio'><label for='"+h+"_"+o+"'>"+ht+"<\/label>"):s.tagName.toUpperCase()=="SPAN"&&st.indexOf(","+v+",")==-1&&(wt=s,w=document.createElement("a"),w.id="image_"+v,w.href="javascript:Tangora.ListUtils.VariantPropertyChange("+p+",'"+h+"_"+i+"',"+i+","+r+",10,"+v+","+e+")",a=document.createElement("img"),a.id=h+"_"+i+"_"+v,a.src=ht,vt="variantimageinactive",g&&g.indexOf(h+"=")!=-1&&(kt=g.split(h+"=")[1].split(",")[0],kt==v&&(vt="variantimageactive")),a.setAttribute("class","variantimage "+vt),w.appendChild(a),st=st+","+v+",",b||(b=[]),b.push(w))}}else y=!0;if(b){var ut=999999,ft=null,yt="";for(l=0;l<b.length;l++){for(o=0;o<b.length;o++)w=b[o],et=Number(w.id.replace("image_","")),et<ut&&yt.indexOf(","+et+",")==-1&&(ut=et,ft=w);ft&&(wt.appendChild(ft),yt=yt+","+ut+",");ut=999999;ft=null}}for(o=0;o<nt.split(",").length;o++)if(k=document.getElementById(nt.split(",")[o]),k&&k.options.length==2&&k.selectedIndex<1&&(k.options.selectedIndex=1,k.click(),e==1))k.onchange(null);Shop_UpdateMatches(i)}eventArgs={};eventArgs.fieldid=n;eventArgs.recordid=i;eventArgs.variantId=pt;$ts.Observer.Broadcast("ShoppingBasket","AfterVariantChange",eventArgs)};this.VariantResolveId=function(n,t){var i,u,r;for(j=0;j<n.split("||").length;j++){for(i=n.split("||")[j],u=!0,r=1;r<t.split("&").length;r++){var f=t.split("&")[r],e=f.split("=")[0].replace("variant",""),o=f.split("=")[1];("¤¤"+i).indexOf("¤¤"+e+"@@"+o+"@@")==-1&&(u=!1)}if(u)return i.split("@@")[i.split("@@").length-1]}return 0};b=0;this.VariantUpdateMatches=function(n,t,i,r,u,f){var e=this.VariantResolveId(t,i);this.VariantUpdateMatchesByVariantId(n,r,u,f,e)};this.VariantUpdateMatchesByVariantId=function(n,t,i,r,u){var s=!0,f;try{productVariantMatchFields=productVariantMatchFields}catch(c){s=!1}if(u==0&&s)try{for(f=0;f<productVariantMatchFields.split(",").length;f++){var e=productVariantMatchFields.split(",")[f],h=eval("masterProductPropertyValue_"+n+"_"+e),o=document.getElementById("productProperty_"+n+"_"+e);o&&h&&(o.innerHTML=h)}}catch(c){}else{if(u!=0&&s)for(f=0;f<productVariantMatchFields.split(",").length;f++){var e=productVariantMatchFields.split(",")[f],h=eval("productPropertyValue_"+u+"_"+e),o=document.getElementById("productProperty_"+n+"_"+e);if(o){try{eval("masterProductPropertyValue_"+n+"_"+e)==null&&eval("masterProductPropertyValue_"+n+"_"+e+"='"+o.innerHTML.replace(/'/gi,"\\'")+"';")}catch(c){}o.innerHTML=h}}t&&$ts.ajax({url:"/shoppinginfo.ashx?action=getuserprice&shopid="+i+"&productid="+n+"&variantid="+u,async:!0,data:null,type:"GET",complete:function(t,i){var r=document.getElementById("shopUserPrice"+n);r&&(r.innerHTML=i)}});document.getElementById("productCountContainer"+n)&&$ts.ajax({url:"/shoppinginfo.ashx?action=getstockcontrol&pageid="+r+"&productid="+n+"&variantid="+u,async:!0,data:null,type:"GET",complete:function(t,i){var r=document.getElementById("productCountContainer"+n);r&&(r.innerHTML=i,i.indexOf("<select")!=-1?$ts.removeClass(r,"productOutOfStock"):$ts.addClass(r,"productOutOfStock"))}})}Tangora.ListUtils.selectedVariantId=u};this.updateFilterControlByEvent=function(n,t,i,r,u,f){$ts.ajax({url:"/listediting.ashx?action=updatefiltercontrolbyevent&pageid="+n+"&filterId="+t+"&controlindex="+i+"&eventid="+r+"&changedfilterid="+u+"&eventvalue="+f,async:!0,data:null,type:"GET",complete:function(n,i){document.getElementById("list_filter"+t).outerHTML=i}})};this.filterChange2=function(n,t){eventArgs={};eventArgs.pageid=n;eventArgs.filterid=t;$ts.Observer.Broadcast("ListFilter_"+String(t).replace("-","MINUS"),"FilterChange",eventArgs)};this.filterChange=function(n,t,i,r){var h="List",a,o,p,w,e,b,f,s,l,v,y,g;Tangora.ListUtils.scrollModuleId==2&&(h="News");Tangora.ListUtils.scrollModuleId==15&&(h="EventCalendar");eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;$ts.Observer.Broadcast(h,"BeforeAutoFilter",eventArgs);eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;eventArgs.filterid=i;$ts.Observer.Broadcast(h+"Filter_"+i,"BeforeAutoFilter",eventArgs);$ts.UI.BusyView.Show({text:""});var k=eval("document.rediger"+n),u=k.action.replace("doshow"+n+"=1","").replace("doshow"+n+"=0",""),c=$ts.collectFormValues(k);if(c=c.replace("&pagenumber=1",""),a="",i<0){for(o=document.getElementById("list_filterMINUS"+Math.abs(i)),e=1;!o&&e<=5;)o=document.getElementById("check"+n+"_"+Math.abs(i)+"_"+e),e=e+1;o&&(a=o.name)}else o=document.getElementById("list_filter"+i),!o&&$elm("#filtercontrol_"+i)&&(p=$elm("#filtercontrol_"+i),p.firstChild&&(o=p.firstChild)),o&&(a=o.name),o||i!=99999997||(a="filter"+n);w=!1;location.href.indexOf("recordid")!=-1&&(u=location.href,a!=""&&(e=u.indexOf("&"+a+"="),e!=-1&&(b=u.indexOf("&",e+1),u=(b=-1)?u.substring(0,e):u.substring(0,e)+u.substring(b))),w=!0);var d=$ts.urlParser.Parse(location.href),nt=location.pathname+"?";for(f in d)f.indexOf("doshow")>-1||f.indexOf("pagenumber")>-1||f=="id"&&u.indexOf("?id=")>-1||(w?(f.indexOf("sortfield")>-1||f.indexOf("direction")>-1||f.indexOf("recordid")>-1)&&(f=""):(f.indexOf("sortfield")>-1&&(s=Tangora.ListUtils.scrollPageId,s||(s=f.replace("sortfield","")),u.indexOf("sortfield"+s)!=-1&&(l=u.indexOf("sortfield"+s),v=u.indexOf("&",l),u=v!=-1?u.substring(0,l)+u.substring(v+1):u.substring(0,l))),f.indexOf("direction")>-1&&(s=Tangora.ListUtils.scrollPageId,s||(s=f.replace("direction","")),u.indexOf("direction"+s)!=-1&&(l=u.indexOf("direction"+s),v=u.indexOf("&",l),u=v!=-1?u.substring(0,l)+u.substring(v+1):u.substring(0,l)))),f!="")&&decodeURIComponent(f)!=a&&(c==""||c.indexOf("&"+f+"=")==-1)&&(u.substring(u.length-1)!="?"&&u.substring(u.length-1)!="&"&&(u+="&"),u+=f+"="+d[f]);if(c!="")for(e=0;e<c.split("&").length;e++)y=c.split("&")[e],y!=""&&(g=y.split("=")[1],u.indexOf("&"+y)==-1&&(y.indexOf("id=")!=0||u.indexOf("?id=")==-1&&u.indexOf("&id=")==-1)&&(u=u+"&"+y));history&&history.pushState?$spa.supported()?$spa.register(u,function(){$ts.UI.BusyView.Clear();eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;$ts.Observer.Broadcast(h,"AfterAutoFilter",eventArgs);eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;eventArgs.filterid=i;$ts.Observer.Broadcast(h+"Filter_"+i,"AfterAutoFilter",eventArgs)}):Tangora.ListUtils.embeddedPage||(history.replaceState(location.href,""),history.pushState(u,document.title,this.href=u)):t&&(location.href=u);t&&(Tangora.ListUtils.filterUrl=c);$spa.supported()||(u+="&filterautofire=1",$ts.ajax({url:u,async:!0,data:null,type:"GET",complete:function(u,f){var l,c,nt,p,w,b,k,o,s,a,v,y,d;if(f.indexOf("RECORDURL")==0)location.href=f.split("=")[1];else if(f.split("#|#|#").length==1)location.href=location.href;else{if(Tangora.ListUtils.recordCount=f.split("#|#|#")[2],l=f.split("#|#|#")[3],c=f.split("#|#|#")[1],c&&c!=""){var g=!1,y=document.getElementsByTagName("head")[0],e=document.getElementById("tangora_autofire_css");e==null&&(e=$ts.top().$ts.createElement("style",{type:"text/css"}),e.id="tangora_autofire_css",g=!0);e.styleSheet?e.styleSheet.cssText=c:(nt=$ts.top().document.createTextNode(c),e.appendChild(nt));g&&y.appendChild(e)}f=f.split("#|#|#")[0];var it=f.split("[MASTERVIEW]")[1],rt=f.split("[MASTERNAVIGATION]")[1],ut=f.split("[MASTERRECORDCOUNT]")[1],ft=f.split("[MASTERCALC]")[1],tt=document.getElementById("listMasterView_"+n);tt&&(tt.innerHTML=it);p=document.getElementById("listMasterNavigation_"+n);p&&(p.innerHTML=rt);w=document.getElementById("listMasterRecordCount_"+n);w&&(w.innerHTML=ut);b=document.getElementById("listMasterCalc_"+n);b&&(b.innerHTML=ft);f.indexOf("[MASTERFILTER]")!=-1&&(k=f.split("[MASTERFILTER]")[1],o=document.getElementById("listMasterFilter_"+n),o&&(r&&r.filterHandler?r.filterHandler(o,k):(s=$ts.createElement("div",{innerHTML:k}),$chain("select",o).each(function(n){var t=null,i;if(t=n.id&&n.id!=""?$elm("#"+n.id,s):$elm('select[name="'+n.name+'"]',s),t){for(i=t.selectedIndex;n.firstChild;)n.removeChild(n.firstChild);while(t.firstChild)n.appendChild(t.firstChild);n.selectedIndex=i}}),$chain("span",o).each(function(n){if(n.id&&n.id!=""&&n.id.indexOf("filtercontrol_")==0){var t=$elm("#"+n.id,s);if(t){while(n.firstChild)n.removeChild(n.firstChild);while(t.firstChild)n.appendChild(t.firstChild)}}}),$chain("div",o).each(function(n){if(n.id&&n.id!=""&&n.id.indexOf("blocklistlayout_")==0){var t=$elm("#"+n.id,s);t&&(n.innerHTML=t.innerHTML)}}),s=null)));a=document.getElementById("listMasterTopStories_"+n);a&&a.parentElement.removeChild(a);v=document.getElementById("listMasterTheTopStory_"+n);v&&v.parentElement.removeChild(v);l&&l!=""&&(y=document.getElementsByTagName("head")[0],y.appendChild($ts.top().$ts.createElement("script",{type:"text/javascript",text:l})));document.getElementById("q")&&highlightSearchwords();t&&(Tangora.ListUtils.TangoraViewDataScrollReset(),Tangora.ListUtils.TangoraViewDataScrollFromLoad());Tangora.Layout.Resize();Tangora.Layout.Retinize();Tangora.Layout.RunResponsiveAssist();$ts.UI.BusyView.Clear();eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;$ts.Observer.Broadcast(h,"AfterAutoFilter",eventArgs);eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;eventArgs.filterid=i;$ts.Observer.Broadcast(h+"Filter_"+i,"AfterAutoFilter",eventArgs);$ts.Observer.Broadcast(h+"Filter_"+i,"FilterChange",eventArgs);d=document.getElementById("list_filter"+i);d&&(d.focus(),window.setTimeout('document.getElementById("list_filter'+i+'").value=document.getElementById("list_filter'+i+'").value;',100))}}}))};a=!1;h=0;this.filterDateChange=function(n,t,i,r,u){var e=!0,f=document.getElementById("list_filter"+u),o;f&&f.value!=""&&(o=Date.parse(f.value),e=String(o)!="NaN");e&&(this.filterTextChange(n,t,i,r,u),filterControlChange(u))};this.filterTextChange=function(n,t,i,r,u){return a=!0,h++,window.setTimeout("Tangora.ListUtils.filterTextChangeApply("+n+","+h+","+r+","+u+")",800),!0};this.filterTextChangeApply=function(n,t,i,r){t==h&&Tangora.ListUtils.filterChange(n,i,r)};this.changeSorting=function(n,t,i){var c="List",r,o,l,u,s,f,e,h;if(Tangora.ListUtils.scrollModuleId==2&&(c="News"),Tangora.ListUtils.scrollModuleId==15&&(c="EventCalendar"),eventArgs={},eventArgs.pageid=Tangora.ListUtils.scrollPageId,$ts.Observer.Broadcast(c,"BeforeSorting_"+t,eventArgs),$ts.UI.BusyView.Show({text:""}),r=location.href,o="asc",i?Number(t)<0&&(o="desc",t=Number(t)*-1):r.indexOf("sortfield_"+n+"="+t)!=-1&&r.indexOf("sortdirection_"+n+"=asc")!=-1?o="desc":(l=document.getElementById("TangoraSortField_"+n+"_"+t),l&&l.className&&l.className.indexOf("sortcontrol-asc")!=-1&&(o="desc")),u=0,r.indexOf("sortfield_"+n+"=")!=-1&&(u=r.split("sortfield_"+n+"=")[1].split("&")[0]),u!=0&&(r=r.replace("&sortfield_"+n+"="+u,"").replace("?sortfield_"+n+"="+u,"?").replace("&sortdirection_"+n+"=asc","").replace("&sortdirection_"+n+"=desc",""),r=r.replace("?&","?")),r=r.replace("doshow"+n+"=0","doshow"+n+"=1"),r+=r.indexOf("?")==-1?"?":"&",t!=0&&(r+="sortfield_"+n+"="+t+"&sortdirection_"+n+"="+o),r.indexOf("doshow"+n)==-1&&(r+="&doshow"+n+"=1"),u==0){for(s=$elms('*[class="sortcontrol-asc"]',document),f=0;f<s.length;f++)e=s[f],e.id&&e.id.indexOf("TangoraSortField_"+n+"_")!=-1&&(u=e.id.replace("TangoraSortField_"+n+"_",""));for(s=$elms('*[class="sortcontrol-desc"]',document),f=0;f<s.length;f++)e=s[f],e.id&&e.id.indexOf("TangoraSortField_"+n+"_")!=-1&&(u=e.id.replace("TangoraSortField_"+n+"_",""))}u==t&&(u=0);history&&history.pushState?$spa.supported()?$spa.register(r,function(){$ts.UI.BusyView.Clear();eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;$ts.Observer.Broadcast(c,"AfterSorting_"+t,eventArgs)}):history.pushState(null,document.title,this.href=r):location.href=r;Tangora.ListUtils.filterUrl!=null&&(Tangora.ListUtils.filterUrl.indexOf("&sortfield_"+n+"=")!=-1&&(h=Tangora.ListUtils.filterUrl,Tangora.ListUtils.filterUrl=h.split("&sortfield_"+n+"=")[0],h=h.split("&sortdirection_"+n+"=")[1],h.indexOf("&")!=-1&&(Tangora.ListUtils.filterUrl+="&"+h.split("&")[1])),Tangora.ListUtils.filterUrl+="&sortfield_"+n+"="+t+"&sortdirection_"+n+"="+o);r+="&filterautofire=1&oldsortfieldid="+u;$spa.supported()||$ts.ajax({url:r,async:!0,data:null,type:"GET",complete:function(i,r){var e=r.split("#|#|#")[1],v,l,s,p,h;if(e&&e!=""){var a=!1,w=document.getElementsByTagName("head")[0],f=document.getElementById("tangora_autofire_css");f==null&&(f=$ts.top().$ts.createElement("style",{type:"text/css"}),f.id="tangora_autofire_css",a=!0);f.styleSheet?f.styleSheet.cssText=e:(v=$ts.top().document.createTextNode(e),f.appendChild(v));a&&w.appendChild(f)}r=r.split("#|#|#")[0];var b=r.split("[MASTERVIEW]")[1],k=r.split("[MASTERNAVIGATION]")[1],d=r.split("[MASTERSORT]")[1],y=document.getElementById("listMasterView_"+n);y&&(y.innerHTML=b);l=document.getElementById("listMasterNavigation_"+n);l&&(l.innerHTML=k);s=document.getElementById("TangoraSortField_"+n+"_"+t);s!=null&&(s.innerHTML=d,s.className=o=="asc"?"sortcontrol-asc":"sortcontrol-desc");u!=0&&(p=r.split("[MASTERSORTOLD]")[1],h=document.getElementById("TangoraSortField_"+n+"_"+u),h!=null&&(h.innerHTML=p,h.className="sortcontrol-undefined"));Tangora.ListUtils.TangoraViewDataScrollReset();Tangora.Layout.Resize();Tangora.Layout.Retinize();Tangora.Layout.RunResponsiveAssist();$ts.UI.BusyView.Clear();eventArgs={};eventArgs.pageid=Tangora.ListUtils.scrollPageId;$ts.Observer.Broadcast(c,"AfterSorting_"+t,eventArgs)}})};this.listAction=function(n,t,i,r,u,f,e){var o={};o.pageid=n;o.actionid=t;o.recordid=i;$ts.Observer.Broadcast("List","BeforeAction",o);$ts.UI.BusyView.Show({text:""});$ts.ajax({url:"/listaction.ashx?listid="+f+"&pageid="+n+"&recid="+i+"&actionid="+t+"&md5="+r+"&rnd="+RandomName(6),async:"false",type:"GET",complete:function(n,t){var s=t,r,f,h;if(s!=""&&s.indexOf("ERROR:")==0)$ts.UI.BusyView.Clear(),$ts.Observer.Broadcast("List","AfterAction",o),alert(s.replace("ERROR:",""));else{if(e==2||e==3)location.href=s.split("###")[1];else if(e==1)for(r=s.split("###"),document.getElementById(u).outerHTML=r[0],f=1;f<r.length;f++)if(r[f].indexOf("¤¤¤")!=-1){var l=r[f].split("¤¤¤")[0],a=r[f].split("¤¤¤")[1],c=document.getElementById("actionbtn_"+i+"_"+l);c&&(c.innerHTML=a)}else h=document.getElementById(r[f].split("=")[0]),h&&(h.innerHTML=r[f].split("=")[1]);else location.reload();$ts.UI.BusyView.Clear();$ts.Observer.Broadcast("List","AfterAction",o)}}})};this.listAction_ActionSet=function(n,t,i,r,u,f){var e={};return e.pageid=n,e.actionid=t,e.recordid=i,$ts.Observer.Broadcast("List","BeforeAction",e),$ts.ajax({url:"/listaction.ashx?listid="+f+"&pageid="+n+"&recid="+i+"&actionid="+t+"&md5="+r+"&rnd="+RandomName(6),async:!1})};this.addWarningIgnored=function(n,t,i){var r=$ts.ajax({url:"/listediting.ashx?action=addwarningignored&listid="+n+"&recordid="+t+"&warningid="+i,async:!1})};this.clearWarningsIgnored=function(n,t){var i=$ts.ajax({url:"/listediting.ashx?action=clearwarningsignored&listid="+n+"&recordid="+t,async:!1})};d=0;o=0;this.deferLoadFilterControl=function(n,t,i,r,u,f,e,s,h){$ts.ajax({url:"/listaction.ashx?action=deferloadfiltercontrol",async:!0,type:"POST",data:"pageid="+n+"&fieldid="+t+"&sql="+i+"&value="+r+"&controlcount="+u+"&filterstr="+f+"&searchword="+e+"&topstoryids"+s+"&xml2xml="+h,complete:$ts.delayFunc(500,function(i,r){var u;o++;o==1&&(u={},u.pageid=n,$ts.Observer.Broadcast("List","BeforeDeferLoading",u));document.getElementById("list_filter"+t).outerHTML=r;o==Tangora.ListUtils.deferFilterControlCount&&(u={},u.pageid=n,$ts.Observer.Broadcast("List","AfterDeferLoading",u),o=0)})})}}function TangoraShoppingListUtils(){var r=!1,t=0,f=0,u,n;this.countChange=function(n,i){!i&&window.event&&(i=window.event);var u=i.keyCode?i.keyCode:i.which;return u==13&&r?(i.stopPropagation?i.stopPropagation():i.cancelBubble&&i.cancelBubble(),!1):(r=!0,t=t+1,window.setTimeout("Tangora.ShoppingListUtils.applyChange("+n+","+t+")",500),!0)};this.applyChange=function(n,i){var u,n;if(i==t&&(r=!0,orderLineId=eval("document.rediger.orderlineid"+n).value,u=eval("document.rediger.count"+n).value,(u==""||u.substring(u.length-1,u.length)!=","&&u.substring(u.length-1,u.length)!=".")&&u!="")){var f=tsAjax.innerHTML("/shoppinginfo.ashx?action=orderlinecountchange&pageid="+Tangora.ShoppingListUtils.pageId+"&shopid="+Tangora.ShoppingListUtils.shopId+"&orderid="+Tangora.ShoppingListUtils.orderId+"&orderlineid="+orderLineId+"&newcount="+u+"&key="+Tangora.ShoppingListUtils.key+"&deliveryid="+Tangora.ShoppingListUtils.deliveryId+"&rndkey="+(new Date).getTime(),null,"orderlinecountchange"),h=f.split("#|#|#")[0],e=f.split("#|#|#")[1];for(document.getElementById("shoppingBasketOrderlines"+Tangora.ShoppingListUtils.pageId).innerHTML=h,n=0;n<e.split("@@").length;n++){var o=e.split("@@")[n],c=o.split("=")[0],l=o.split("=")[1],s=document.getElementById("orderfield"+c);s&&(s.innerHTML=l)}try{updateDeliveryServices(-1)}catch(a){}}};this.deleteOrderline=function(n){var i=tsAjax.innerHTML("/shoppinginfo.ashx?action=orderlinecountchange&pageid="+Tangora.ShoppingListUtils.pageId+"&shopid="+Tangora.ShoppingListUtils.shopId+"&orderid="+Tangora.ShoppingListUtils.orderId+"&orderlineid="+n+"&newcount=deleted&key="+Tangora.ShoppingListUtils.key+"&deliveryid="+Tangora.ShoppingListUtils.deliveryId+"&rndkey="+(new Date).getTime(),null,"orderlinecountchange"),e=i.split("#|#|#")[0],r=i.split("#|#|#")[1],t;for(document.getElementById("shoppingBasketOrderlines"+Tangora.ShoppingListUtils.pageId).innerHTML=e,t=0;t<r.split("@@").length;t++){var u=r.split("@@")[t],o=u.split("=")[0],s=u.split("=")[1],f=document.getElementById("orderfield"+o);f&&(f.innerHTML=s)}};this.checkStock=function(n,t,i,r){var u=document.rediger.action;document.rediger.action="/shoppinginfo.ashx?action=checkstock&shopid="+n+"&orderid="+t+"&rndkey="+(new Date).getTime();$ts.ajaxPostForm(document.rediger,function(t,f){var c,o,e,v,s,y,p,l,w;if(document.rediger.action=u,f!=""){var h=JSON.parse(f),b=!1,a=1;for(h.data.orderlines.orderline.length&&(a=h.data.orderlines.orderline.length),c=0;c<a;c++)for(o=a==1?h.data.orderlines.orderline:h.data.orderlines.orderline[c],e=1,v=!1;!v&&eval("document.rediger.orderlineid"+e);)eval("document.rediger.orderlineid"+e).value==o.id&&(v=!0,s=document.getElementById("elementOrderline"+o.id),y=$elm('input[name="count'+e+'"])'),y.value!=o.count?(y.value=o.count,p=$elm('span[id="spanOrderlineadjusted'+e+'"]'),p&&(p.style.display="inline"),s&&$ts.addClass(s,"shoppingBasketQuantityAdjusted"),b=!0):s&&$ts.removeClass(s,"shoppingBasketQuantityAdjusted")),e=e+1;b&&i!=""&&alert(i);l={};l.shoppingListId=n;try{w=arguments.callee.caller.arguments[0].target}catch(k){w=null}l.trigger=w;$ts.Observer.Broadcast("ShoppingBasket","QuantityAdjusted",l)}else r?sendContinued(!0):document.rediger.submit()})};this.fetchCustomerData=function(n,t,r){(t!=""||r!="")&&$ts.ajax({url:"/shoppinginfo.ashx?action=fetchcustomerdata&pageid="+n+"&email="+t+"&phone="+r,async:"false",type:"GET",complete:function(t,r){var u,f,e;if(r!=""){for(u=JSON.parse(r),f=0,u.customer.field.length&&(f=u.customer.field.length),i=0;i<f;i++)e=eval("document.rediger."+u.customer.field[i].fieldname),e&&(e.value=u.customer.field[i].value);eventArgs={};eventArgs.pageId=n;$ts.Observer.Broadcast("ShoppingBasket","CustomerDataFound",eventArgs)}else eventArgs={},eventArgs.pageId=n,$ts.Observer.Broadcast("ShoppingBasket","CustomerDataNotFound",eventArgs)}})};this.updateMiniBasket=function(n){eventArgs={};eventArgs.pageid=n;var t;try{t=arguments.callee.caller.arguments[0].target}catch(i){t=null}eventArgs.trigger=t;$ts.Observer.Broadcast("MiniBasket","BeforeUpdate",eventArgs);$ts.ajax({url:"/shoppinginfo.ashx?action=renderminibasket&pageid="+n+"&rndkey="+(new Date).getTime(),async:!0,data:null,type:"GET",complete:function(t,i){var h=document.getElementById("Tangora_MiniBasket_"+n),e,u,l,o,f,s;if(h){if(e=i.split("#|#|#")[1],u=i.split("#|#|#")[2],u&&u!=""){var c=!1,o=document.getElementsByTagName("head")[0],r=document.getElementById("tangora_minibasket_css");r==null&&(r=$ts.top().$ts.createElement("style",{type:"text/css"}),r.id="tangora_minibasket_css",c=!0);r.styleSheet?r.styleSheet.cssText=u:(l=$ts.top().document.createTextNode(u),r.appendChild(l));c&&o.appendChild(r)}h.innerHTML=i.split("#|#|#")[0];e&&(o=document.getElementsByTagName("head")[0],f=$elm("#tangora_minibasket_js",o),f?f.text=e:(f=$ts.top().$ts.createElement("script",{type:"text/javascript",text:e}),o.appendChild(f)));Tangora.Layout.RunResponsiveAssist()}eventArgs={};eventArgs.pageid=n;try{s=arguments.callee.caller.arguments[0].target}catch(a){s=null}eventArgs.trigger=s;$ts.Observer.Broadcast("MiniBasket","AfterUpdate",eventArgs)}})};u=!1;n=0;this.voucherCodeChange=function(t,i,r,f,e,o,s,h,c,l){!t&&window.event&&(t=window.event);var a=t.keyCode?t.keyCode:t.which;return a==13&&voucherCodechanging?(t.stopPropagation?t.stopPropagation():t.cancelBubble&&t.cancelBubble(),!1):(u=!0,n=n+1,window.setTimeout("Tangora.ShoppingListUtils.applyVoucherCode("+n+","+i+","+r+',"'+f+'",'+e+',"'+o+'","'+s+'",'+h+","+c+',"'+l+'")',2e3),!0)};this.applyVoucherCode=function(t,i,r,e,o,s,h,c,l,a){t==n&&(u=!1,$ts.ajax({url:"/shoppinginfo.ashx?action=getvoucheramount&pageid="+i+"&orderid="+r+"&vouchercode="+e+"&rndkey="+(new Date).getTime(),async:!0,data:null,type:"GET",complete:function(n,t){var y=t.split("###")[0],v=t.split("###")[1],u,r,e;if(Tangora.ShoppingListUtils.newVoucherAmount=v,document.getElementById("orderVoucherAmount").innerHTML=y,u=document.getElementById("spanOrderTotalAmount"),u&&(r=0,Tangora.ShoppingListUtils.newDeliveryPrice&&(r=Tangora.ShoppingListUtils.newDeliveryPrice),r==-1&&(r=l),u.innerHTML=$ts.formatValue(o-(Tangora.ShoppingListUtils.newVoucherAmount-f)+(r-l),h,c,!0,s)),v>0){eventArgs={};eventArgs.pageid=i;try{e=arguments.callee.caller.arguments[0].target}catch(p){e=null}eventArgs.trigger=e;$ts.Observer.Broadcast("ShoppingBasket","VoucherFound",eventArgs)}else a!=""&&alert(a)}}))};this.emptyBasket=function(n,t){TangoraShoppingListUtils.pageId=n;TangoraShoppingListUtils.shopId=t;$ts.ajax({url:"/shoppinginfo.ashx?action=emptybasket&pageid="+n+"&shopid="+t,async:!1,type:"GET",complete:function(){Tangora.ShoppingListUtils.updateMiniBasket(TangoraShoppingListUtils.pageId)}})};this.miniBasketDeleteOrderline=function(n,t,i){TangoraShoppingListUtils.pageId=n;TangoraShoppingListUtils.shopId=t;$ts.ajax({url:"/shoppinginfo.ashx?action=minibasketdeleteorderline&pageid="+n+"&shopid="+t+"&orderlineid="+i,async:!1,type:"GET",complete:function(){Tangora.ShoppingListUtils.updateMiniBasket(TangoraShoppingListUtils.pageId)}})};this.deliveryServiceChange=function(){var i=document.rediger.deliveryserviceprices.value,t,n;if(document.rediger.deliveryservice.options)t=document.rediger.deliveryservice.options[document.rediger.deliveryservice.options.selectedIndex].value;else if(document.rediger.deliveryservice.length)for(n=0;n<document.rediger.deliveryservice.length;n++)document.rediger.deliveryservice[n].checked&&(t=document.rediger.deliveryservice[n].value);else t=document.rediger.deliveryservice.value;deliveryPrice=Number(i.split(t+"=")[1].split(";")[0]);updateDeliveryPrice(deliveryPrice)};this.updateDynamicCustomerFormField=function(n,t,i){var r="",u;i?r=i:(ctrl=$elm("#shoppinglist_"+t),ctrl&&(r=ctrl.options[ctrl.options.selectedIndex].value));u=$ts.collectFormValues(document.rediger);$ts.ajax({url:"/shoppinginfo.ashx?action=getdynamiccustomerformfield&shopid="+n+"&fieldid="+t+"&value="+r+"&formValues="+encodeURIComponent(u),async:!1,type:"GET",complete:function(n,i){$elm("#dynamicField"+t).innerHTML=i}})}}function API(){this.fetchNextBatch=function(){Tangora.ListUtils.TangoraViewDataScroll(!1,!0)};this.fetchAll=function(){Tangora.ListUtils.TangoraViewDataScroll(!1,!0,!0)};this.getFilterToken=function(n){return tsAjax.innerHTML("/listaction.ashx?action=getcurrentfiltertoken&pageid="+n+"&rnd="+RandomName(6))}}function EditingAPI(){function t(t,i,r,u,f){var e;return location.href.indexOf("recordid"+t+"=")!=-1&&(n=1),f&&f!=""&&(e=new RegExp("&","gi"),f=f.replace(e,"amp;")),f||(f=""),$ts.ajax({url:"/listediting.ashx?action=geteditinginfo&pageid="+t+"&context="+n+"&fieldid="+i+"&recordid="+u+"&ownerrecordid="+r+"&addurl="+f,async:!1})}var n=2;this.createRecord=function(n,t){this.editRecord(n,0,t)};this.editRecord=function(n,i,r){var u=t(n,0,0,i,r);u!=""&&eval(u)};this.createRelatedRecord=function(n,t,i,r){this.editRelatedRecord(n,t,i,0,r)};this.editRelatedRecord=function(n,i,r,u,f){var e=t(n,i,r,u,f);e!=""&&eval(e)};this.setContext=function(t){n=t};this.cancelEditing=function(){Tangora.ListUtils.cancelEditing()}}Tangora.ListUtils=new TangoraListUtils;Tangora.ListUtils.loadingImage="/setup/ajax-loader-white.gif";Tangora.ShoppingListUtils=new TangoraShoppingListUtils;Tangora.ListUtils.API=new API;$ts.ready(function(){var r=function(n){if(n.offsetHeight==0)return!1;var t=n.getBoundingClientRect(),i=document.elementFromPoint(t.left+1,t.top+1);return n!=i?!1:(n.focus(),!0)},u,i,n,t;if($ts.Observer.Register("ListEditing","AfterEdit",function(n,t,i){var e,u,f;if(i.mutatedObject)for(e=i.mutatedObject.querySelectorAll("input, select, textarea"),u=0;u<e.length;u++)if(f=e[u],f&&f.offsetHeight>0&&r(f))break}),/\?editkey=|\&createkey=/i.test(location.href))for(u=$elm("#mergefield_main"),i=u.querySelectorAll("input, select, textarea"),n=0;n<i.length;n++)if(t=i[n],t&&t.offsetHeight>0&&r(t))break});Tangora.ListUtils.Editing=new EditingAPI;